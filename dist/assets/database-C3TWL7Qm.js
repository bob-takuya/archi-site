import{c as I}from"./vendor-C30vB44U.js";var $={exports:{}};(function(D,W){(function(H,A){D.exports=A()})(I,function(){return(()=>{var H={870:(m,u,f)=>{f.r(u),f.d(u,{createEndpoint:()=>_,expose:()=>M,proxy:()=>C,proxyMarker:()=>k,releaseProxy:()=>w,transfer:()=>b,transferHandlers:()=>d,windowEndpoint:()=>T,wrap:()=>t});const k=Symbol("Comlink.proxy"),_=Symbol("Comlink.endpoint"),w=Symbol("Comlink.releaseProxy"),h=Symbol("Comlink.thrown"),v=e=>typeof e=="object"&&e!==null||typeof e=="function",d=new Map([["proxy",{canHandle:e=>v(e)&&e[k],serialize(e){const{port1:o,port2:p}=new MessageChannel;return M(e,o),[p,[p]]},deserialize:e=>(e.start(),t(e))}],["throw",{canHandle:e=>v(e)&&h in e,serialize({value:e}){let o;return o=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[o,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}}]]);function M(e,o=self){o.addEventListener("message",function p(i){if(!i||!i.data)return;const{id:E,type:j,path:c}=Object.assign({path:[]},i.data),y=(i.data.argumentList||[]).map(P);let l;try{const g=c.slice(0,-1).reduce((S,N)=>S[N],e),O=c.reduce((S,N)=>S[N],e);switch(j){case 0:l=O;break;case 1:g[c.slice(-1)[0]]=P(i.data.value),l=!0;break;case 2:l=O.apply(g,y);break;case 3:l=C(new O(...y));break;case 4:{const{port1:S,port2:N}=new MessageChannel;M(e,N),l=b(S,[S])}break;case 5:l=void 0}}catch(g){l={value:g,[h]:0}}Promise.resolve(l).catch(g=>({value:g,[h]:0})).then(g=>{const[O,S]=z(g);o.postMessage(Object.assign(Object.assign({},O),{id:E}),S),j===5&&(o.removeEventListener("message",p),q(o))})}),o.start&&o.start()}function q(e){(function(o){return o.constructor.name==="MessagePort"})(e)&&e.close()}function t(e,o){return a(e,[],o)}function r(e){if(e)throw new Error("Proxy has been released and is not useable")}function a(e,o=[],p=function(){}){let i=!1;const E=new Proxy(p,{get(j,c){if(r(i),c===w)return()=>L(e,{type:5,path:o.map(y=>y.toString())}).then(()=>{q(e),i=!0});if(c==="then"){if(o.length===0)return{then:()=>E};const y=L(e,{type:0,path:o.map(l=>l.toString())}).then(P);return y.then.bind(y)}return a(e,[...o,c])},set(j,c,y){r(i);const[l,g]=z(y);return L(e,{type:1,path:[...o,c].map(O=>O.toString()),value:l},g).then(P)},apply(j,c,y){r(i);const l=o[o.length-1];if(l===_)return L(e,{type:4}).then(P);if(l==="bind")return a(e,o.slice(0,-1));const[g,O]=n(y);return L(e,{type:2,path:o.map(S=>S.toString()),argumentList:g},O).then(P)},construct(j,c){r(i);const[y,l]=n(c);return L(e,{type:3,path:o.map(g=>g.toString()),argumentList:y},l).then(P)}});return E}function n(e){const o=e.map(z);return[o.map(i=>i[0]),(p=o.map(i=>i[1]),Array.prototype.concat.apply([],p))];var p}const s=new WeakMap;function b(e,o){return s.set(e,o),e}function C(e){return Object.assign(e,{[k]:!0})}function T(e,o=self,p="*"){return{postMessage:(i,E)=>e.postMessage(i,p,E),addEventListener:o.addEventListener.bind(o),removeEventListener:o.removeEventListener.bind(o)}}function z(e){for(const[o,p]of d)if(p.canHandle(e)){const[i,E]=p.serialize(e);return[{type:3,name:o,value:i},E]}return[{type:0,value:e},s.get(e)||[]]}function P(e){switch(e.type){case 3:return d.get(e.name).deserialize(e.value);case 0:return e.value}}function L(e,o,p){return new Promise(i=>{const E=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.addEventListener("message",function j(c){c.data&&c.data.id&&c.data.id===E&&(e.removeEventListener("message",j),i(c.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:E},o),p)})}},162:function(m,u,f){var k=this&&this.__createBinding||(Object.create?function(t,r,a,n){n===void 0&&(n=a),Object.defineProperty(t,n,{enumerable:!0,get:function(){return r[a]}})}:function(t,r,a,n){n===void 0&&(n=a),t[n]=r[a]}),_=this&&this.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:!0,value:r})}:function(t,r){t.default=r}),w=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(t!=null)for(var a in t)a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)&&k(r,t,a);return _(r,t),r};Object.defineProperty(u,"__esModule",{value:!0}),u.createDbWorker=void 0;const h=w(f(870));async function v(t){if(t.data&&t.data.action==="eval"){const r=new Int32Array(t.data.notify,0,2),a=new Uint8Array(t.data.notify,8);let n;try{n={ok:await q(t.data.request)}}catch(b){console.error("worker request error",t.data.request,b),n={err:String(b)}}const s=new TextEncoder().encode(JSON.stringify(n));a.set(s,0),r[1]=s.length,Atomics.notify(r,0)}}function d(t){if(t.tagName==="BODY")return"body";const r=[];for(;t.parentElement&&t.tagName!=="BODY";){if(t.id){r.unshift("#"+t.id);break}{let a=1,n=t;for(;n.previousElementSibling;)n=n.previousElementSibling,a++;r.unshift(t.tagName.toLowerCase()+":nth-child("+a+")")}t=t.parentElement}return r.join(" > ")}function M(t){return Object.keys(t)}async function q(t){if(console.log("dom vtable request",t),t.type==="select")return[...document.querySelectorAll(t.selector)].map(r=>{const a={};for(const n of t.columns)n==="selector"?a.selector=d(r):n==="parent"?r.parentElement&&(a.parent=r.parentElement?d(r.parentElement):null):n==="idx"||(a[n]=r[n]);return a});if(t.type==="insert"){if(!t.value.parent)throw Error('"parent" column must be set when inserting');const r=document.querySelectorAll(t.value.parent);if(r.length===0)throw Error(`Parent element ${t.value.parent} could not be found`);if(r.length>1)throw Error(`Parent element ${t.value.parent} ambiguous (${r.length} results)`);const a=r[0];if(!t.value.tagName)throw Error("tagName must be set for inserting");const n=document.createElement(t.value.tagName);for(const s of M(t.value))if(t.value[s]!==null){if(s==="tagName"||s==="parent")continue;if(s==="idx"||s==="selector")throw Error(`${s} can't be set`);n[s]=t.value[s]}return a.appendChild(n),null}if(t.type==="update"){const r=document.querySelector(t.value.selector);if(!r)throw Error(`Element ${t.value.selector} not found!`);const a=[];for(const n of M(t.value)){const s=t.value[n];if(n!=="parent"){if(n!=="idx"&&n!=="selector"&&s!==r[n]){if(console.log("SETTING ",n,r[n],"->",s),n==="tagName")throw Error("can't change tagName");a.push(n)}}else if(s!==d(r.parentElement)){const b=document.querySelectorAll(s);if(b.length!==1)throw Error(`Invalid target parent: found ${b.length} matches`);b[0].appendChild(r)}}for(const n of a)r[n]=t.value[n];return null}throw Error(`unknown request ${t.type}`)}h.transferHandlers.set("WORKERSQLPROXIES",{canHandle:t=>!1,serialize(t){throw Error("no")},deserialize:t=>(t.start(),h.wrap(t))}),u.createDbWorker=async function(t,r,a,n=1/0){const s=new Worker(r),b=h.wrap(s),C=await b.SplitFileHttpDatabase(a,t,void 0,n);return s.addEventListener("message",v),{db:C,worker:b,configs:t}}},432:function(m,u,f){var k=this&&this.__createBinding||(Object.create?function(w,h,v,d){d===void 0&&(d=v),Object.defineProperty(w,d,{enumerable:!0,get:function(){return h[v]}})}:function(w,h,v,d){d===void 0&&(d=v),w[d]=h[v]}),_=this&&this.__exportStar||function(w,h){for(var v in w)v==="default"||Object.prototype.hasOwnProperty.call(h,v)||k(h,w,v)};Object.defineProperty(u,"__esModule",{value:!0}),_(f(162),u)}},A={};function x(m){var u=A[m];if(u!==void 0)return u.exports;var f=A[m]={exports:{}};return H[m].call(f.exports,f,f.exports,x),f.exports}return x.d=(m,u)=>{for(var f in u)x.o(u,f)&&!x.o(m,f)&&Object.defineProperty(m,f,{enumerable:!0,get:u[f]})},x.o=(m,u)=>Object.prototype.hasOwnProperty.call(m,u),x.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})},x(432)})()})})($);var R=$.exports;export{R as d};
//# sourceMappingURL=database-C3TWL7Qm.js.map
