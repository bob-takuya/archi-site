{"version":3,"file":"index-B8mgWYi8.js","sources":["../../node_modules/react-dom/client.js","../../src/components/Header.tsx","../../src/components/Footer.tsx","../../src/services/db/ClientDatabaseService.ts","../../src/services/db/ArchitectureService.ts","../../src/components/ui/LoadingSkeleton.tsx","../../src/pages/HomePage.tsx","../../src/pages/ArchitecturePage.tsx","../../src/components/Map.tsx","../../src/pages/ArchitectureSinglePage.tsx","../../src/services/db/ArchitectService.ts","../../src/pages/ArchitectsPage.tsx","../../src/components/ArchitectureList.tsx","../../src/pages/ArchitectSinglePage.tsx","../../src/pages/MapPage.tsx","../../src/components/ErrorBoundary.tsx","../../src/utils/githubPages.ts","../../src/utils/dbUtils.ts","../../src/components/DatabaseLoader.tsx","../../src/styles/theme.ts","../../src/App.tsx","../../src/index.tsx"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import React, { useState } from 'react';\nimport { Link as RouterLink, useLocation } from 'react-router-dom';\nimport { \n  AppBar, \n  Toolbar, \n  Typography, \n  Button, \n  IconButton,\n  Drawer,\n  List,\n  ListItem,\n  ListItemText,\n  Box,\n  useMediaQuery,\n  useTheme\n} from '@mui/material';\nimport MenuIcon from '@mui/icons-material/Menu';\nimport HomeIcon from '@mui/icons-material/Home';\nimport ArchitectureIcon from '@mui/icons-material/AccountBalance';\nimport PeopleIcon from '@mui/icons-material/People';\nimport MapIcon from '@mui/icons-material/Map';\nimport StorageIcon from '@mui/icons-material/Storage';\nimport CloseIcon from '@mui/icons-material/Close';\n\ninterface NavLink {\n  title: string;\n  path: string;\n  icon: React.ReactNode;\n}\n\nconst navLinks: NavLink[] = [\n  { title: 'ホーム', path: '/', icon: <HomeIcon /> },\n  { title: '建築作品', path: '/architecture', icon: <ArchitectureIcon /> },\n  { title: '建築家', path: '/architects', icon: <PeopleIcon /> },\n  { title: 'マップ', path: '/map', icon: <MapIcon /> },\n  { title: 'DBエクスプローラー', path: '/db-explorer', icon: <StorageIcon /> }\n];\n\nconst Header: React.FC = () => {\n  const location = useLocation();\n  const pathname = location.pathname;\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\n  const [drawerOpen, setDrawerOpen] = useState<boolean>(false);\n\n  const toggleDrawer = (open: boolean) => (event: React.KeyboardEvent | React.MouseEvent) => {\n    if (\n      event.type === 'keydown' &&\n      ((event as React.KeyboardEvent).key === 'Tab' || (event as React.KeyboardEvent).key === 'Shift')\n    ) {\n      return;\n    }\n    setDrawerOpen(open);\n  };\n\n  return (\n    <AppBar position=\"static\" color=\"primary\">\n      <Toolbar>\n        <Typography\n          variant=\"h6\"\n          component={RouterLink}\n          to=\"/\"\n          sx={{ \n            flexGrow: 1, \n            color: 'white',\n            textDecoration: 'none',\n            fontWeight: 'bold'\n          }}\n        >\n          建築データベース\n        </Typography>\n\n        {isMobile ? (\n          <>\n            <IconButton\n              edge=\"end\"\n              color=\"inherit\"\n              aria-label=\"menu\"\n              onClick={toggleDrawer(true)}\n            >\n              <MenuIcon />\n            </IconButton>\n            <Drawer\n              anchor=\"right\"\n              open={drawerOpen}\n              onClose={toggleDrawer(false)}\n            >\n              <Box\n                sx={{ width: 250 }}\n                role=\"presentation\"\n                onClick={toggleDrawer(false)}\n                onKeyDown={toggleDrawer(false)}\n              >\n                <Box sx={{ display: 'flex', justifyContent: 'flex-end', p: 1 }}>\n                  <IconButton onClick={toggleDrawer(false)}>\n                    <CloseIcon />\n                  </IconButton>\n                </Box>\n                <List>\n                  {navLinks.map(({ title, path, icon }) => (\n                    <ListItem\n                      component={RouterLink}\n                      to={path}\n                      key={title}\n                      sx={{\n                        color: pathname === path ? 'primary.main' : 'text.primary',\n                        backgroundColor: pathname === path ? 'rgba(0, 0, 0, 0.08)' : 'transparent',\n                        fontWeight: pathname === path ? 'bold' : 'normal',\n                        '&:hover': {\n                          backgroundColor: 'rgba(0, 0, 0, 0.04)'\n                        }\n                      }}\n                    >\n                      {icon}\n                      <ListItemText primary={title} sx={{ ml: 2 }} />\n                    </ListItem>\n                  ))}\n                </List>\n              </Box>\n            </Drawer>\n          </>\n        ) : (\n          <Box sx={{ display: 'flex' }}>\n            {navLinks.map(({ title, path }) => (\n              <Button\n                key={title}\n                component={RouterLink}\n                to={path}\n                color=\"inherit\"\n                sx={{\n                  mx: 1,\n                  fontWeight: pathname === path ? 'bold' : 'normal',\n                  borderBottom: pathname === path ? '2px solid white' : 'none'\n                }}\n              >\n                {title}\n              </Button>\n            ))}\n          </Box>\n        )}\n      </Toolbar>\n    </AppBar>\n  );\n};\n\nexport default Header; ","import React from 'react';\nimport { Box, Typography, Container } from '@mui/material';\n\nconst Footer: React.FC = () => {\n  return (\n    <Box\n      component=\"footer\"\n      sx={{\n        py: 3,\n        px: 2,\n        mt: 'auto',\n        backgroundColor: 'primary.main',\n        color: 'white',\n      }}\n    >\n      <Container maxWidth=\"sm\">\n        <Typography variant=\"body1\" align=\"center\">\n          建築データベース © {new Date().getFullYear()}\n        </Typography>\n      </Container>\n    </Box>\n  );\n};\n\nexport default Footer; ","import { createDbWorker } from 'sql.js-httpvfs';\nimport type { Database, QueryExecResult } from 'sql.js';\n\n// データベース設定\nconst DB_CONFIG = {\n  from: 'cdn', // またはその他のソース\n  config: {\n    serverMode: 'full',\n    requestChunkSize: 4096,\n    url: './db/archimap.sqlite',\n  },\n};\n\n// Worker URL\nconst WORKER_URL = './sql-wasm.js';\nconst WASM_URL = './sql-wasm.wasm';\n\n// シングルトンインスタンス\nlet dbWorker: any = null;\nlet isInitializing = false;\nlet initPromise: Promise<any> | null = null;\n\n/**\n * データベース接続の状態\n */\nexport enum DatabaseStatus {\n  NOT_INITIALIZED = 'not_initialized',\n  INITIALIZING = 'initializing',\n  READY = 'ready',\n  ERROR = 'error',\n}\n\n/**\n * データベース接続の現在の状態を返す\n */\nexport const getDatabaseStatus = (): DatabaseStatus => {\n  if (dbWorker) {\n    return DatabaseStatus.READY;\n  }\n  if (isInitializing) {\n    return DatabaseStatus.INITIALIZING;\n  }\n  return DatabaseStatus.NOT_INITIALIZED;\n};\n\n/**\n * データベース接続を初期化する\n * @returns データベースワーカーのインスタンス\n */\nexport const initDatabase = async (): Promise<any> => {\n  // 既に初期化済みならそのインスタンスを返す\n  if (dbWorker) {\n    return dbWorker;\n  }\n  \n  // 初期化中なら既存のプロミスを返す\n  if (initPromise) {\n    return initPromise;\n  }\n  \n  // 初期化フラグを設定\n  isInitializing = true;\n  \n  try {\n    // 初期化プロミスを作成\n    initPromise = createDbWorker(\n      [DB_CONFIG as any],\n      WORKER_URL,\n      WASM_URL,\n      () => console.log('データベースワーカーの準備完了')\n    );\n    \n    // データベースワーカーを取得\n    dbWorker = await initPromise;\n    console.log('データベース接続を確立しました');\n    \n    // テスト用のシンプルなクエリを実行\n    const testResult = await dbWorker.db.exec('SELECT sqlite_version()');\n    console.log(`SQLite バージョン: ${testResult[0]?.values[0][0]}`);\n    \n    return dbWorker;\n  } catch (error) {\n    console.error('データベース初期化エラー:', error);\n    throw error;\n  } finally {\n    isInitializing = false;\n    initPromise = null;\n  }\n};\n\n/**\n * SQLクエリを実行する\n * @param query 実行するSQLクエリ\n * @param params バインドパラメータ（オプション）\n * @returns クエリ結果\n */\nexport const executeQuery = async <T = any>(\n  query: string,\n  params: any[] = []\n): Promise<QueryExecResult[]> => {\n  try {\n    // データベース初期化を確認\n    if (!dbWorker) {\n      await initDatabase();\n    }\n    \n    // クエリの実行\n    const result = await dbWorker.db.exec(query, params);\n    return result;\n  } catch (error) {\n    console.error('クエリ実行エラー:', error);\n    throw error;\n  }\n};\n\n/**\n * クエリ結果をJavaScriptオブジェクトの配列に変換する\n * @param result クエリ実行結果\n * @returns オブジェクトの配列\n */\nexport const resultsToObjects = <T = Record<string, any>>(\n  result: QueryExecResult[]\n): T[] => {\n  if (!result || result.length === 0) {\n    return [];\n  }\n  \n  const { columns, values } = result[0];\n  \n  return values.map(row => {\n    const obj: Record<string, any> = {};\n    columns.forEach((col, i) => {\n      obj[col] = row[i];\n    });\n    return obj as T;\n  });\n};\n\n/**\n * 単一の結果オブジェクトを取得する\n * @param query 実行するSQLクエリ\n * @param params バインドパラメータ（オプション）\n * @returns 単一のオブジェクト、または undefined\n */\nexport const getSingleResult = async <T = Record<string, any>>(\n  query: string,\n  params: any[] = []\n): Promise<T | undefined> => {\n  const results = await executeQuery<T>(query, params);\n  const objects = resultsToObjects<T>(results);\n  return objects[0];\n};\n\n/**\n * 結果の配列を取得する\n * @param query 実行するSQLクエリ\n * @param params バインドパラメータ（オプション）\n * @returns オブジェクトの配列\n */\nexport const getResultsArray = async <T = Record<string, any>>(\n  query: string,\n  params: any[] = []\n): Promise<T[]> => {\n  const results = await executeQuery<T>(query, params);\n  return resultsToObjects<T>(results);\n};","import { getResultsArray, getSingleResult } from './ClientDatabaseService';\nimport type { Architecture, ArchitectureResponse, Tag } from '../../types/architecture';\n\n/**\n * IDによる建築作品の取得\n * @param id 建築作品ID\n * @returns 建築作品情報\n */\nexport const getArchitectureById = async (id: number): Promise<Architecture | undefined> => {\n  return getSingleResult<Architecture>(\n    `SELECT * FROM ZCDARCHITECTURE WHERE ZAW_ID = ?`,\n    [id]\n  );\n};\n\n/**\n * 建築家による建築作品一覧の取得\n * @param architectId 建築家ID\n * @returns 建築作品一覧\n */\nexport const getArchitecturesByArchitect = async (architectId: number): Promise<Architecture[]> => {\n  return getResultsArray<Architecture>(\n    `SELECT * FROM ZCDARCHITECTURE \n     WHERE ZAW_ARCHITECT_ID = ? \n     ORDER BY ZAW_YEAR DESC`,\n    [architectId]\n  );\n};\n\n/**\n * 建築作品一覧の取得（ページング付き）\n * @param page ページ番号（1から開始）\n * @param limit 1ページあたりの件数\n * @param searchTerm 検索キーワード（オプション）\n * @param sortBy ソート項目（オプション）\n * @param sortOrder ソート順（オプション）\n * @param options その他のフィルターオプション\n * @returns 建築作品一覧と総件数\n */\nexport const getAllArchitectures = async (\n  page: number = 1,\n  limit: number = 12,\n  searchTerm: string = '',\n  sortBy: string = 'ZAW_NAME',\n  sortOrder: string = 'asc',\n  options: {\n    tags?: string[];\n    architect?: string;\n    location?: string;\n    prefecture?: string;\n    yearFrom?: number;\n    yearTo?: number;\n  } = {}\n): Promise<ArchitectureResponse> => {\n  const offset = (page - 1) * limit;\n  \n  // 検索条件の構築\n  let whereClause = '1=1';\n  const params: any[] = [];\n  \n  // キーワード検索\n  if (searchTerm) {\n    whereClause += ' AND (ZAW_NAME LIKE ? OR ZAW_ADDRESS LIKE ? OR ZAW_DETAIL LIKE ?)';\n    params.push(`%${searchTerm}%`, `%${searchTerm}%`, `%${searchTerm}%`);\n  }\n  \n  // その他のフィルター条件\n  if (options.architect) {\n    whereClause += ' AND (ZAW_ARCHITECT LIKE ? OR a.ZAR_NAME LIKE ? OR a.ZAR_NAMEENG LIKE ?)';\n    params.push(`%${options.architect}%`, `%${options.architect}%`, `%${options.architect}%`);\n  }\n  \n  if (options.location) {\n    whereClause += ' AND ZAW_ADDRESS LIKE ?';\n    params.push(`%${options.location}%`);\n  }\n  \n  if (options.prefecture) {\n    whereClause += ' AND ZAW_PREFECTURE = ?';\n    params.push(options.prefecture);\n  }\n  \n  if (options.yearFrom) {\n    whereClause += ' AND ZAW_YEAR >= ?';\n    params.push(options.yearFrom);\n  }\n  \n  if (options.yearTo) {\n    whereClause += ' AND ZAW_YEAR <= ?';\n    params.push(options.yearTo);\n  }\n  \n  // タグによるフィルタリング\n  let joinClause = 'LEFT JOIN ZCDARCHITECT a ON ZCDARCHITECTURE.ZAW_ARCHITECT_ID = a.ZAR_ID';\n  if (options.tags && options.tags.length > 0) {\n    joinClause += `\n      INNER JOIN ZCDARCHITECTURE_TAG ON ZCDARCHITECTURE.ZAW_ID = ZCDARCHITECTURE_TAG.ARCHITECTURE_ID\n      INNER JOIN ZCDTAG ON ZCDARCHITECTURE_TAG.TAG_ID = ZCDTAG.TAG_ID\n    `;\n    whereClause += ' AND ZCDTAG.TAG_NAME IN (';\n    whereClause += options.tags.map(() => '?').join(',');\n    whereClause += ')';\n    params.push(...options.tags);\n  }\n  \n  // 総件数のクエリ\n  const countQuery = `\n    SELECT COUNT(DISTINCT ZCDARCHITECTURE.ZAW_ID) as total\n    FROM ZCDARCHITECTURE\n    ${joinClause}\n    WHERE ${whereClause}\n  `;\n  \n  // データ取得クエリ\n  const dataQuery = `\n    SELECT DISTINCT ZCDARCHITECTURE.*\n    FROM ZCDARCHITECTURE\n    ${joinClause}\n    WHERE ${whereClause}\n    ORDER BY ${sortBy} ${sortOrder === 'desc' ? 'DESC' : 'ASC'}\n    LIMIT ? OFFSET ?\n  `;\n  \n  // パラメータにLIMITとOFFSETを追加\n  const dataParams = [...params, limit, offset];\n  \n  try {\n    // 総件数取得\n    const countResult = await getSingleResult<{ total: number }>(countQuery, params);\n    const total = countResult?.total || 0;\n    \n    // データ取得\n    const architectures = await getResultsArray<Architecture>(dataQuery, dataParams);\n    \n    return {\n      results: architectures,\n      total,\n      page,\n      limit,\n      totalPages: Math.ceil(total / limit)\n    };\n  } catch (error) {\n    console.error('建築作品データ取得エラー:', error);\n    throw error;\n  }\n};\n\n/**\n * 建築作品タグの取得\n * @returns タグ一覧\n */\nexport const getAllTags = async (): Promise<Tag[]> => {\n  return getResultsArray<Tag>(`\n    SELECT TAG_ID, TAG_NAME, COUNT(ARCHITECTURE_ID) as TAG_COUNT\n    FROM ZCDTAG\n    LEFT JOIN ZCDARCHITECTURE_TAG ON ZCDTAG.TAG_ID = ZCDARCHITECTURE_TAG.TAG_ID\n    GROUP BY ZCDTAG.TAG_ID, ZCDTAG.TAG_NAME\n    ORDER BY TAG_COUNT DESC, TAG_NAME\n  `);\n};\n\n/**\n * 都道府県別の建築作品数の取得\n * @returns 都道府県と建築作品数の一覧\n */\nexport const getPrefectureCounts = async (): Promise<{ prefecture: string; count: number }[]> => {\n  return getResultsArray<{ prefecture: string; count: number }>(`\n    SELECT ZAW_PREFECTURE as prefecture, COUNT(*) as count\n    FROM ZCDARCHITECTURE\n    WHERE ZAW_PREFECTURE IS NOT NULL AND ZAW_PREFECTURE != ''\n    GROUP BY ZAW_PREFECTURE\n    ORDER BY count DESC\n  `);\n};\n\n/**\n * 地図表示用の建築作品データ取得\n * @param bounds 地図の表示範囲（緯度・経度）\n * @param filters フィルター条件\n * @returns 地図表示用の建築作品一覧\n */\nexport const getArchitectureForMap = async (\n  bounds: {\n    north: number;\n    south: number;\n    east: number;\n    west: number;\n  },\n  filters: {\n    tags?: string[];\n    architect?: string;\n    yearFrom?: number;\n    yearTo?: number;\n    searchTerm?: string;\n  } = {}\n): Promise<Architecture[]> => {\n  // 検索条件の構築\n  let whereClause = `\n    ZAW_LAT BETWEEN ? AND ?\n    AND ZAW_LNG BETWEEN ? AND ?\n    AND ZAW_LAT IS NOT NULL\n    AND ZAW_LNG IS NOT NULL\n  `;\n  \n  const params: any[] = [\n    bounds.south,\n    bounds.north,\n    bounds.west,\n    bounds.east\n  ];\n  \n  // その他のフィルター条件\n  if (filters.searchTerm) {\n    whereClause += ' AND (ZAW_NAME LIKE ? OR ZAW_ADDRESS LIKE ? OR ZAW_ARCHITECT LIKE ?)';\n    params.push(\n      `%${filters.searchTerm}%`,\n      `%${filters.searchTerm}%`,\n      `%${filters.searchTerm}%`\n    );\n  }\n  \n  if (filters.architect) {\n    whereClause += ' AND (ZAW_ARCHITECT LIKE ? OR a.ZAR_NAME LIKE ? OR a.ZAR_NAMEENG LIKE ?)';\n    params.push(\n      `%${filters.architect}%`,\n      `%${filters.architect}%`,\n      `%${filters.architect}%`\n    );\n  }\n  \n  if (filters.yearFrom) {\n    whereClause += ' AND ZAW_YEAR >= ?';\n    params.push(filters.yearFrom);\n  }\n  \n  if (filters.yearTo) {\n    whereClause += ' AND ZAW_YEAR <= ?';\n    params.push(filters.yearTo);\n  }\n  \n  // タグによるフィルタリング\n  let joinClause = 'LEFT JOIN ZCDARCHITECT a ON ZCDARCHITECTURE.ZAW_ARCHITECT_ID = a.ZAR_ID';\n  if (filters.tags && filters.tags.length > 0) {\n    joinClause += `\n      INNER JOIN ZCDARCHITECTURE_TAG ON ZCDARCHITECTURE.ZAW_ID = ZCDARCHITECTURE_TAG.ARCHITECTURE_ID\n      INNER JOIN ZCDTAG ON ZCDARCHITECTURE_TAG.TAG_ID = ZCDTAG.TAG_ID\n    `;\n    whereClause += ' AND ZCDTAG.TAG_NAME IN (';\n    whereClause += filters.tags.map(() => '?').join(',');\n    whereClause += ')';\n    params.push(...filters.tags);\n  }\n  \n  // 結果を最大500件に制限（パフォーマンス対策）\n  const query = `\n    SELECT DISTINCT ZCDARCHITECTURE.*\n    FROM ZCDARCHITECTURE\n    ${joinClause}\n    WHERE ${whereClause}\n    LIMIT 500\n  `;\n  \n  return getResultsArray<Architecture>(query, params);\n};","import React from 'react';\nimport { \n  Box, \n  Card, \n  CardContent, \n  Skeleton, \n  Grid,\n  Container \n} from '@mui/material';\n\ninterface LoadingSkeletonProps {\n  variant?: 'card' | 'list' | 'hero' | 'map';\n  count?: number;\n}\n\nconst LoadingSkeleton: React.FC<LoadingSkeletonProps> = ({ \n  variant = 'card', \n  count = 6 \n}) => {\n  const renderCardSkeleton = () => (\n    <Card sx={{ height: '100%' }}>\n      <CardContent>\n        <Skeleton variant=\"text\" height={40} sx={{ mb: 1 }} />\n        <Skeleton variant=\"text\" height={20} sx={{ mb: 1 }} />\n        <Skeleton variant=\"text\" height={20} width=\"60%\" />\n      </CardContent>\n    </Card>\n  );\n\n  const renderListSkeleton = () => (\n    <Box sx={{ p: 2 }}>\n      <Skeleton variant=\"text\" height={32} sx={{ mb: 1 }} />\n      <Skeleton variant=\"text\" height={24} sx={{ mb: 1 }} />\n      <Skeleton variant=\"text\" height={20} width=\"40%\" />\n    </Box>\n  );\n\n  const renderHeroSkeleton = () => (\n    <Container maxWidth=\"lg\">\n      <Box sx={{ textAlign: 'center', py: 8 }}>\n        <Skeleton variant=\"text\" height={60} sx={{ mb: 2 }} />\n        <Skeleton variant=\"text\" height={30} sx={{ mb: 4 }} />\n        <Box sx={{ display: 'flex', justifyContent: 'center', mb: 4 }}>\n          <Skeleton variant=\"rectangular\" width={500} height={56} sx={{ borderRadius: 1 }} />\n        </Box>\n      </Box>\n    </Container>\n  );\n\n  const renderMapSkeleton = () => (\n    <Skeleton \n      variant=\"rectangular\" \n      width=\"100%\" \n      height={400} \n      sx={{ borderRadius: 2 }} \n    />\n  );\n\n  if (variant === 'hero') {\n    return renderHeroSkeleton();\n  }\n\n  if (variant === 'map') {\n    return renderMapSkeleton();\n  }\n\n  if (variant === 'list') {\n    return (\n      <Box>\n        {Array.from({ length: count }).map((_, index) => (\n          <Box key={index} sx={{ borderBottom: '1px solid #e0e0e0' }}>\n            {renderListSkeleton()}\n          </Box>\n        ))}\n      </Box>\n    );\n  }\n\n  return (\n    <Grid container spacing={4}>\n      {Array.from({ length: count }).map((_, index) => (\n        <Grid item key={index} xs={12} sm={6} md={4}>\n          {renderCardSkeleton()}\n        </Grid>\n      ))}\n    </Grid>\n  );\n};\n\nexport default LoadingSkeleton;","import React, { useState, useEffect } from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport { \n  Typography, \n  Grid, \n  Card, \n  CardContent, \n  CardActionArea,\n  TextField,\n  Button,\n  Box,\n  Container,\n  Paper,\n  CircularProgress,\n  Alert,\n  Snackbar,\n  Fade,\n  Chip,\n  Stack,\n  Divider,\n  IconButton,\n  Tooltip\n} from '@mui/material';\nimport SearchIcon from '@mui/icons-material/Search';\nimport ArchitectureIcon from '@mui/icons-material/AccountBalance';\nimport PeopleIcon from '@mui/icons-material/People';\nimport MapIcon from '@mui/icons-material/Map';\nimport TrendingUpIcon from '@mui/icons-material/TrendingUp';\nimport RefreshIcon from '@mui/icons-material/Refresh';\nimport { getAllArchitectures } from '../services/db/ArchitectureService';\nimport LoadingSkeleton from '../components/ui/LoadingSkeleton';\n\ninterface ArchitectureWork {\n  ZAW_ID: number;\n  ZAW_NAME: string;\n  ZAW_ARCHITECT?: string;\n  ZAW_YEAR?: number;\n  ZAW_ADDRESS?: string;\n}\n\nconst HomePage: React.FC = () => {\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [recentWorks, setRecentWorks] = useState<ArchitectureWork[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isDbReady, setIsDbReady] = useState<boolean>(false);\n\n  useEffect(() => {\n    const fetchRecentWorks = async (): Promise<void> => {\n      try {\n        setLoading(true);\n        setError(null);\n        console.log('最近の建築作品を取得中...');\n        const data = await getAllArchitectures(1, 6);\n        setRecentWorks(data.items);\n        setIsDbReady(true);\n        console.log('建築作品の取得に成功しました', data);\n      } catch (error: any) {\n        console.error('建築作品の取得に失敗:', error);\n        setError(error.message || 'データベースからの読み込みに失敗しました');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchRecentWorks();\n  }, []);\n\n  const handleSearch = (e: React.FormEvent): void => {\n    e.preventDefault();\n    if (searchTerm.trim()) {\n      window.location.href = `/architecture?search=${encodeURIComponent(searchTerm)}`;\n    }\n  };\n\n  return (\n    <Container maxWidth=\"lg\">\n      {/* Hero Section */}\n      <Fade in={true} timeout={1000}>\n        <Box\n          sx={{\n            pt: 8,\n            pb: 6,\n            textAlign: 'center',\n            background: 'linear-gradient(135deg, #ECEFF4 0%, #D8DEE9 100%)',\n            borderRadius: 3,\n            mb: 6,\n            position: 'relative',\n            overflow: 'hidden',\n          }}\n        >\n          <Box\n            sx={{\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              opacity: 0.1,\n              background: 'repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(46, 52, 64, 0.1) 10px, rgba(46, 52, 64, 0.1) 20px)',\n            }}\n          />\n          <Box sx={{ position: 'relative', zIndex: 1 }}>\n            <Typography\n              component=\"h1\"\n              variant=\"h1\"\n              align=\"center\"\n              color=\"text.primary\"\n              gutterBottom\n              sx={{\n                background: 'linear-gradient(135deg, #2E3440 0%, #4C566A 100%)',\n                backgroundClip: 'text',\n                WebkitBackgroundClip: 'text',\n                color: 'transparent',\n                mb: 2,\n              }}\n            >\n              建築データベース\n            </Typography>\n            <Typography \n              variant=\"h5\" \n              align=\"center\" \n              color=\"text.secondary\" \n              paragraph\n              sx={{ mb: 4, maxWidth: 600, mx: 'auto' }}\n            >\n              日本の建築作品と建築家を検索・閲覧できる\n              <br />\n              包括的なデータベース\n            </Typography>\n\n            {/* Quick Stats */}\n            <Stack \n              direction=\"row\" \n              spacing={3} \n              justifyContent=\"center\" \n              sx={{ mb: 4 }}\n            >\n              <Chip \n                icon={<ArchitectureIcon />}\n                label=\"14,000+ 建築作品\"\n                color=\"primary\"\n                variant=\"outlined\"\n              />\n              <Chip \n                icon={<PeopleIcon />}\n                label=\"2,900+ 建築家\"\n                color=\"secondary\"\n                variant=\"outlined\"\n              />\n              <Chip \n                icon={<MapIcon />}\n                label=\"全国対応\"\n                color=\"info\"\n                variant=\"outlined\"\n              />\n            </Stack>\n\n            {/* Search Section */}\n            {isDbReady ? (\n              <Fade in={true} timeout={1500}>\n                <Box \n                  component=\"form\" \n                  onSubmit={handleSearch}\n                  sx={{ \n                    mt: 4,\n                    display: 'flex',\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    maxWidth: 600,\n                    mx: 'auto',\n                    gap: 2,\n                  }}\n                >\n                  <TextField\n                    fullWidth\n                    variant=\"outlined\"\n                    placeholder=\"建築作品、建築家、住所などで検索\"\n                    value={searchTerm}\n                    onChange={(e) => setSearchTerm(e.target.value)}\n                    sx={{\n                      '& .MuiOutlinedInput-root': {\n                        backgroundColor: 'white',\n                        boxShadow: '0 4px 12px rgba(0, 0, 0, 0.1)',\n                      },\n                    }}\n                  />\n                  <Button \n                    type=\"submit\"\n                    variant=\"contained\" \n                    color=\"primary\"\n                    startIcon={<SearchIcon />}\n                    size=\"large\"\n                    sx={{\n                      px: 3,\n                      py: 1.5,\n                      minWidth: 120,\n                    }}\n                  >\n                    検索\n                  </Button>\n                </Box>\n              </Fade>\n            ) : (\n              <LoadingSkeleton variant=\"hero\" />\n            )}\n          </Box>\n        </Box>\n      </Fade>\n\n      {/* Recent Works Section */}\n      <Box sx={{ py: 4 }}>\n        <Box sx={{ \n          display: 'flex', \n          justifyContent: 'space-between', \n          alignItems: 'center', \n          mb: 3 \n        }}>\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 2 }}>\n            <TrendingUpIcon color=\"primary\" />\n            <Typography variant=\"h4\" fontWeight=\"bold\">\n              最近の建築作品\n            </Typography>\n          </Box>\n          \n          {isDbReady && (\n            <Tooltip title=\"リフレッシュ\">\n              <IconButton \n                onClick={() => window.location.reload()}\n                color=\"primary\"\n              >\n                <RefreshIcon />\n              </IconButton>\n            </Tooltip>\n          )}\n        </Box>\n        \n        {error && (\n          <Fade in={true}>\n            <Alert \n              severity=\"error\" \n              sx={{ \n                mb: 3,\n                borderRadius: 2,\n                '& .MuiAlert-message': {\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 2,\n                }\n              }}\n            >\n              <Box>\n                {error}\n                <Button \n                  size=\"small\" \n                  variant=\"outlined\" \n                  sx={{ ml: 2 }} \n                  component={RouterLink} \n                  to=\"/db-explorer\"\n                >\n                  診断ツールを開く\n                </Button>\n              </Box>\n            </Alert>\n          </Fade>\n        )}\n\n        {loading ? (\n          <LoadingSkeleton variant=\"card\" count={6} />\n        ) : recentWorks.length > 0 ? (\n          <Fade in={true} timeout={800}>\n            <Grid container spacing={4}>\n              {recentWorks.map((work, index) => (\n                <Grid item key={work.ZAW_ID} xs={12} sm={6} md={4}>\n                  <Fade in={true} timeout={1000 + index * 200}>\n                    <Card \n                      sx={{ \n                        height: '100%', \n                        display: 'flex', \n                        flexDirection: 'column',\n                        background: 'linear-gradient(135deg, #FFFFFF 0%, #F8F9FA 100%)',\n                        border: '1px solid #E5E9F0',\n                        '&:hover': {\n                          '& .card-content': {\n                            transform: 'translateY(-2px)',\n                          },\n                        },\n                      }}\n                    >\n                      <CardActionArea \n                        component={RouterLink} \n                        to={`/architecture/${work.ZAW_ID}`}\n                        sx={{ height: '100%' }}\n                      >\n                        <CardContent \n                          className=\"card-content\"\n                          sx={{ \n                            flexGrow: 1, \n                            transition: 'transform 0.3s ease-in-out',\n                            p: 3,\n                          }}\n                        >\n                          <Typography \n                            gutterBottom \n                            variant=\"h6\" \n                            component=\"h3\"\n                            sx={{ \n                              fontWeight: 600,\n                              color: 'text.primary',\n                              mb: 2,\n                              lineHeight: 1.3,\n                            }}\n                          >\n                            {work.ZAW_NAME}\n                          </Typography>\n                          \n                          <Stack spacing={1}>\n                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                              <PeopleIcon fontSize=\"small\" color=\"secondary\" />\n                              <Typography variant=\"body2\" color=\"text.secondary\">\n                                {work.ZAW_ARCHITECT || '建築家不明'}\n                              </Typography>\n                            </Box>\n                            \n                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                              <MapIcon fontSize=\"small\" color=\"secondary\" />\n                              <Typography variant=\"body2\" color=\"text.secondary\">\n                                {work.ZAW_ADDRESS || '場所不明'} • {work.ZAW_YEAR && work.ZAW_YEAR !== 0 ? work.ZAW_YEAR + '年' : '年代不明'}\n                              </Typography>\n                            </Box>\n                          </Stack>\n                        </CardContent>\n                      </CardActionArea>\n                    </Card>\n                  </Fade>\n                </Grid>\n              ))}\n            </Grid>\n          </Fade>\n        ) : (\n          <Paper sx={{ \n            p: 6, \n            textAlign: 'center',\n            background: 'linear-gradient(135deg, #F8F9FA 0%, #ECEFF4 100%)',\n          }}>\n            <Typography variant=\"h6\" color=\"text.secondary\" gutterBottom>\n              建築作品が見つかりませんでした\n            </Typography>\n            <Typography variant=\"body2\" color=\"text.secondary\">\n              データベースの接続を確認してください\n            </Typography>\n          </Paper>\n        )}\n        \n        {isDbReady && (\n          <Fade in={true} timeout={1200}>\n            <Box sx={{ display: 'flex', justifyContent: 'center', mt: 4 }}>\n              <Button \n                variant=\"outlined\" \n                color=\"primary\" \n                component={RouterLink} \n                to=\"/architecture\"\n                size=\"large\"\n                sx={{\n                  px: 4,\n                  py: 1.5,\n                  borderWidth: 2,\n                  '&:hover': {\n                    borderWidth: 2,\n                  },\n                }}\n              >\n                すべての作品を見る\n              </Button>\n            </Box>\n          </Fade>\n        )}\n      </Box>\n\n      <Divider sx={{ my: 6 }} />\n\n      {/* Feature Cards Section */}\n      <Fade in={true} timeout={1400}>\n        <Box sx={{ mb: 6 }}>\n          <Typography \n            variant=\"h4\" \n            align=\"center\" \n            gutterBottom \n            sx={{ mb: 4, fontWeight: 'bold' }}\n          >\n            データベースの特徴\n          </Typography>\n          \n          <Grid container spacing={4}>\n            <Grid item xs={12} md={4}>\n              <Card\n                sx={{\n                  height: '100%',\n                  display: 'flex',\n                  flexDirection: 'column',\n                  background: 'linear-gradient(135deg, #88C0D0 0%, #5E81AC 100%)',\n                  color: 'white',\n                  position: 'relative',\n                  overflow: 'hidden',\n                }}\n              >\n                <Box\n                  sx={{\n                    position: 'absolute',\n                    top: -20,\n                    right: -20,\n                    opacity: 0.2,\n                  }}\n                >\n                  <ArchitectureIcon sx={{ fontSize: 100 }} />\n                </Box>\n                <CardContent sx={{ position: 'relative', zIndex: 1, p: 3 }}>\n                  <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>\n                    <ArchitectureIcon sx={{ mr: 2, fontSize: 32 }} />\n                    <Typography variant=\"h5\" fontWeight=\"bold\">\n                      建築作品\n                    </Typography>\n                  </Box>\n                  <Typography paragraph sx={{ mb: 3, opacity: 0.9 }}>\n                    日本全国から14,000件以上の建築作品情報を閲覧できます。地域、年代、カテゴリーなどで詳細検索が可能です。\n                  </Typography>\n                  <Button \n                    variant=\"contained\" \n                    component={RouterLink} \n                    to=\"/architecture\"\n                    sx={{ \n                      mt: 'auto',\n                      backgroundColor: 'rgba(255, 255, 255, 0.2)',\n                      color: 'white',\n                      '&:hover': {\n                        backgroundColor: 'rgba(255, 255, 255, 0.3)',\n                      },\n                    }}\n                  >\n                    作品を探す\n                  </Button>\n                </CardContent>\n              </Card>\n            </Grid>\n            \n            <Grid item xs={12} md={4}>\n              <Card\n                sx={{\n                  height: '100%',\n                  display: 'flex',\n                  flexDirection: 'column',\n                  background: 'linear-gradient(135deg, #D08770 0%, #BF616A 100%)',\n                  color: 'white',\n                  position: 'relative',\n                  overflow: 'hidden',\n                }}\n              >\n                <Box\n                  sx={{\n                    position: 'absolute',\n                    top: -20,\n                    right: -20,\n                    opacity: 0.2,\n                  }}\n                >\n                  <PeopleIcon sx={{ fontSize: 100 }} />\n                </Box>\n                <CardContent sx={{ position: 'relative', zIndex: 1, p: 3 }}>\n                  <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>\n                    <PeopleIcon sx={{ mr: 2, fontSize: 32 }} />\n                    <Typography variant=\"h5\" fontWeight=\"bold\">\n                      建築家\n                    </Typography>\n                  </Box>\n                  <Typography paragraph sx={{ mb: 3, opacity: 0.9 }}>\n                    2,900人以上の建築家情報を収録。経歴、作品リスト、所属事務所などの詳細情報を確認できます。\n                  </Typography>\n                  <Button \n                    variant=\"contained\" \n                    component={RouterLink} \n                    to=\"/architects\"\n                    sx={{ \n                      mt: 'auto',\n                      backgroundColor: 'rgba(255, 255, 255, 0.2)',\n                      color: 'white',\n                      '&:hover': {\n                        backgroundColor: 'rgba(255, 255, 255, 0.3)',\n                      },\n                    }}\n                  >\n                    建築家を探す\n                  </Button>\n                </CardContent>\n              </Card>\n            </Grid>\n            \n            <Grid item xs={12} md={4}>\n              <Card\n                sx={{\n                  height: '100%',\n                  display: 'flex',\n                  flexDirection: 'column',\n                  background: 'linear-gradient(135deg, #A3BE8C 0%, #8CAF69 100%)',\n                  color: 'white',\n                  position: 'relative',\n                  overflow: 'hidden',\n                }}\n              >\n                <Box\n                  sx={{\n                    position: 'absolute',\n                    top: -20,\n                    right: -20,\n                    opacity: 0.2,\n                  }}\n                >\n                  <MapIcon sx={{ fontSize: 100 }} />\n                </Box>\n                <CardContent sx={{ position: 'relative', zIndex: 1, p: 3 }}>\n                  <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>\n                    <MapIcon sx={{ mr: 2, fontSize: 32 }} />\n                    <Typography variant=\"h5\" fontWeight=\"bold\">\n                      マップ表示\n                    </Typography>\n                  </Box>\n                  <Typography paragraph sx={{ mb: 3, opacity: 0.9 }}>\n                    建築作品を地図上で視覚的に探索できます。位置情報をもとに周辺の建築作品を発見できます。\n                  </Typography>\n                  <Button \n                    variant=\"contained\" \n                    component={RouterLink} \n                    to=\"/map\"\n                    sx={{ \n                      mt: 'auto',\n                      backgroundColor: 'rgba(255, 255, 255, 0.2)',\n                      color: 'white',\n                      '&:hover': {\n                        backgroundColor: 'rgba(255, 255, 255, 0.3)',\n                      },\n                    }}\n                  >\n                    マップを開く\n                  </Button>\n                </CardContent>\n              </Card>\n            </Grid>\n          </Grid>\n        </Box>\n      </Fade>\n    </Container>\n  );\n};\n\nexport default HomePage; ","import React, { useState, useEffect } from 'react';\nimport { Link as RouterLink, useLocation, useNavigate } from 'react-router-dom';\nimport { \n  Container, \n  Typography, \n  Box, \n  Grid, \n  Paper, \n  Card,\n  CardContent,\n  CardActionArea,\n  TextField,\n  Button,\n  Pagination,\n  CircularProgress,\n  Chip,\n  InputAdornment,\n  Alert,\n  Autocomplete,\n  FormControl,\n  InputLabel,\n  Select,\n  MenuItem,\n  Popover\n} from '@mui/material';\nimport SearchIcon from '@mui/icons-material/Search';\nimport PersonIcon from '@mui/icons-material/Person';\nimport LocationOnIcon from '@mui/icons-material/LocationOn';\nimport CalendarTodayIcon from '@mui/icons-material/CalendarToday';\nimport SortIcon from '@mui/icons-material/Sort';\nimport ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown';\nimport { getAllArchitectures } from '../services/db/ArchitectureService';\n// TODO: Import getAllTags and getYearsForTag when available\n\nconst ArchitecturePage = () => {\n  const [architectures, setArchitectures] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [totalItems, setTotalItems] = useState(0);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [tagQuery, setTagQuery] = useState('');\n  const [selectedTags, setSelectedTags] = useState([]);\n  const [selectedTagsWithYears, setSelectedTagsWithYears] = useState([]);\n  const [availableTags, setAvailableTags] = useState([]);\n  const [sortBy, setSortBy] = useState('year_desc');\n  const [tagYearsMap, setTagYearsMap] = useState({});\n  const [yearAnchorEl, setYearAnchorEl] = useState(null);\n  const [currentTagForYear, setCurrentTagForYear] = useState('');\n  const [tagsYears, setTagsYears] = useState({});\n  const itemsPerPage = 12;\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  // タグリストの初期ロード\n  useEffect(() => {\n    const fetchTags = async () => {\n      try {\n        // const allTags = await getAllTags(); // TODO: Implement\n        const allTags = [];\n        setAvailableTags(allTags);\n      } catch (error) {\n        console.error('タグ取得エラー:', error);\n      }\n    };\n    fetchTags();\n  }, []);\n\n  useEffect(() => {\n    // URLからクエリパラメータを解析\n    const queryParams = new URLSearchParams(location.search);\n    const tag = queryParams.get('tag');\n    const search = queryParams.get('search');\n    const year = queryParams.get('year');\n    const prefecture = queryParams.get('prefecture');\n    const category = queryParams.get('category');\n    const architect = queryParams.get('architect');\n    const sort = queryParams.get('sort');\n    \n    // 並び替えの設定\n    if (sort) {\n      setSortBy(sort);\n    }\n    \n    // タグが複数ある場合（カンマ区切り）\n    if (tag) {\n      const tags = tag.split(',').map(t => t.trim()).filter(t => t);\n      const baseTags = new Set();\n      const tagWithYears = [];\n      \n      // タグを解析して年度を含むタグと基本タグに分ける\n      tags.forEach(t => {\n        const yearMatch = t.match(/\\d{4}年\\d{1,2}月号?/);\n        if (yearMatch) {\n          const baseTag = t.replace(yearMatch[0], '').trim();\n          if (baseTag) {\n            baseTags.add(baseTag);\n            tagWithYears.push(t);\n          }\n        } else {\n          baseTags.add(t);\n        }\n      });\n      \n      setSelectedTags(Array.from(baseTags));\n      setSelectedTagsWithYears(tagWithYears);\n      setTagQuery(tag);\n      setSearchTerm(`tag:${tag}`);\n      fetchArchitectures(1, `tag:${tag}`, sort || sortBy);\n    } else if (year) {\n      setSearchTerm(`year:${year}`);\n      fetchArchitectures(1, `year:${year}`, sort || sortBy);\n    } else if (prefecture) {\n      setSearchTerm(`prefecture:${prefecture}`);\n      fetchArchitectures(1, `prefecture:${prefecture}`, sort || sortBy);\n    } else if (category) {\n      setSearchTerm(`category:${category}`);\n      fetchArchitectures(1, `category:${category}`, sort || sortBy);\n    } else if (architect) {\n      setSearchTerm(`architect:${architect}`);\n      fetchArchitectures(1, `architect:${architect}`, sort || sortBy);\n    } else if (search) {\n      setSearchTerm(search);\n      fetchArchitectures(1, search, sort || sortBy);\n    } else {\n      fetchArchitectures(1, searchTerm, sort || sortBy);\n    }\n  }, [location.search]);\n\n  const fetchArchitectures = async (page, search = searchTerm, sort = sortBy) => {\n    setLoading(true);\n    try {\n      const result = await getAllArchitectures(page, itemsPerPage, search, sort);\n      setArchitectures(result.items);\n      setTotalItems(result.total);\n      setCurrentPage(page);\n    } catch (error) {\n      console.error('Error fetching architectures:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handlePageChange = (event, value) => {\n    setCurrentPage(value);\n    fetchArchitectures(value, searchTerm, sortBy);\n    window.scrollTo(0, 0);\n  };\n\n  const handleSearchChange = (event) => {\n    setSearchTerm(event.target.value);\n  };\n\n  // タグの年度選択ポップオーバーを開く\n  const handleYearMenuOpen = async (event, tag) => {\n    setYearAnchorEl(event.currentTarget);\n    setCurrentTagForYear(tag);\n    \n    // 年度情報を取得（既に取得済みでも再度取得して最新の状態を保持）\n    try {\n      // const years = await getYearsForTag(tag); // TODO: Implement\n      const years = [];\n      setTagsYears(prev => ({\n        ...prev,\n        [tag]: years\n      }));\n    } catch (error) {\n      console.error(`Failed to get years for tag ${tag}:`, error);\n    }\n  };\n\n  // 年度選択ポップオーバーを閉じる\n  const handleYearMenuClose = () => {\n    setYearAnchorEl(null);\n    setCurrentTagForYear('');\n  };\n\n  // 特定のタグの年度を選択\n  const handleYearSelect = (year) => {\n    const tagWithYear = year ? `${currentTagForYear}${year}` : currentTagForYear;\n    \n    let newTagsWithYears = [...selectedTagsWithYears];\n    const existingIndex = newTagsWithYears.findIndex(t => \n      t.startsWith(currentTagForYear) && (t === currentTagForYear || \n        t.match(new RegExp(`^${currentTagForYear}\\\\d{4}年\\\\d{1,2}月号?`)) ||\n        t.match(new RegExp(`^${currentTagForYear}\\\\d{4}年度?`)) ||\n        t.match(new RegExp(`^${currentTagForYear}第\\\\d+回`)) ||\n        t.match(new RegExp(`^${currentTagForYear}\\\\(\\\\d{4}\\\\)`))\n      )\n    );\n    \n    if (existingIndex >= 0) {\n      if (year) {\n        // 既存のタグを新しい年度つきのタグに置き換え\n        newTagsWithYears[existingIndex] = tagWithYear;\n      } else {\n        // 年度なしのタグなら削除（基本タグのみを表示）\n        newTagsWithYears.splice(existingIndex, 1);\n      }\n    } else if (year) {\n      // 新しい年度つきのタグを追加\n      newTagsWithYears.push(tagWithYear);\n    }\n    \n    setSelectedTagsWithYears(newTagsWithYears);\n    handleYearMenuClose();\n    \n    // 選択したタグで即時検索\n    const allTags = [...selectedTags];\n    if (!allTags.includes(currentTagForYear)) {\n      allTags.push(currentTagForYear);\n    }\n    \n    const tagQueryString = [...allTags, ...newTagsWithYears]\n      .filter((tag, index, self) => \n        // 重複排除と、年度付きタグと同じベースタグを持つ基本タグを除外\n        self.indexOf(tag) === index && \n        !newTagsWithYears.some(t => t !== tag && t.startsWith(tag))\n      )\n      .join(',');\n    \n    setTagQuery(tagQueryString);\n    const searchTermValue = `tag:${tagQueryString}`;\n    setSearchTerm(searchTermValue);\n    \n    // 検索実行と URL 更新\n    fetchArchitectures(1, searchTermValue, sortBy);\n    const queryParams = new URLSearchParams();\n    queryParams.set('tag', tagQueryString);\n    if (sortBy !== 'year_desc') {\n      queryParams.set('sort', sortBy);\n    }\n    navigate({ search: queryParams.toString() });\n  };\n\n  // タグ選択時の処理\n  const handleTagSelect = (event, newTags) => {\n    // 選択解除されたタグを特定\n    const removedTags = selectedTags.filter(tag => !newTags.includes(tag));\n    \n    // 選択解除されたタグに関連する年度付きタグも削除\n    let newTagsWithYears = [...selectedTagsWithYears].filter(tag => \n      !removedTags.some(removedTag => tag.startsWith(removedTag))\n    );\n    \n    // 新しく選択されたタグを特定\n    const addedTags = newTags.filter(tag => !selectedTags.includes(tag));\n    \n    // 新しく選択されたタグについて、年度情報を取得\n    if (addedTags.length > 0) {\n      addedTags.forEach(async (tag) => {\n        if (!tagsYears[tag]) {\n          try {\n            // const years = await getYearsForTag(tag); // TODO: Implement\n      const years = [];\n            setTagsYears(prev => ({\n              ...prev,\n              [tag]: years\n            }));\n            \n            // 年度情報が1つだけある場合は自動的に選択\n            if (years && years.length === 1) {\n              const tagWithYear = `${tag}${years[0]}`;\n              newTagsWithYears.push(tagWithYear);\n            }\n          } catch (error) {\n            console.error(`Failed to get years for tag ${tag}:`, error);\n          }\n        }\n      });\n    }\n    \n    setSelectedTags(newTags);\n    setSelectedTagsWithYears(newTagsWithYears);\n    \n    // 即時検索を実行\n    if (newTags.length > 0 || newTagsWithYears.length > 0) {\n      const tagQueryString = [...newTags, ...newTagsWithYears]\n        .filter((tag, index, self) => \n          // 重複排除と、年度付きタグと同じベースタグを持つ基本タグを除外\n          self.indexOf(tag) === index && \n          !newTagsWithYears.some(t => t !== tag && t.startsWith(tag))\n        )\n        .join(',');\n      \n      setTagQuery(tagQueryString);\n      const searchTermValue = `tag:${tagQueryString}`;\n      setSearchTerm(searchTermValue);\n      \n      // 検索実行と URL 更新\n      fetchArchitectures(1, searchTermValue, sortBy);\n      const queryParams = new URLSearchParams();\n      queryParams.set('tag', tagQueryString);\n      if (sortBy !== 'year_desc') {\n        queryParams.set('sort', sortBy);\n      }\n      navigate({ search: queryParams.toString() });\n    } else {\n      handleClearSearch();\n    }\n  };\n\n  // 並び替え選択時の処理\n  const handleSortChange = (event) => {\n    const newSortBy = event.target.value;\n    setSortBy(newSortBy);\n    \n    // 現在の検索条件で並び替えた結果を取得\n    fetchArchitectures(currentPage, searchTerm, newSortBy);\n    \n    // URLを更新（現在のクエリパラメータを保持しつつ、sortを追加）\n    const queryParams = new URLSearchParams(location.search);\n    queryParams.set('sort', newSortBy);\n    navigate({ search: queryParams.toString() });\n  };\n\n  const handleSearch = () => {\n    setCurrentPage(1);\n    fetchArchitectures(1, searchTerm, sortBy);\n    \n    // URLを更新\n    const queryParams = new URLSearchParams();\n    \n    // 並び替えの設定\n    if (sortBy !== 'year_desc') {\n      queryParams.set('sort', sortBy);\n    }\n    \n    // 特殊な検索形式を処理\n    if (searchTerm.startsWith('tag:')) {\n      // タグ検索の場合はtagパラメータを設定\n      const tagValue = searchTerm.substring(4).trim();\n      queryParams.set('tag', tagValue);\n    } else if (searchTerm.startsWith('year:')) {\n      const yearValue = searchTerm.substring(5).trim();\n      queryParams.set('year', yearValue);\n    } else if (searchTerm.startsWith('prefecture:')) {\n      const prefectureValue = searchTerm.substring(11).trim();\n      queryParams.set('prefecture', prefectureValue);\n    } else if (searchTerm.startsWith('category:')) {\n      const categoryValue = searchTerm.substring(9).trim();\n      queryParams.set('category', categoryValue);\n    } else if (searchTerm.startsWith('architect:')) {\n      const architectValue = searchTerm.substring(10).trim();\n      queryParams.set('architect', architectValue);\n    } else if (searchTerm) {\n      // 通常検索の場合はsearchパラメータを設定\n      queryParams.set('search', searchTerm);\n    }\n    \n    navigate({ search: queryParams.toString() });\n  };\n\n  const handleClearSearch = () => {\n    setTagQuery('');\n    setSearchTerm('');\n    setSelectedTags([]);\n    setSelectedTagsWithYears([]);\n    setCurrentPage(1);\n    fetchArchitectures(1, '', sortBy);\n    \n    // URLから検索パラメータを削除（並び替えは保持）\n    const queryParams = new URLSearchParams();\n    if (sortBy !== 'year_desc') {\n      queryParams.set('sort', sortBy);\n    }\n    navigate({ search: queryParams.toString() });\n  };\n\n  const totalPages = Math.ceil(totalItems / itemsPerPage);\n\n  return (\n    <Container maxWidth=\"lg\" sx={{ py: 4 }}>\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n        建築作品一覧\n      </Typography>\n\n      <Paper sx={{ p: 3, mb: 4 }}>\n        {/* 検索バーとボタン */}\n        <Box sx={{ display: 'flex', flexDirection: { xs: 'column', sm: 'row' }, gap: 2, mb: 3 }}>\n          <TextField\n            fullWidth\n            label=\"建築作品名、住所、建築家で検索\"\n            value={searchTerm}\n            onChange={handleSearchChange}\n            onKeyPress={(e) => e.key === 'Enter' && handleSearch()}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <SearchIcon />\n                </InputAdornment>\n              ),\n            }}\n          />\n          <Button \n            variant=\"contained\" \n            onClick={handleSearch}\n            sx={{ minWidth: '120px' }}\n          >\n            検索\n          </Button>\n        </Box>\n        \n        {/* タグ選択と並び替え */}\n        <Box sx={{ display: 'flex', flexDirection: { xs: 'column', md: 'row' }, gap: 2, mb: 3, alignItems: 'flex-start' }}>\n          {/* タグ選択 */}\n          <Autocomplete\n            multiple\n            id=\"tags-selector\"\n            options={availableTags}\n            value={selectedTags}\n            onChange={handleTagSelect}\n            renderInput={(params) => (\n              <TextField\n                {...params}\n                variant=\"outlined\"\n                label=\"タグで絞り込み\"\n                placeholder=\"タグを選択\"\n              />\n            )}\n            renderTags={(value, getTagProps) =>\n              value.map((option, index) => {\n                // このタグに関連する年度付きタグがあるか確認\n                const hasYear = selectedTagsWithYears.some(tag => tag.startsWith(option) && tag !== option);\n                // このタグに利用可能な年度情報があるか確認\n                const isExpandable = Boolean(tagsYears[option] && tagsYears[option].length > 0);\n                // 選択されている年度付きタグを取得\n                const selectedYear = selectedTagsWithYears.find(tag => tag.startsWith(option) && tag !== option);\n                // 選択された年度の表示文字列（見やすさを考慮）\n                let yearDisplay = '';\n                if (selectedYear) {\n                  const yearPart = selectedYear.substring(option.length);\n                  \n                  // 年度情報の表示を整形\n                  if (yearPart.match(/\\d{4}年\\d{1,2}月号?/)) {\n                    // 年月号パターン（例：2014年7月号 → '14年7月号）\n                    yearDisplay = yearPart.replace(/^(\\d{4})/, (_, year) => `'${year.substring(2)}`);\n                  } else if (yearPart.match(/\\d{4}年度?/)) {\n                    // 年度パターン（例：2018年 → '18年）\n                    yearDisplay = yearPart.replace(/^(\\d{4})/, (_, year) => `'${year.substring(2)}`);\n                  } else if (yearPart.match(/第\\d+回/)) {\n                    // 回次パターン（そのまま表示）\n                    yearDisplay = yearPart;\n                  } else if (yearPart.match(/\\(\\d{4}\\)/)) {\n                    // カッコ内年度パターン（例：(2018) → '18）\n                    yearDisplay = yearPart.replace(/\\((\\d{4})\\)/, (_, year) => `'${year.substring(2)}`);\n                  } else {\n                    // その他（そのまま表示）\n                    yearDisplay = yearPart;\n                  }\n                }\n                \n                return (\n                  <Chip\n                    key={option}\n                    label={\n                      <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                        {option}\n                        {selectedYear && (\n                          <Typography \n                            variant=\"caption\" \n                            sx={{ \n                              ml: 0.5, \n                              fontWeight: 'bold',\n                              backgroundColor: 'rgba(0, 0, 0, 0.08)',\n                              borderRadius: '4px',\n                              px: 0.5,\n                              py: 0.2\n                            }}\n                          >\n                            {yearDisplay}\n                          </Typography>\n                        )}\n                        {isExpandable && (\n                          <ArrowDropDownIcon fontSize=\"small\" />\n                        )}\n                      </Box>\n                    }\n                    {...getTagProps({ index })}\n                    color={hasYear ? \"primary\" : \"default\"}\n                    variant=\"outlined\"\n                    onClick={(event) => {\n                      // クリックイベントが伝播してタグが削除されるのを防止\n                      event.stopPropagation();\n                      handleYearMenuOpen(event, option);\n                    }}\n                    onDelete={(event) => {\n                      // 削除イベントはそのまま通過させる\n                      getTagProps({ index }).onDelete(event);\n                    }}\n                    sx={{\n                      maxWidth: '100%',\n                      '& .MuiChip-label': {\n                        overflow: 'hidden',\n                        whiteSpace: 'nowrap',\n                        textOverflow: 'ellipsis'\n                      }\n                    }}\n                  />\n                );\n              })\n            }\n            sx={{ flex: 2 }}\n          />\n          \n          {/* 並び替え */}\n          <FormControl sx={{ minWidth: 200, flex: 1 }}>\n            <InputLabel id=\"sort-select-label\">並び替え</InputLabel>\n            <Select\n              labelId=\"sort-select-label\"\n              id=\"sort-select\"\n              value={sortBy}\n              label=\"並び替え\"\n              onChange={handleSortChange}\n              startAdornment={\n                <InputAdornment position=\"start\">\n                  <SortIcon />\n                </InputAdornment>\n              }\n            >\n              <MenuItem value=\"year_desc\">年代（新しい順）</MenuItem>\n              <MenuItem value=\"year_asc\">年代（古い順）</MenuItem>\n              <MenuItem value=\"name_asc\">名前（昇順）</MenuItem>\n              <MenuItem value=\"name_desc\">名前（降順）</MenuItem>\n              <MenuItem value=\"architect_asc\">建築家（昇順）</MenuItem>\n              <MenuItem value=\"architect_desc\">建築家（降順）</MenuItem>\n            </Select>\n          </FormControl>\n        </Box>\n        \n        {/* タグ年度選択ポップオーバー */}\n        <Popover\n          open={Boolean(yearAnchorEl)}\n          anchorEl={yearAnchorEl}\n          onClose={handleYearMenuClose}\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'left',\n          }}\n        >\n          <Box sx={{ p: 2, maxHeight: 300, width: '250px', overflowY: 'auto' }}>\n            <Typography variant=\"subtitle2\" sx={{ mb: 1 }}>\n              {currentTagForYear} の選択:\n            </Typography>\n            <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n              <Chip\n                label=\"指定なし\"\n                onClick={() => handleYearSelect('')}\n                variant=\"outlined\"\n                size=\"small\"\n                color={\n                  selectedTags.includes(currentTagForYear) && \n                  !selectedTagsWithYears.some(t => t.startsWith(currentTagForYear) && t !== currentTagForYear) \n                    ? \"primary\" : \"default\"\n                }\n              />\n              {tagsYears[currentTagForYear]?.map(year => {\n                // 年度のタイプを判定（年月号、年度、回次など）して適したラベルを表示\n                let label = year;\n                let color: \"default\" | \"primary\" | \"secondary\" | \"error\" | \"info\" | \"success\" | \"warning\" = \"default\";\n                \n                if (selectedTagsWithYears.some(t => t === `${currentTagForYear}${year}`)) {\n                  color = \"primary\";\n                }\n                \n                return (\n                  <Chip\n                    key={year}\n                    label={label}\n                    onClick={() => handleYearSelect(year)}\n                    variant=\"outlined\"\n                    size=\"small\"\n                    color={color}\n                    sx={{ \n                      overflow: 'hidden',\n                      textOverflow: 'ellipsis',\n                      maxWidth: '100%'\n                    }}\n                  />\n                );\n              })}\n            </Box>\n          </Box>\n        </Popover>\n        \n        {/* 選択中のタグ表示 */}\n        {(tagQuery || searchTerm) && (\n          <Box sx={{ mb: 3 }}>\n            <Alert \n              severity=\"info\" \n              action={\n                <Button color=\"inherit\" size=\"small\" onClick={handleClearSearch}>\n                  クリア\n                </Button>\n              }\n            >\n              {tagQuery ? `タグ「${tagQuery}」で絞り込み中` : `「${searchTerm}」で検索中`}\n            </Alert>\n          </Box>\n        )}\n\n        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            {totalItems} 件の建築作品\n          </Typography>\n          {totalPages > 1 && (\n            <Pagination \n              count={totalPages} \n              page={currentPage} \n              onChange={handlePageChange} \n              color=\"primary\"\n              size=\"small\"\n            />\n          )}\n        </Box>\n      </Paper>\n\n      {loading ? (\n        <Box sx={{ display: 'flex', justifyContent: 'center', py: 4 }}>\n          <CircularProgress />\n        </Box>\n      ) : (\n        <>\n          {architectures.length === 0 ? (\n            <Box sx={{ textAlign: 'center', py: 4 }}>\n              <Typography variant=\"h6\">\n                建築作品が見つかりませんでした\n              </Typography>\n              <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n                検索条件を変更してお試しください\n              </Typography>\n            </Box>\n          ) : (\n            <Grid container spacing={3}>\n              {architectures.map((architecture) => (\n                <Grid item key={architecture.id} xs={12} sm={6} md={4} lg={3}>\n                  <Card \n                    sx={{ \n                      height: '100%', \n                      display: 'flex', \n                      flexDirection: 'column',\n                      transition: 'transform 0.2s',\n                      '&:hover': {\n                        transform: 'scale(1.02)',\n                      },\n                    }}\n                  >\n                    <CardActionArea \n                      component={RouterLink} \n                      to={`/architecture/${architecture.id}`}\n                      sx={{ \n                        display: 'flex', \n                        flexDirection: 'column', \n                        alignItems: 'flex-start',\n                        height: '100%',\n                      }}\n                    >\n                      <CardContent sx={{ width: '100%', flexGrow: 1 }}>\n                        <Typography gutterBottom variant=\"h6\" component=\"h2\">\n                          {architecture.name}\n                        </Typography>\n                        \n                        <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1, mt: 2 }}>\n                          {architecture.architectName && (\n                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                              <PersonIcon fontSize=\"small\" color=\"action\" />\n                              <Typography variant=\"body2\" color=\"text.secondary\">\n                                {architecture.architectName}\n                              </Typography>\n                            </Box>\n                          )}\n                          \n                          {architecture.city && (\n                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                              <LocationOnIcon fontSize=\"small\" color=\"action\" />\n                              <Typography variant=\"body2\" color=\"text.secondary\">\n                                {architecture.city}\n                              </Typography>\n                            </Box>\n                          )}\n                          \n                          {architecture.completedYear > 0 && (\n                            <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\n                              <CalendarTodayIcon fontSize=\"small\" color=\"action\" />\n                              <Typography variant=\"body2\" color=\"text.secondary\">\n                                {architecture.completedYear}年\n                              </Typography>\n                            </Box>\n                          )}\n                        </Box>\n                      </CardContent>\n                    </CardActionArea>\n                  </Card>\n                </Grid>\n              ))}\n            </Grid>\n          )}\n\n          {totalPages > 1 && (\n            <Box sx={{ display: 'flex', justifyContent: 'center', mt: 4 }}>\n              <Pagination \n                count={totalPages} \n                page={currentPage} \n                onChange={handlePageChange} \n                color=\"primary\"\n              />\n            </Box>\n          )}\n        </>\n      )}\n    </Container>\n  );\n};\n\nexport default ArchitecturePage; ","import React, { useEffect, useState } from 'react';\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport { Typography, Button } from '@mui/material';\nimport { Link } from 'react-router-dom';\nimport '../styles/map.css';\n\n// Leaflet iconのデフォルト設定を修正\n// @ts-ignore - Leafletのアイコン設定はTypeScriptの型定義と完全に一致しないため\ndelete L.Icon.Default.prototype._getIconUrl;\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png',\n  iconUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png',\n  shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',\n});\n\n// マーカーのデータ型定義\ninterface MapMarker {\n  id: string | number;\n  name: string;\n  location: string;\n  latitude: number;\n  longitude: number;\n}\n\n// Mapコンポーネントのprops定義\ninterface MapProps {\n  markers?: MapMarker[];\n  center: L.LatLngExpression;\n  zoom?: number;\n  height?: string;\n  singleMarker?: MapMarker;\n}\n\n/**\n * 地図コンポーネント\n * マーカーの配列を受け取り、地図上に表示する\n */\nconst Map: React.FC<MapProps> = ({ \n  markers = [], \n  center, \n  zoom = 13, \n  height = '500px',\n  singleMarker\n}) => {\n  const [mapCenter, setMapCenter] = useState<L.LatLngExpression>(center);\n  \n  // マーカーが1つの場合はそのマーカーを中心にする\n  useEffect(() => {\n    if (singleMarker && singleMarker.latitude && singleMarker.longitude) {\n      setMapCenter([singleMarker.latitude, singleMarker.longitude]);\n    } else if (center) {\n      setMapCenter(center);\n    }\n  }, [singleMarker, center]);\n\n  return (\n    <div style={{ height, width: '100%', marginBottom: '20px' }}>\n      <MapContainer \n        center={mapCenter} \n        zoom={zoom} \n        style={{ height: '100%', width: '100%' }}\n      >\n        <TileLayer\n          attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n        \n        {/* 複数マーカーの表示 */}\n        {markers.map((marker, index) => (\n          marker.latitude && marker.longitude ? (\n            <Marker \n              key={`marker-${marker.id || index}`} \n              position={[marker.latitude, marker.longitude]}\n            >\n              <Popup>\n                <Typography variant=\"h6\">{marker.name}</Typography>\n                <Typography variant=\"body2\">{marker.location}</Typography>\n                <Button \n                  component={Link} \n                  to={`/architecture/${marker.id}`} \n                  size=\"small\" \n                  variant=\"outlined\" \n                  sx={{ mt: 1 }}\n                >\n                  詳細を見る\n                </Button>\n              </Popup>\n            </Marker>\n          ) : null\n        ))}\n        \n        {/* 単一マーカーの表示 */}\n        {singleMarker && singleMarker.latitude && singleMarker.longitude && (\n          <Marker \n            position={[singleMarker.latitude, singleMarker.longitude]}\n          >\n            <Popup>\n              <Typography variant=\"h6\">{singleMarker.name}</Typography>\n              <Typography variant=\"body2\">{singleMarker.location}</Typography>\n            </Popup>\n          </Marker>\n        )}\n      </MapContainer>\n    </div>\n  );\n};\n\nexport default Map; ","import React, { useState, useEffect } from 'react';\nimport { useParams, Link as RouterLink, useNavigate } from 'react-router-dom';\nimport { \n  Container, \n  Typography, \n  Box, \n  Grid, \n  Paper, \n  Chip,\n  Divider,\n  Button,\n  CircularProgress,\n  IconButton,\n  Tooltip,\n  ButtonGroup\n} from '@mui/material';\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\nimport LocationOnIcon from '@mui/icons-material/LocationOn';\nimport CalendarTodayIcon from '@mui/icons-material/CalendarToday';\nimport CategoryIcon from '@mui/icons-material/Category';\nimport PersonIcon from '@mui/icons-material/Person';\nimport MenuBookIcon from '@mui/icons-material/MenuBook';\nimport EmojiEventsIcon from '@mui/icons-material/EmojiEvents';\nimport ImageSearchIcon from '@mui/icons-material/ImageSearch';\nimport WikipediaIcon from '@mui/icons-material/LanguageOutlined';\nimport { getArchitectureById } from '../services/db/ArchitectureService';\nimport MapComponent from '../components/Map';\n\nconst ArchitectureSinglePage = () => {\n  const { id } = useParams();\n  const [work, setWork] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchWork = async () => {\n      setLoading(true);\n      try {\n        const data = await getArchitectureById(id);\n        if (!data) {\n          throw new Error('建築作品の取得に失敗しました');\n        }\n        setWork(data);\n      } catch (error) {\n        console.error('Error fetching work:', error);\n        setError(error.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchWork();\n  }, [id]);\n\n  if (loading) {\n    return (\n      <Box sx={{ display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '60vh' }}>\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  if (error) {\n    return (\n      <Container>\n        <Typography variant=\"h5\" color=\"error\" sx={{ textAlign: 'center', my: 4 }}>\n          エラーが発生しました: {error}\n        </Typography>\n        <Button\n          variant=\"contained\"\n          component={RouterLink}\n          to=\"/architecture\"\n          startIcon={<ArrowBackIcon />}\n        >\n          建築作品一覧に戻る\n        </Button>\n      </Container>\n    );\n  }\n\n  if (!work) {\n    return (\n      <Container>\n        <Typography variant=\"h5\" sx={{ textAlign: 'center', my: 4 }}>\n          建築作品が見つかりませんでした\n        </Typography>\n        <Button\n          variant=\"contained\"\n          component={RouterLink}\n          to=\"/architecture\"\n          startIcon={<ArrowBackIcon />}\n        >\n          建築作品一覧に戻る\n        </Button>\n      </Container>\n    );\n  }\n\n  // タグ文字列を配列に変換\n  const tags = work.tag \n    ? work.tag.split(',')\n        .filter(tag => tag.trim() !== '' && !tag.includes('の追加建築'))\n    : [];\n\n  // 新建築の年月情報を抽出（例：新建築2014年7月号 -> 2014年7月号）\n  const shinkenchikuInfo = tags.find(tag => tag.includes('新建築'));\n  const shinkenchikuLabel = shinkenchikuInfo ? shinkenchikuInfo.replace('新建築', '') : '';\n\n  // タグクリック時の処理（将来的には同じタグの建築物一覧に遷移）\n  const handleTagClick = (tag) => {\n    console.log(`タグがクリックされました: ${tag}`);\n    // 同じタグを持つ建築物の検索ページに遷移する実装を追加\n    navigate(`/architecture?tag=${encodeURIComponent(tag)}`);\n  };\n\n  // Google画像検索とWikipediaのURL生成\n  const getGoogleImageSearchUrl = (workName, architect) => {\n    const searchQuery = `${workName} ${architect?.name || ''} 建築`;\n    return `https://www.google.com/search?q=${encodeURIComponent(searchQuery)}&tbm=isch`;\n  };\n\n  const getWikipediaSearchUrl = (workName) => {\n    return `https://ja.wikipedia.org/wiki/Special:Search?search=${encodeURIComponent(workName)}`;\n  };\n\n  return (\n    <Container maxWidth=\"lg\" sx={{ py: 4 }}>\n      <Button\n        variant=\"outlined\"\n        component={RouterLink}\n        to=\"/architecture\"\n        startIcon={<ArrowBackIcon />}\n        sx={{ mb: 3 }}\n      >\n        建築作品一覧に戻る\n      </Button>\n\n      <Paper sx={{ p: 3, mb: 4 }}>\n        <Box sx={{ mb: 2 }}>\n          <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n            {work.name || '無題'}\n          </Typography>\n          \n          {work.location && (\n            <Typography variant=\"subtitle1\" color=\"text.secondary\" gutterBottom>\n              <LocationOnIcon fontSize=\"small\" sx={{ verticalAlign: 'middle', mr: 0.5 }} />\n              {work.location}\n            </Typography>\n          )}\n\n          {/* 基本情報タグ */}\n          <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1, mb: 2 }}>\n            {work.completedYear !== 0 && (\n              <Chip \n                icon={<CalendarTodayIcon />} \n                label={`${work.completedYear}年`} \n                variant=\"outlined\" \n                size=\"small\"\n                onClick={() => navigate(`/architecture?year=${work.completedYear}`)}\n                clickable\n              />\n            )}\n            {work.city && (\n              <Chip \n                icon={<LocationOnIcon />} \n                label={work.city} \n                variant=\"outlined\" \n                size=\"small\"\n                onClick={() => navigate(`/architecture?prefecture=${encodeURIComponent(work.city)}`)}\n                clickable\n              />\n            )}\n            {work.architect && work.architect.name && (\n              <Chip \n                icon={<PersonIcon />} \n                label={work.architect.name} \n                component={RouterLink}\n                to={`/architects/${work.architect.id}`}\n                clickable\n                color=\"primary\"\n                size=\"small\"\n              />\n            )}\n            {work.bigCategory && (\n              <Chip \n                icon={<CategoryIcon />} \n                label={work.bigCategory} \n                variant=\"outlined\" \n                size=\"small\"\n                onClick={() => navigate(`/architecture?category=${encodeURIComponent(work.bigCategory)}`)}\n                clickable\n              />\n            )}\n            {work.category && work.category !== work.bigCategory && (\n              <Chip \n                icon={<CategoryIcon />} \n                label={work.category} \n                variant=\"outlined\" \n                size=\"small\"\n                onClick={() => navigate(`/architecture?category=${encodeURIComponent(work.category)}`)}\n                clickable\n              />\n            )}\n          </Box>\n\n          {/* 受賞歴・選定タグ */}\n          {tags.length > 0 && (\n            <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1, mb: 2 }}>\n              {tags.map((tag, index) => (\n                <Chip \n                  key={index}\n                  icon={<EmojiEventsIcon />}\n                  label={tag}\n                  onClick={() => handleTagClick(tag)}\n                  clickable\n                  color=\"secondary\"\n                  variant=\"outlined\"\n                  size=\"small\"\n                />\n              ))}\n            </Box>\n          )}\n        </Box>\n\n        <Divider sx={{ my: 3 }} />\n\n        {/* リンクボタングループ - 区切り線の下に移動 */}\n        <Box sx={{ mb: 3, display: 'flex', flexDirection: 'row', gap: 1 }}>\n          {/* 新建築リンクがある場合はボタンを表示 */}\n          {work.shinkenchikuUrl && (\n            <Tooltip title=\"新建築データで見る\">\n              <Button \n                variant=\"contained\"\n                href={work.shinkenchikuUrl} \n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                size=\"small\"\n                sx={{ \n                  backgroundColor: '#003366', // 紺色\n                  color: '#ffffff',\n                  '&:hover': { \n                    backgroundColor: '#002244',\n                  }\n                }}\n              >\n                <Box sx={{ \n                  display: 'flex', \n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  mr: 0.5\n                }}>\n                  <img\n                    src=\"https://data.shinkenchiku.online/favicon.ico\"\n                    alt=\"新建築データ\"\n                    style={{\n                      height: '16px',\n                      width: 'auto',\n                      marginRight: '4px'\n                    }}\n                  />\n                </Box>\n                {shinkenchikuLabel && (\n                  <Typography variant=\"caption\">\n                    {shinkenchikuLabel}\n                  </Typography>\n                )}\n              </Button>\n            </Tooltip>\n          )}\n          \n          <Tooltip title=\"Google画像検索\">\n            <Button\n              href={getGoogleImageSearchUrl(work.name, work.architect)}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              startIcon={<ImageSearchIcon />}\n              variant=\"contained\"\n              size=\"small\"\n              sx={{ \n                backgroundColor: '#4285F4', \n                color: '#ffffff',\n                '&:hover': { \n                  backgroundColor: '#3367D6',\n                }\n              }}\n            >\n              画像\n            </Button>\n          </Tooltip>\n          \n          <Tooltip title=\"Wikipediaで検索\">\n            <Button\n              href={getWikipediaSearchUrl(work.name)}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              startIcon={<WikipediaIcon />}\n              variant=\"contained\"\n              size=\"small\"\n              sx={{ \n                backgroundColor: '#333333', \n                color: '#ffffff',\n                '&:hover': { \n                  backgroundColor: '#222222',\n                }\n              }}\n            >\n              Wikipedia\n            </Button>\n          </Tooltip>\n        </Box>\n\n        {work.description && (\n          <Box sx={{ mt: 3 }}>\n            <Typography variant=\"h6\" gutterBottom>\n              概要\n            </Typography>\n            <Typography variant=\"body1\" paragraph sx={{ whiteSpace: 'pre-line' }}>\n              {work.description}\n            </Typography>\n          </Box>\n        )}\n\n        {work.latitude && work.longitude && (\n          <Box sx={{ mt: 3 }}>\n            <Typography variant=\"h6\" gutterBottom>\n              位置情報\n            </Typography>\n            <Box sx={{ height: '400px', width: '100%', mt: 2, border: '1px solid #eee', borderRadius: '4px', overflow: 'hidden' }}>\n              <MapComponent \n                singleMarker={{\n                  id: work.id || 0,\n                  latitude: work.latitude,\n                  longitude: work.longitude,\n                  name: work.name,\n                  location: work.location\n                }}\n                center={[work.latitude, work.longitude]}\n                zoom={15}\n              />\n            </Box>\n          </Box>\n        )}\n      </Paper>\n    </Container>\n  );\n};\n\nexport default ArchitectureSinglePage; ","/**\n * Architect database service\n * Client-side implementation using SQL.js and sql.js-httpvfs\n */\n\nimport { getResultsArray, getSingleResult } from './ClientDatabaseService';\nimport type { Architect, ArchitectsResponse, Tag } from '../../types/architect';\n\n/**\n * IDによる建築家の取得\n * @param id 建築家ID\n * @returns 建築家情報\n */\nexport const getArchitectById = async (id: number): Promise<Architect | undefined> => {\n  return getSingleResult<Architect>(\n    `SELECT * FROM ZCDARCHITECT WHERE ZAR_ID = ?`,\n    [id]\n  );\n};\n\n/**\n * 建築家一覧の取得（ページング付き）\n * @param page ページ番号（1から開始）\n * @param limit 1ページあたりの件数\n * @param searchTerm 検索キーワード（オプション）\n * @param tags タグフィルター（オプション）\n * @param sortBy ソート項目（オプション）\n * @param sortOrder ソート順（オプション）\n * @param options その他のフィルターオプション\n * @returns 建築家一覧と総件数\n */\nexport const getAllArchitects = async (\n  page: number = 1,\n  limit: number = 12,\n  searchTerm: string = '',\n  tags: string[] = [],\n  sortBy: string = 'ZAR_NAME',\n  sortOrder: string = 'asc',\n  options: {\n    nationality?: string;\n    category?: string;\n    school?: string;\n    birthYearFrom?: number;\n    birthYearTo?: number;\n    deathYear?: number;\n  } = {}\n): Promise<ArchitectsResponse> => {\n  const offset = (page - 1) * limit;\n  \n  // 検索条件の構築\n  let whereClause = '1=1';\n  const params: any[] = [];\n  \n  // キーワード検索\n  if (searchTerm) {\n    whereClause += ' AND (ZAR_NAME LIKE ? OR ZAR_KANA LIKE ? OR ZAR_NAMEENG LIKE ?)';\n    params.push(`%${searchTerm}%`, `%${searchTerm}%`, `%${searchTerm}%`);\n  }\n  \n  // その他のフィルター条件\n  if (options.nationality) {\n    whereClause += ' AND ZAR_NATIONALITY = ?';\n    params.push(options.nationality);\n  }\n  \n  if (options.category) {\n    whereClause += ' AND ZAR_CATEGORY = ?';\n    params.push(options.category);\n  }\n  \n  if (options.school) {\n    whereClause += ' AND ZAR_SCHOOL = ?';\n    params.push(options.school);\n  }\n  \n  if (options.birthYearFrom) {\n    whereClause += ' AND ZAR_BIRTHYEAR >= ?';\n    params.push(options.birthYearFrom);\n  }\n  \n  if (options.birthYearTo) {\n    whereClause += ' AND ZAR_BIRTHYEAR <= ?';\n    params.push(options.birthYearTo);\n  }\n  \n  if (options.deathYear) {\n    whereClause += ' AND ZAR_DEATHYEAR = ?';\n    params.push(options.deathYear);\n  }\n  \n  // タグによるフィルタリング（INNER JOIN使用）\n  let joinClause = '';\n  if (tags && tags.length > 0) {\n    joinClause = `\n      INNER JOIN ZCDARCHITECT_TAG ON ZCDARCHITECT.ZAR_ID = ZCDARCHITECT_TAG.ARCHITECT_ID\n      INNER JOIN ZCDTAG ON ZCDARCHITECT_TAG.TAG_ID = ZCDTAG.TAG_ID\n    `;\n    whereClause += ' AND ZCDTAG.TAG_NAME IN (';\n    whereClause += tags.map(() => '?').join(',');\n    whereClause += ')';\n    params.push(...tags);\n  }\n  \n  // 総件数のクエリ\n  const countQuery = `\n    SELECT COUNT(DISTINCT ZCDARCHITECT.ZAR_ID) as total\n    FROM ZCDARCHITECT\n    ${joinClause}\n    WHERE ${whereClause}\n  `;\n  \n  // データ取得クエリ\n  const dataQuery = `\n    SELECT DISTINCT ZCDARCHITECT.*\n    FROM ZCDARCHITECT\n    ${joinClause}\n    WHERE ${whereClause}\n    ORDER BY ${sortBy} ${sortOrder === 'desc' ? 'DESC' : 'ASC'}\n    LIMIT ? OFFSET ?\n  `;\n  \n  // パラメータにLIMITとOFFSETを追加\n  const dataParams = [...params, limit, offset];\n  \n  try {\n    // 総件数取得\n    const countResult = await getSingleResult<{ total: number }>(countQuery, params);\n    const total = countResult?.total || 0;\n    \n    // データ取得\n    const architects = await getResultsArray<Architect>(dataQuery, dataParams);\n    \n    return {\n      results: architects,\n      total,\n      page,\n      limit,\n      totalPages: Math.ceil(total / limit)\n    };\n  } catch (error) {\n    console.error('建築家データ取得エラー:', error);\n    throw error;\n  }\n};\n\n/**\n * 建築家タグの取得\n * @returns タグ一覧\n */\nexport const getArchitectTags = async (): Promise<Tag[]> => {\n  return getResultsArray<Tag>(`\n    SELECT TAG_ID, TAG_NAME, COUNT(ARCHITECT_ID) as TAG_COUNT\n    FROM ZCDTAG\n    LEFT JOIN ZCDARCHITECT_TAG ON ZCDTAG.TAG_ID = ZCDARCHITECT_TAG.TAG_ID\n    GROUP BY ZCDTAG.TAG_ID, ZCDTAG.TAG_NAME\n    ORDER BY TAG_COUNT DESC, TAG_NAME\n  `);\n};","import React, { useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { \n  Container, \n  Typography, \n  Box, \n  Grid, \n  Card, \n  CardContent, \n  CardActionArea,\n  TextField,\n  InputAdornment,\n  Chip,\n  Button,\n  CircularProgress,\n  Pagination,\n  FormControl,\n  InputLabel,\n  Select,\n  MenuItem,\n  Paper,\n  Autocomplete,\n  Popover,\n  Alert\n} from '@mui/material';\n\nimport { Link as RouterLink } from 'react-router-dom';\nimport SearchIcon from '@mui/icons-material/Search';\nimport SortIcon from '@mui/icons-material/Sort';\nimport PublicIcon from '@mui/icons-material/Public';\nimport CakeIcon from '@mui/icons-material/Cake';\nimport PersonIcon from '@mui/icons-material/Person';\nimport CategoryIcon from '@mui/icons-material/Category';\nimport SchoolIcon from '@mui/icons-material/School';\nimport SortByAlphaIcon from '@mui/icons-material/SortByAlpha';\nimport CalendarMonthIcon from '@mui/icons-material/CalendarMonth';\nimport ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown';\nimport { ArchitectService, initDatabase, getResultsArray } from '../services/db';\nimport { Architect, ArchitectsResponse, TagCategory } from '../types/architect';\n\n// 並び替えオプションのインターフェース\ninterface SortOption {\n  value: string;\n  label: string;\n  icon: React.ReactNode;\n}\n\nconst ArchitectsPage: React.FC = () => {\n  console.log(\"ArchitectsPage コンポーネントがレンダリングされました\");\n  \n  // 状態変数\n  const [architects, setArchitects] = useState<Architect[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [totalPages, setTotalPages] = useState<number>(0);\n  const [totalItems, setTotalItems] = useState<number>(0);\n  const [currentPage, setCurrentPage] = useState<number>(1);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [selectedTags, setSelectedTags] = useState<string[]>([]);\n  const [selectedTagsWithYears, setSelectedTagsWithYears] = useState<string[]>([]);\n  const [availableTags, setAvailableTags] = useState<string[]>([]);\n  const [sortBy, setSortBy] = useState<string>('name');\n  const [sortOrder, setSortOrder] = useState<string>('asc');\n  \n  // タグ選択用の状態\n  const [yearAnchorEl, setYearAnchorEl] = useState<HTMLElement | null>(null);\n  const [currentTagForYear, setCurrentTagForYear] = useState<string>('');\n  const [tagsYears, setTagsYears] = useState<Record<string, string[]>>({});\n  \n  // 新しいフィルターパラメータ\n  const [nationality, setNationality] = useState<string>('');\n  const [category, setCategory] = useState<string>('');\n  const [school, setSchool] = useState<string>('');\n  const [birthYearFrom, setBirthYearFrom] = useState<string>('');\n  const [birthYearTo, setBirthYearTo] = useState<string>('');\n  const [deathYear, setDeathYear] = useState<string>('');\n  \n  const navigate = useNavigate();\n  const location = useLocation();\n  const queryParams = new URLSearchParams(location.search);\n  \n  // デバッグ: タグメニュー状態の監視\n  useEffect(() => {\n    console.log(\"tagMenuAnchorEl 状態変更:\", Boolean(yearAnchorEl));\n  }, [yearAnchorEl]);\n  \n  // 並び替えオプション\n  const sortOptions: SortOption[] = [\n    { value: 'name', label: '名前順', icon: <SortByAlphaIcon /> },\n    { value: 'birthYear', label: '生年順', icon: <CalendarMonthIcon /> },\n    { value: 'nationality', label: '国籍順', icon: <PublicIcon /> }\n  ];\n\n  // タグの読み込み\n  useEffect(() => {\n    console.log(\"タグ読み込みのuseEffectが実行されました\");\n    const loadTags = async () => {\n      try {\n        console.log(\"建築家タグ取得開始\");\n        const tags = await ArchitectService.getArchitectTags();\n        console.log(\"取得した建築家タグ:\", tags);\n        \n        // タグを日本語のベースタグに変換\n        const baseTags = ['国籍', 'カテゴリー', '学校', '生年', '没年'];\n        setAvailableTags(baseTags);\n      } catch (error) {\n        console.error('タグ取得エラー:', error);\n      }\n    };\n    \n    loadTags();\n  }, []);\n\n  // 建築家データ読み込み\n  useEffect(() => {\n    console.log(\"建築家データ読み込みのuseEffectが実行されました\", location.search);\n    const loadArchitects = async () => {\n      setLoading(true);\n      try {\n        // クエリパラメータの取得\n        const page = parseInt(queryParams.get('page') || '1');\n        const search = queryParams.get('search') || '';\n        const tags = queryParams.get('tags') ? queryParams.get('tags').split(',') : [];\n        const sort = queryParams.get('sortBy') || 'name';\n        const order = queryParams.get('sortOrder') || 'asc';\n        \n        // 新しいフィルターの取得\n        const nat = queryParams.get('nationality') || '';\n        const cat = queryParams.get('category') || '';\n        const sch = queryParams.get('school') || '';\n        const birthFrom = queryParams.get('birthYearFrom') || '';\n        const birthTo = queryParams.get('birthYearTo') || '';\n        const death = queryParams.get('deathYear') || '';\n        \n        console.log(\"URLから読み取ったパラメータ:\", { page, search, tags, sort, order, nat, cat, sch, birthFrom, birthTo, death });\n        \n        // 状態を更新\n        setCurrentPage(page);\n        setSearchTerm(search);\n        setSelectedTags(tags);\n        setSortBy(sort);\n        setSortOrder(order);\n        setNationality(nat);\n        setCategory(cat);\n        setSchool(sch);\n        setBirthYearFrom(birthFrom);\n        setBirthYearTo(birthTo);\n        setDeathYear(death);\n        \n        // 建築家データを取得\n        console.log(\"建築家データ取得開始:\", { page, search, tags, sort, order, nat, cat, sch, birthFrom, birthTo, death });\n        const result = await ArchitectService.getAllArchitects(\n          page,\n          10, // itemsPerPage\n          search,\n          tags,\n          sort,\n          order,\n          nat,\n          cat,\n          sch,\n          birthFrom ? parseInt(birthFrom) : 0,\n          birthTo ? parseInt(birthTo) : 0,\n          death ? parseInt(death) : 0\n        );\n        \n        console.log(\"取得した建築家データ:\", result);\n        setArchitects(result.items);\n        setTotalPages(result.totalPages);\n        setTotalItems(result.total);\n      } catch (error) {\n        console.error('建築家データ取得エラー:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    loadArchitects();\n  }, [location.search]);\n\n  // タグの年度取得関数\n  const getYearsForArchitectTag = async (tag: string) => {\n    console.log(`${tag}の年度取得開始`);\n    let query = '';\n    if (tag === '国籍') {\n      query = `SELECT DISTINCT ZAT_NATIONALITY as value FROM ZCDARCHITECT WHERE ZAT_NATIONALITY != '' ORDER BY ZAT_NATIONALITY`;\n    } else if (tag === 'カテゴリー') {\n      query = `SELECT DISTINCT ZAT_CATEGORY as value FROM ZCDARCHITECT WHERE ZAT_CATEGORY != '' ORDER BY ZAT_CATEGORY`;\n    } else if (tag === '学校') {\n      query = `SELECT DISTINCT ZAT_SCHOOL as value FROM ZCDARCHITECT WHERE ZAT_SCHOOL != '' ORDER BY ZAT_SCHOOL`;\n    } else if (tag === '生年') {\n      query = `SELECT DISTINCT ZAT_BIRTHYEAR as value FROM ZCDARCHITECT WHERE ZAT_BIRTHYEAR > 0 ORDER BY ZAT_BIRTHYEAR DESC`;\n    } else if (tag === '没年') {\n      query = `SELECT DISTINCT ZAT_DEATHYEAR as value FROM ZCDARCHITECT WHERE ZAT_DEATHYEAR > 0 ORDER BY ZAT_DEATHYEAR DESC`;\n    }\n    \n    if (!query) return [];\n    \n    try {\n      // getResultsArrayを使用してクエリを実行\n      const results = await getResultsArray<{ value: string | number }>(query);\n      \n      // 結果を文字列配列に変換\n      return results.map(item => String(item.value)).filter(Boolean);\n    } catch (error) {\n      console.error(`${tag}の値取得エラー:`, error);\n      return [];\n    }\n  };\n\n  // 年度メニューを開く\n  const handleYearMenuOpen = async (event: React.MouseEvent<HTMLElement>, tag: string) => {\n    console.log(`${tag}の年度メニューを開く`, event.currentTarget);\n    setYearAnchorEl(event.currentTarget);\n    setCurrentTagForYear(tag);\n    \n    // 年度情報を取得（既に取得済みでない場合）\n    if (!tagsYears[tag]) {\n      try {\n        const years = await getYearsForArchitectTag(tag);\n        console.log(`取得した${tag}の年度:`, years);\n        setTagsYears(prev => ({\n          ...prev,\n          [tag]: years\n        }));\n      } catch (error) {\n        console.error(`${tag}の年度取得エラー:`, error);\n      }\n    }\n  };\n\n  // 年度メニューを閉じる\n  const handleYearMenuClose = () => {\n    console.log(\"年度メニューを閉じる\");\n    setYearAnchorEl(null);\n    setCurrentTagForYear('');\n  };\n\n  // 年度を選択\n  const handleYearSelect = (year: string) => {\n    console.log(`年度選択: ${year} (タグ: ${currentTagForYear})`);\n    \n    if (currentTagForYear === '国籍') {\n      setNationality(year);\n    } else if (currentTagForYear === 'カテゴリー') {\n      setCategory(year);\n    } else if (currentTagForYear === '学校') {\n      setSchool(year);\n    } else if (currentTagForYear === '生年') {\n      setBirthYearFrom(year);\n    } else if (currentTagForYear === '没年') {\n      setDeathYear(year);\n    }\n    \n    handleYearMenuClose();\n    updateUrlAndSearch();\n  };\n\n  // タグ選択時の処理\n  const handleTagSelect = (event: React.SyntheticEvent, newTags: string[]) => {\n    console.log(`タグ選択変更:`, newTags);\n    setSelectedTags(newTags);\n    \n    // 選択解除されたタグに関連するフィルターをリセット\n    const removedTags = selectedTags.filter(tag => !newTags.includes(tag));\n    \n    for (const tag of removedTags) {\n      if (tag === '国籍') {\n        setNationality('');\n      } else if (tag === 'カテゴリー') {\n        setCategory('');\n      } else if (tag === '学校') {\n        setSchool('');\n      } else if (tag === '生年') {\n        setBirthYearFrom('');\n        setBirthYearTo('');\n      } else if (tag === '没年') {\n        setDeathYear('');\n      }\n    }\n    \n    // 新しく選択されたタグについて、年度情報を取得\n    const addedTags = newTags.filter(tag => !selectedTags.includes(tag));\n    \n    if (addedTags.length > 0) {\n      addedTags.forEach(async (tag) => {\n        if (!tagsYears[tag]) {\n          try {\n            const years = await getYearsForArchitectTag(tag);\n            setTagsYears(prev => ({\n              ...prev,\n              [tag]: years\n            }));\n          } catch (error) {\n            console.error(`${tag}の年度取得エラー:`, error);\n          }\n        }\n      });\n    }\n    \n    updateUrlAndSearch();\n  };\n\n  // 並び替え変更\n  const handleSortChange = (sortValue: string) => {\n    console.log(`並び替え変更: ${sortValue}`);\n    \n    // 同じ並び替え方法をクリックした場合は昇順/降順を切り替え\n    if (sortBy === sortValue) {\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortBy(sortValue);\n      setSortOrder('asc');\n    }\n    \n    updateUrlAndSearch();\n  };\n\n  // ページ変更\n  const handlePageChange = (event: React.ChangeEvent<unknown>, value: number) => {\n    console.log(`ページ変更: ${value}`);\n    setCurrentPage(value);\n    \n    const newParams = new URLSearchParams(location.search);\n    newParams.set('page', value.toString());\n    navigate({ search: newParams.toString() });\n  };\n\n  // 検索実行\n  const handleSearch = () => {\n    console.log(`検索実行: ${searchTerm}`);\n    updateUrlAndSearch();\n  };\n\n  // 検索クリア\n  const handleClearSearch = () => {\n    console.log(\"検索条件をクリア\");\n    setSearchTerm('');\n    setSelectedTags([]);\n    setSelectedTagsWithYears([]);\n    setNationality('');\n    setCategory('');\n    setSchool('');\n    setBirthYearFrom('');\n    setBirthYearTo('');\n    setDeathYear('');\n    setCurrentPage(1);\n    \n    // URLから検索パラメータを削除（並び替えは保持）\n    const queryParams = new URLSearchParams();\n    if (sortBy !== 'name') {\n      queryParams.set('sortBy', sortBy);\n    }\n    if (sortOrder !== 'asc') {\n      queryParams.set('sortOrder', sortOrder);\n    }\n    navigate({ search: queryParams.toString() });\n  };\n\n  // URLを更新して検索を実行する\n  const updateUrlAndSearch = () => {\n    console.log(\"URLと検索を更新\");\n    const newQueryParams = new URLSearchParams();\n    \n    if (currentPage > 1) newQueryParams.set('page', currentPage.toString());\n    if (searchTerm) newQueryParams.set('search', searchTerm);\n    if (selectedTags.length > 0) newQueryParams.set('tags', selectedTags.join(','));\n    if (sortBy !== 'name') newQueryParams.set('sortBy', sortBy);\n    if (sortOrder !== 'asc') newQueryParams.set('sortOrder', sortOrder);\n    if (nationality) newQueryParams.set('nationality', nationality);\n    if (category) newQueryParams.set('category', category);\n    if (school) newQueryParams.set('school', school);\n    if (birthYearFrom) newQueryParams.set('birthYearFrom', birthYearFrom);\n    if (birthYearTo) newQueryParams.set('birthYearTo', birthYearTo);\n    if (deathYear) newQueryParams.set('deathYear', deathYear);\n    \n    console.log(\"新しいURLパラメータ:\", newQueryParams.toString());\n    navigate({ search: newQueryParams.toString() });\n  };\n\n  // 現在のフィルター情報を表示\n  const CurrentFilters = () => {\n    const activeFilters = [];\n    \n    if (nationality) activeFilters.push({ label: `国籍: ${nationality}`, onDelete: () => { setNationality(''); updateUrlAndSearch(); } });\n    if (birthYearFrom) activeFilters.push({ label: `生年: ${birthYearFrom}`, onDelete: () => { setBirthYearFrom(''); updateUrlAndSearch(); } });\n    if (deathYear) activeFilters.push({ label: `没年: ${deathYear}`, onDelete: () => { setDeathYear(''); updateUrlAndSearch(); } });\n    if (category) activeFilters.push({ label: `カテゴリー: ${category}`, onDelete: () => { setCategory(''); updateUrlAndSearch(); } });\n    if (school) activeFilters.push({ label: `学校: ${school}`, onDelete: () => { setSchool(''); updateUrlAndSearch(); } });\n    \n    if (activeFilters.length === 0 && !searchTerm && selectedTags.length === 0) return null;\n    \n    return (\n      <Box sx={{ mb: 3 }}>\n        <Alert \n          severity=\"info\" \n          action={\n            <Button color=\"inherit\" size=\"small\" onClick={handleClearSearch}>\n              クリア\n            </Button>\n          }\n        >\n          {activeFilters.length > 0 \n            ? `フィルター: ${activeFilters.map(f => f.label).join(', ')}` \n            : searchTerm \n              ? `「${searchTerm}」で検索中` \n              : selectedTags.length > 0 \n                ? `タグ「${selectedTags.join(', ')}」で絞り込み中`\n                : ''}\n        </Alert>\n      </Box>\n    );\n  };\n\n  return (\n    <Container maxWidth=\"lg\" sx={{ py: 4 }}>\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n        建築家一覧\n      </Typography>\n\n      <Paper sx={{ p: 3, mb: 4 }}>\n        {/* 検索バーとボタン */}\n        <Box sx={{ display: 'flex', flexDirection: { xs: 'column', sm: 'row' }, gap: 2, mb: 3 }}>\n          <TextField\n            fullWidth\n            label=\"建築家名、国籍、カテゴリーで検索\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            onKeyPress={(e) => e.key === 'Enter' && handleSearch()}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <SearchIcon />\n                </InputAdornment>\n              ),\n            }}\n          />\n          <Button \n            variant=\"contained\" \n            onClick={handleSearch}\n            sx={{ minWidth: '120px' }}\n          >\n            検索\n          </Button>\n        </Box>\n        \n        {/* タグ選択と並び替え */}\n        <Box sx={{ display: 'flex', flexDirection: { xs: 'column', md: 'row' }, gap: 2, mb: 3, alignItems: 'flex-start' }}>\n          {/* タグ選択 */}\n          <Autocomplete\n            multiple\n            id=\"tags-selector\"\n            options={availableTags}\n            value={selectedTags}\n            onChange={handleTagSelect}\n            fullWidth\n            renderInput={(params) => (\n              <TextField\n                {...params}\n                variant=\"outlined\"\n                label=\"タグで絞り込み\"\n                placeholder=\"タグを選択\"\n              />\n            )}\n            renderTags={(value, getTagProps) =>\n              value.map((option, index) => {\n                // このタグに利用可能な年度情報があるか確認\n                const isExpandable = Boolean(tagsYears[option] && tagsYears[option].length > 0);\n                \n                // このタグに対して選択されている値\n                let selectedValue = '';\n                if (option === '国籍') selectedValue = nationality;\n                else if (option === 'カテゴリー') selectedValue = category;\n                else if (option === '学校') selectedValue = school;\n                else if (option === '生年') selectedValue = birthYearFrom;\n                else if (option === '没年') selectedValue = deathYear;\n                \n                return (\n                  <Chip\n                    key={option}\n                    label={\n                      <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                        {option}\n                        {selectedValue && (\n                          <Typography \n                            variant=\"caption\" \n                            sx={{ \n                              ml: 0.5, \n                              fontWeight: 'bold',\n                              backgroundColor: 'rgba(0, 0, 0, 0.08)',\n                              borderRadius: '4px',\n                              px: 0.5,\n                              py: 0.2\n                            }}\n                          >\n                            {selectedValue}\n                          </Typography>\n                        )}\n                        {isExpandable && (\n                          <ArrowDropDownIcon fontSize=\"small\" />\n                        )}\n                      </Box>\n                    }\n                    {...getTagProps({ index })}\n                    color={selectedValue ? \"primary\" : \"default\"}\n                    variant=\"outlined\"\n                    onClick={(event) => {\n                      // クリックイベントが伝播してタグが削除されるのを防止\n                      event.stopPropagation();\n                      handleYearMenuOpen(event, option);\n                    }}\n                    onDelete={(event) => {\n                      // 削除イベントはそのまま通過させる\n                      getTagProps({ index }).onDelete(event);\n                    }}\n                    sx={{\n                      maxWidth: '100%',\n                      '& .MuiChip-label': {\n                        overflow: 'hidden',\n                        whiteSpace: 'nowrap',\n                      }\n                    }}\n                  />\n                );\n              })\n            }\n          />\n          \n          {/* 並び替え */}\n          <FormControl sx={{ minWidth: 200 }}>\n            <InputLabel id=\"sort-select-label\">並び替え</InputLabel>\n            <Select\n              labelId=\"sort-select-label\"\n              value={`${sortBy}_${sortOrder}`}\n              label=\"並び替え\"\n              onChange={(e) => {\n                const [newSortBy, newSortOrder] = e.target.value.split('_');\n                setSortBy(newSortBy);\n                setSortOrder(newSortOrder);\n                updateUrlAndSearch();\n              }}\n            >\n              <MenuItem value=\"name_asc\">名前 (昇順)</MenuItem>\n              <MenuItem value=\"name_desc\">名前 (降順)</MenuItem>\n              <MenuItem value=\"birthYear_asc\">生年 (昇順)</MenuItem>\n              <MenuItem value=\"birthYear_desc\">生年 (降順)</MenuItem>\n              <MenuItem value=\"nationality_asc\">国籍 (昇順)</MenuItem>\n              <MenuItem value=\"nationality_desc\">国籍 (降順)</MenuItem>\n            </Select>\n          </FormControl>\n        </Box>\n        \n        {/* 年度選択ポップオーバー */}\n        <Popover\n          open={Boolean(yearAnchorEl)}\n          anchorEl={yearAnchorEl}\n          onClose={handleYearMenuClose}\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'left',\n          }}\n          transformOrigin={{\n            vertical: 'top',\n            horizontal: 'left',\n          }}\n        >\n          <Box sx={{ p: 2, width: 300, maxHeight: 400, overflow: 'auto' }}>\n            <Typography variant=\"subtitle1\" gutterBottom>\n              {currentTagForYear === '国籍' ? '国籍を選択' :\n               currentTagForYear === 'カテゴリー' ? 'カテゴリーを選択' :\n               currentTagForYear === '学校' ? '学校を選択' :\n               currentTagForYear === '生年' ? '生年を選択' :\n               currentTagForYear === '没年' ? '没年を選択' : 'タグ値を選択'}\n            </Typography>\n            \n            <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1, mt: 1 }}>\n              <Chip\n                label=\"指定なし\"\n                onClick={() => handleYearSelect('')}\n                variant=\"outlined\"\n                size=\"small\"\n                sx={{ mb: 1 }}\n              />\n              \n              {tagsYears[currentTagForYear]?.map(year => (\n                <Chip\n                  key={year}\n                  label={year}\n                  onClick={() => handleYearSelect(year)}\n                  variant=\"outlined\"\n                  size=\"small\"\n                  color={\n                    (currentTagForYear === '国籍' && year === nationality) ||\n                    (currentTagForYear === 'カテゴリー' && year === category) ||\n                    (currentTagForYear === '学校' && year === school) ||\n                    (currentTagForYear === '生年' && year === birthYearFrom) ||\n                    (currentTagForYear === '没年' && year === deathYear)\n                      ? \"primary\"\n                      : \"default\"\n                  }\n                  sx={{ \n                    overflow: 'hidden',\n                    textOverflow: 'ellipsis',\n                    maxWidth: '100%'\n                  }}\n                />\n              ))}\n            </Box>\n          </Box>\n        </Popover>\n        \n        {/* 選択中のフィルター表示 */}\n        <CurrentFilters />\n\n        <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 2 }}>\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            {totalItems}人の建築家\n          </Typography>\n          {totalPages > 1 && (\n            <Pagination \n              count={totalPages} \n              page={currentPage} \n              onChange={handlePageChange} \n              color=\"primary\"\n              size=\"small\"\n            />\n          )}\n        </Box>\n      </Paper>\n\n      {loading ? (\n        <Box sx={{ display: 'flex', justifyContent: 'center', py: 4 }}>\n          <CircularProgress />\n        </Box>\n      ) : (\n        <>\n          {architects.length === 0 ? (\n            <Box sx={{ textAlign: 'center', py: 4 }}>\n              <Typography variant=\"h6\">\n                建築家が見つかりませんでした\n              </Typography>\n              <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 1 }}>\n                検索条件を変更してお試しください\n              </Typography>\n            </Box>\n          ) : (\n            <Grid container spacing={3}>\n              {architects.map((architect) => (\n                <Grid item xs={12} sm={6} md={4} key={architect.id}>\n                  <Card \n                    sx={{ \n                      height: '100%', \n                      display: 'flex', \n                      flexDirection: 'column',\n                      transition: 'transform 0.2s',\n                      '&:hover': {\n                        transform: 'scale(1.02)',\n                      },\n                    }}\n                  >\n                    <CardActionArea component={RouterLink} to={`/architects/${architect.id}`}>\n                      <CardContent>\n                        <Typography variant=\"h6\" component=\"div\" gutterBottom>\n                          {architect.name}\n                        </Typography>\n                        <Typography variant=\"body2\" color=\"text.secondary\" gutterBottom>\n                          {architect.nationality} • {architect.birthYear || '?'}-{architect.deathYear || '現在'}\n                        </Typography>\n                        <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 0.5, mt: 1 }}>\n                          {architect.tags && architect.tags.map((tag) => (\n                            <Chip\n                              key={tag}\n                              label={tag}\n                              size=\"small\"\n                              variant=\"outlined\"\n                              sx={{ pointerEvents: 'none' }}\n                            />\n                          ))}\n                        </Box>\n                      </CardContent>\n                    </CardActionArea>\n                  </Card>\n                </Grid>\n              ))}\n            </Grid>\n          )}\n          \n          {/* ページネーション */}\n          {totalPages > 1 && (\n            <Box sx={{ display: 'flex', justifyContent: 'center', mt: 4 }}>\n              <Pagination \n                count={totalPages} \n                page={currentPage} \n                onChange={handlePageChange} \n                color=\"primary\"\n              />\n            </Box>\n          )}\n        </>\n      )}\n    </Container>\n  );\n};\n\nexport default ArchitectsPage; ","import React from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport {\n  Grid,\n  Card,\n  CardContent,\n  CardActionArea,\n  Typography,\n  Box,\n  Chip\n} from '@mui/material';\nimport EventIcon from '@mui/icons-material/Event';\nimport LocationOnIcon from '@mui/icons-material/LocationOn';\n\ninterface Architecture {\n  id: number;\n  name: string;\n  completedYear: number;\n  city?: string;\n  location?: string;\n  tag?: string;\n}\n\ninterface ArchitectureListProps {\n  architectures: Architecture[];\n  compact?: boolean;\n}\n\n/**\n * 建築作品のリストを表示するコンポーネント\n */\nconst ArchitectureList: React.FC<ArchitectureListProps> = ({ architectures, compact = false }) => {\n  if (!architectures || architectures.length === 0) {\n    return (\n      <Typography variant=\"body2\" color=\"text.secondary\">\n        登録されている作品はありません。\n      </Typography>\n    );\n  }\n\n  return (\n    <Grid container spacing={compact ? 2 : 3}>\n      {architectures.map((architecture) => (\n        <Grid item key={architecture.id} xs={12} sm={6} md={compact ? 6 : 4}>\n          <Card \n            sx={{ \n              height: '100%', \n              display: 'flex', \n              flexDirection: 'column',\n              transition: 'transform 0.2s',\n              '&:hover': {\n                transform: 'scale(1.02)',\n              },\n            }}\n          >\n            <CardActionArea \n              component={RouterLink} \n              to={`/architecture/${architecture.id}`}\n              sx={{ flexGrow: 1 }}\n            >\n              <CardContent>\n                <Typography gutterBottom variant=\"h6\" component=\"h2\">\n                  {architecture.name}\n                </Typography>\n                \n                {architecture.completedYear > 0 && (\n                  <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                    <EventIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                    <Typography variant=\"body2\" color=\"text.secondary\">\n                      {architecture.completedYear}年\n                    </Typography>\n                  </Box>\n                )}\n                \n                {(architecture.city || architecture.location) && (\n                  <Box sx={{ display: 'flex', alignItems: 'center', mb: 1 }}>\n                    <LocationOnIcon fontSize=\"small\" sx={{ mr: 1, color: 'text.secondary' }} />\n                    <Typography variant=\"body2\" color=\"text.secondary\">\n                      {architecture.city ? architecture.city : ''}\n                      {architecture.city && architecture.location ? ' / ' : ''}\n                      {architecture.location ? architecture.location : ''}\n                    </Typography>\n                  </Box>\n                )}\n                \n                {/* 作品のタグを表示 */}\n                {architecture.tag && (\n                  <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 0.5, mt: 1 }}>\n                    {architecture.tag.split(',')\n                      .filter(tag => tag.trim() !== '' && !tag.includes('の追加建築'))\n                      .map((tag, idx) => (\n                        <Chip \n                          key={idx}\n                          label={tag.trim()}\n                          size=\"small\"\n                          color=\"secondary\"\n                          variant=\"outlined\"\n                          sx={{ height: '20px', fontSize: '0.65rem' }}\n                        />\n                      ))\n                    }\n                  </Box>\n                )}\n              </CardContent>\n            </CardActionArea>\n          </Card>\n        </Grid>\n      ))}\n    </Grid>\n  );\n};\n\nexport default ArchitectureList; ","import React, { useState, useEffect } from 'react';\nimport { useParams, Link as RouterLink, useNavigate } from 'react-router-dom';\nimport { \n  Container, \n  Typography, \n  Box, \n  Grid, \n  Paper, \n  Chip,\n  Divider,\n  Button,\n  ButtonGroup,\n  CircularProgress,\n  Table,\n  TableBody,\n  TableCell,\n  TableContainer,\n  TableRow,\n  Card,\n  CardContent,\n  CardActionArea,\n  Tooltip,\n  Link\n} from '@mui/material';\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\nimport LocationOnIcon from '@mui/icons-material/LocationOn';\nimport BusinessIcon from '@mui/icons-material/Business';\nimport SchoolIcon from '@mui/icons-material/School';\nimport PersonIcon from '@mui/icons-material/Person';\nimport WorkIcon from '@mui/icons-material/Work';\nimport PublicIcon from '@mui/icons-material/Public';\nimport LanguageIcon from '@mui/icons-material/Language';\nimport SearchIcon from '@mui/icons-material/Search';\nimport EmojiEventsIcon from '@mui/icons-material/EmojiEvents';\nimport LinkIcon from '@mui/icons-material/Link';\nimport CakeIcon from '@mui/icons-material/Cake';\nimport CategoryIcon from '@mui/icons-material/Category';\nimport PersonOffIcon from '@mui/icons-material/PersonOff';\nimport { ArchitectService } from '../services/db';\nimport MapComponent from '../components/Map';\nimport ArchitectureList from '../components/ArchitectureList';\n\n// Wikipediaアイコンコンポーネント\nconst WikipediaIcon = () => (\n  <Box\n    component=\"span\"\n    sx={{\n      display: 'inline-flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      width: 24,\n      height: 24,\n    }}\n  >\n    <Typography\n      variant=\"caption\"\n      component=\"span\"\n      sx={{\n        fontFamily: 'serif',\n        fontWeight: 'bold',\n        fontSize: '16px',\n      }}\n    >\n      W\n    </Typography>\n  </Box>\n);\n\nconst ArchitectSinglePage = () => {\n  const { id } = useParams();\n  const [architect, setArchitect] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [teacherInfo, setTeacherInfo] = useState([]);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchArchitect = async () => {\n      setLoading(true);\n      try {\n        const data = await ArchitectService.getArchitectById(parseInt(id));\n        if (!data) {\n          setError('建築家情報が見つかりませんでした。');\n          setLoading(false);\n          return;\n        }\n        setArchitect(data);\n        \n        // 教師情報を取得\n        const teachers = [];\n        if (data.teacher1) {\n          const teacherInfo = { name: data.teacher1, id: null };\n          try {\n            // 教師の名前からIDを検索する処理（実装は省略）\n            // 実際のデータベースクエリに置き換える必要があります\n            teacherInfo.id = await findArchitectIdByName(data.teacher1);\n          } catch (err) {\n            console.error('教師情報の取得に失敗:', err);\n          }\n          teachers.push(teacherInfo);\n        }\n        \n        if (data.teacher2) {\n          const teacherInfo = { name: data.teacher2, id: null };\n          try {\n            teacherInfo.id = await findArchitectIdByName(data.teacher2);\n          } catch (err) {\n            console.error('教師情報の取得に失敗:', err);\n          }\n          teachers.push(teacherInfo);\n        }\n        \n        if (data.teacher3) {\n          const teacherInfo = { name: data.teacher3, id: null };\n          try {\n            teacherInfo.id = await findArchitectIdByName(data.teacher3);\n          } catch (err) {\n            console.error('教師情報の取得に失敗:', err);\n          }\n          teachers.push(teacherInfo);\n        }\n        \n        setTeacherInfo(teachers);\n      } catch (err) {\n        console.error('建築家データ取得エラー:', err);\n        setError('建築家情報の読み込み中にエラーが発生しました。');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    if (id) {\n      fetchArchitect();\n    }\n  }, [id]);\n\n  // 建築家名からIDを検索する関数（実際のアプリでは適切に実装する必要があります）\n  const findArchitectIdByName = async (name) => {\n    // この関数は、既存の建築家データベースから名前でIDを検索する処理を実装します\n    // 例: SELECT id FROM architects WHERE name = ?\n    // サンプルとしてnullを返しています\n    return null;\n  };\n\n  // 学校・学部情報をフォーマットする関数\n  const formatEducation = () => {\n    if (!architect) return null;\n    \n    const education = [];\n    \n    if (architect.school) {\n      let eduStr = architect.school;\n      if (architect.faculty) {\n        eduStr += ` ${architect.faculty}`;\n      }\n      education.push(eduStr);\n    }\n    \n    if (architect.schoolAbroad) {\n      education.push(architect.schoolAbroad);\n    }\n    \n    return education.length > 0 ? education.join('、') : null;\n  };\n\n  // 教師情報をフォーマットする関数\n  const formatTeachers = () => {\n    if (!teacherInfo || teacherInfo.length === 0) return null;\n    \n    return teacherInfo.map((teacher, index) => (\n      <span key={index}>\n        {index > 0 && '、'}\n        {teacher.id ? (\n          <Link component={RouterLink} to={`/architects/${teacher.id}`} color=\"inherit\" underline=\"hover\">\n            {teacher.name}\n          </Link>\n        ) : (\n          teacher.name\n        )}\n      </span>\n    ));\n  };\n\n  // タグをクリックしたときの処理\n  const handleTagClick = (tagType, value) => {\n    if (!value) return;\n    \n    let searchParam = '';\n    \n    switch (tagType) {\n      case 'nationality':\n        searchParam = `nationality=${encodeURIComponent(value)}`;\n        break;\n      case 'born':\n        searchParam = `birthyear_from=${encodeURIComponent(value)}&birthyear_to=${encodeURIComponent(value)}`;\n        break;\n      case 'died':\n        searchParam = `deathyear=${encodeURIComponent(value)}`;\n        break;\n      case 'category':\n        searchParam = `category=${encodeURIComponent(value)}`;\n        break;\n      default:\n        return;\n    }\n    \n    navigate(`/architects?${searchParam}`);\n  };\n\n  // Google検索とWikipediaのURL生成\n  const getGoogleSearchUrl = (architectName, nationality) => {\n    const searchQuery = `${architectName} ${nationality || ''} 建築家`;\n    return `https://www.google.com/search?q=${encodeURIComponent(searchQuery)}`;\n  };\n\n  const getWikipediaSearchUrl = (architectName) => {\n    return `https://ja.wikipedia.org/wiki/Special:Search?search=${encodeURIComponent(architectName)}`;\n  };\n\n  if (loading) {\n    return (\n      <Container maxWidth=\"lg\" sx={{ py: 4 }}>\n        <Box sx={{ display: 'flex', justifyContent: 'center', py: 8 }}>\n          <CircularProgress />\n        </Box>\n      </Container>\n    );\n  }\n\n  if (error || !architect) {\n    return (\n      <Container maxWidth=\"lg\" sx={{ py: 4 }}>\n        <Paper sx={{ p: 3 }}>\n          <Typography variant=\"h5\" color=\"error\" gutterBottom>\n            エラー\n          </Typography>\n          <Typography paragraph>\n            {error || '建築家情報が見つかりませんでした。'}\n          </Typography>\n          <Button \n            variant=\"outlined\" \n            startIcon={<ArrowBackIcon />} \n            onClick={() => navigate(-1)}\n          >\n            戻る\n          </Button>\n        </Paper>\n      </Container>\n    );\n  }\n\n  // 作品からタグを収集し、重複を除去\n  const allTags = new Set();\n  if (architect.works) {\n    architect.works.forEach(work => {\n      if (work.tag) {\n        const tags = work.tag.split(',');\n        tags.forEach(tag => {\n          const trimmedTag = tag.trim();\n          if (trimmedTag && !trimmedTag.includes('の追加建築')) {\n            allTags.add(trimmedTag);\n          }\n        });\n      }\n    });\n  }\n\n  // 建築家固有のタグを生成\n  const architectTags = [];\n  if (architect.nationality) {\n    architectTags.push(`nationality:${architect.nationality}`);\n  }\n  if (architect.birthYear > 0) {\n    // 10年単位の年代を計算\n    const decade = Math.floor(architect.birthYear / 10) * 10;\n    architectTags.push(`born:${decade}s`);\n  }\n  if (architect.deathYear > 0) {\n    architectTags.push(`died:${architect.deathYear}`);\n  }\n  if (architect.category) {\n    architectTags.push(`category:${architect.category}`);\n  }\n  if (architect.school) {\n    architectTags.push(`school:${architect.school}`);\n  }\n\n  return (\n    <Container maxWidth=\"lg\" sx={{ py: 4 }}>\n      <Button\n        variant=\"outlined\"\n        component={RouterLink}\n        to=\"/architects\"\n        startIcon={<ArrowBackIcon />}\n        sx={{ mb: 3 }}\n      >\n        建築家一覧に戻る\n      </Button>\n\n      <Paper sx={{ p: 3, mb: 4 }}>\n        <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n          {architect.name || '不明'}\n        </Typography>\n\n        <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 2, my: 3 }}>\n          {/* 建築家固有のタグを表示 */}\n          {architect.nationality && (\n            <Chip \n              icon={<PublicIcon />} \n              label={`nationality:${architect.nationality}`} \n              variant=\"outlined\" \n              onClick={() => handleTagClick('nationality', architect.nationality)}\n              clickable\n            />\n          )}\n          {architect.birthYear > 0 && (\n            <Chip \n              icon={<CakeIcon />} \n              label={`born:${Math.floor(architect.birthYear / 10) * 10}s`} \n              variant=\"outlined\" \n              onClick={() => handleTagClick('born', Math.floor(architect.birthYear / 10) * 10)}\n              clickable\n            />\n          )}\n          {architect.deathYear > 0 && (\n            <Chip \n              icon={<PersonOffIcon />} \n              label={`died:${architect.deathYear}`} \n              variant=\"outlined\" \n              onClick={() => handleTagClick('died', architect.deathYear)}\n              clickable\n            />\n          )}\n          {architect.category && (\n            <Chip \n              icon={<CategoryIcon />} \n              label={`category:${architect.category}`} \n              variant=\"outlined\" \n              onClick={() => handleTagClick('category', architect.category)}\n              clickable\n            />\n          )}\n          {architect.office && (\n            <Chip \n              icon={<BusinessIcon />} \n              label={architect.office} \n              variant=\"outlined\" \n            />\n          )}\n        </Box>\n\n        <Divider sx={{ my: 3 }} />\n\n        {/* リンクボタングループ - 区切り線の下に配置 */}\n        <Box sx={{ mb: 3, display: 'flex', flexDirection: 'row', gap: 1 }}>\n          {/* 事務所/建築家のホームページURLがある場合はボタンを表示 */}\n          {architect.website && (\n            <Tooltip title=\"公式ホームページ\">\n              <Button\n                href={architect.website.startsWith('http') ? architect.website : `http://${architect.website}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                startIcon={<LinkIcon />}\n                variant=\"contained\"\n                size=\"small\"\n                sx={{ \n                  backgroundColor: '#4caf50', \n                  color: '#ffffff',\n                  '&:hover': { \n                    backgroundColor: '#388e3c',\n                  }\n                }}\n              >\n                ホームページ\n              </Button>\n            </Tooltip>\n          )}\n          \n          <Tooltip title=\"Google検索\">\n            <Button\n              href={getGoogleSearchUrl(architect.name, architect.nationality)}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              startIcon={<SearchIcon />}\n              variant=\"contained\"\n              size=\"small\"\n              sx={{ \n                backgroundColor: '#4285F4', \n                color: '#ffffff',\n                '&:hover': { \n                  backgroundColor: '#3367D6',\n                }\n              }}\n            >\n              検索\n            </Button>\n          </Tooltip>\n          \n          <Tooltip title=\"Wikipediaで検索\">\n            <Button\n              href={getWikipediaSearchUrl(architect.name)}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              startIcon={<WikipediaIcon />}\n              variant=\"contained\"\n              size=\"small\"\n              sx={{ \n                backgroundColor: '#333333', \n                color: '#ffffff',\n                '&:hover': { \n                  backgroundColor: '#222222',\n                }\n              }}\n            >\n              Wikipedia\n            </Button>\n          </Tooltip>\n        </Box>\n\n        <TableContainer component={Paper} variant=\"outlined\" sx={{ mb: 4 }}>\n          <Table>\n            <TableBody>\n              {architect.nationality && (\n                <TableRow>\n                  <TableCell component=\"th\" sx={{ width: '30%', bgcolor: 'rgba(0, 0, 0, 0.03)' }}>\n                    <Typography variant=\"subtitle2\">国籍</Typography>\n                  </TableCell>\n                  <TableCell>{architect.nationality}</TableCell>\n                </TableRow>\n              )}\n              \n              {(architect.birthYear > 0 || architect.deathYear > 0) && (\n                <TableRow>\n                  <TableCell component=\"th\" sx={{ width: '30%', bgcolor: 'rgba(0, 0, 0, 0.03)' }}>\n                    <Typography variant=\"subtitle2\">生年 - 没年</Typography>\n                  </TableCell>\n                  <TableCell>\n                    {architect.birthYear > 0 ? `${architect.birthYear}年` : '不明'} \n                    {architect.deathYear > 0 ? ` - ${architect.deathYear}年` : ''}\n                  </TableCell>\n                </TableRow>\n              )}\n\n              {architect.office && (\n                <TableRow>\n                  <TableCell component=\"th\" sx={{ width: '30%', bgcolor: 'rgba(0, 0, 0, 0.03)' }}>\n                    <Typography variant=\"subtitle2\">事務所</Typography>\n                  </TableCell>\n                  <TableCell>{architect.office}</TableCell>\n                </TableRow>\n              )}\n\n              {architect.prefecture && (\n                <TableRow>\n                  <TableCell component=\"th\" sx={{ width: '30%', bgcolor: 'rgba(0, 0, 0, 0.03)' }}>\n                    <Typography variant=\"subtitle2\">拠点</Typography>\n                  </TableCell>\n                  <TableCell>{architect.prefecture}</TableCell>\n                </TableRow>\n              )}\n              \n              {architect.nameEn && (\n                <TableRow>\n                  <TableCell component=\"th\" sx={{ width: '30%', bgcolor: 'rgba(0, 0, 0, 0.03)' }}>\n                    <Typography variant=\"subtitle2\">英語表記</Typography>\n                  </TableCell>\n                  <TableCell>{architect.nameEn}</TableCell>\n                </TableRow>\n              )}\n\n              {/* 教育背景 */}\n              {(architect.school || architect.faculty || architect.schoolAbroad) && (\n                <TableRow>\n                  <TableCell component=\"th\" sx={{ width: '30%', bgcolor: 'rgba(0, 0, 0, 0.03)' }}>\n                    <Typography variant=\"subtitle2\">教育背景</Typography>\n                  </TableCell>\n                  <TableCell>\n                    <Box sx={{ display: 'flex', alignItems: 'center' }}>\n                      <SchoolIcon sx={{ mr: 1, fontSize: '1rem', color: 'text.secondary' }} />\n                      <Typography variant=\"body2\">{formatEducation()}</Typography>\n                    </Box>\n                  </TableCell>\n                </TableRow>\n              )}\n\n              {/* 師事した建築家 */}\n              {(architect.teacher1 || architect.teacher2 || architect.teacher3) && (\n                <TableRow>\n                  <TableCell component=\"th\" sx={{ width: '30%', bgcolor: 'rgba(0, 0, 0, 0.03)' }}>\n                    <Typography variant=\"subtitle2\">師事した建築家</Typography>\n                  </TableCell>\n                  <TableCell>\n                    <Box sx={{ display: 'flex', flexDirection: 'column', gap: 1 }}>\n                      {formatTeachers()}\n                    </Box>\n                  </TableCell>\n                </TableRow>\n              )}\n\n              {/* カテゴリー */}\n              {architect.category && (\n                <TableRow>\n                  <TableCell component=\"th\" sx={{ width: '30%', bgcolor: 'rgba(0, 0, 0, 0.03)' }}>\n                    <Typography variant=\"subtitle2\">カテゴリー</Typography>\n                  </TableCell>\n                  <TableCell>{architect.category}</TableCell>\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </TableContainer>\n\n        {/* 受賞歴・選定タグの表示 */}\n        {allTags.size > 0 && (\n          <Box sx={{ mb: 4 }}>\n            <Typography variant=\"h6\" gutterBottom>\n              受賞歴・選定\n            </Typography>\n            <Box sx={{ display: 'flex', flexWrap: 'wrap', gap: 1, mb: 2 }}>\n              {Array.from(allTags).map((tag, index) => (\n                <Chip \n                  key={index}\n                  icon={<EmojiEventsIcon />}\n                  label={String(tag)}\n                  onClick={() => handleTagClick('category', tag)}\n                  clickable\n                  color=\"secondary\"\n                  variant=\"outlined\"\n                  size=\"small\"\n                />\n              ))}\n            </Box>\n          </Box>\n        )}\n\n        {architect.bio && (\n          <Box sx={{ mb: 4 }}>\n            <Typography variant=\"h6\" gutterBottom>\n              経歴\n            </Typography>\n            <Typography variant=\"body1\" sx={{ whiteSpace: 'pre-line' }}>\n              {architect.bio}\n            </Typography>\n          </Box>\n        )}\n\n        {architect.works && architect.works.length > 0 && (\n          <>\n            <Box sx={{ mb: 4 }}>\n              <Typography variant=\"h6\" gutterBottom>\n                作品マップ\n              </Typography>\n              {architect.works.some(work => work.latitude && work.longitude) ? (\n                <Box sx={{ height: '400px', width: '100%', mb: 3, border: '1px solid #eee', borderRadius: '4px', overflow: 'hidden' }}>\n                  <MapComponent \n                    markers={architect.works.filter(work => work.latitude && work.longitude)}\n                    zoom={5}\n                    center={[architect.works[0].latitude || 35.6762, architect.works[0].longitude || 139.6503]}\n                  />\n                </Box>\n              ) : (\n                <Typography variant=\"body2\" color=\"text.secondary\">\n                  位置情報が登録されている作品がありません。\n                </Typography>\n              )}\n            </Box>\n\n            <Box sx={{ mb: 4 }}>\n              <Typography variant=\"h6\" gutterBottom>\n                代表作品\n              </Typography>\n              <ArchitectureList architectures={architect.works} />\n            </Box>\n          </>\n        )}\n      </Paper>\n    </Container>\n  );\n};\n\nexport default ArchitectSinglePage; ","import React, { useState, useEffect } from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport { \n  Container, \n  Typography, \n  Box, \n  Paper, \n  TextField,\n  Button,\n  FormControl,\n  InputLabel,\n  Select,\n  MenuItem,\n  Grid,\n  CircularProgress,\n  Chip,\n  Card,\n  CardContent,\n  CardActionArea,\n  Drawer,\n  List,\n  ListItem,\n  ListItemText,\n  Divider\n} from '@mui/material';\nimport SearchIcon from '@mui/icons-material/Search';\nimport FilterListIcon from '@mui/icons-material/FilterList';\nimport MapIcon from '@mui/icons-material/Map';\nimport { ArchitectureService } from '../services/db';\nimport MapComponent from '../components/Map';\n\ninterface Work {\n  id: number;\n  name: string;\n  architectName?: string;\n  completedYear: number;\n  city?: string;\n  location: string;\n  latitude: number;\n  longitude: number;\n}\n\ninterface Filters {\n  yearFrom: string;\n  yearTo: string;\n}\n\ninterface TimeframeResult {\n  from: number;\n  to: number;\n}\n\nconst MapPage: React.FC = () => {\n  const [loading, setLoading] = useState<boolean>(true);\n  const [works, setWorks] = useState<Work[]>([]);\n  const [allWorks, setAllWorks] = useState<Work[]>([]);\n  const [filters, setFilters] = useState<Filters>({\n    yearFrom: '',\n    yearTo: '',\n  });\n  const [showFilters, setShowFilters] = useState<boolean>(false);\n  const [selectedWork, setSelectedWork] = useState<Work | null>(null);\n  const [showWorkDetails, setShowWorkDetails] = useState<boolean>(false);\n\n  useEffect(() => {\n    fetchWorks();\n  }, []);\n\n  // ランダムな年代の範囲を生成する関数\n  const generateRandomTimeframe = (works: Work[]): TimeframeResult => {\n    if (!works || works.length === 0) return { from: 0, to: 0 };\n    \n    // 有効な年代の作品をフィルタリング\n    const validWorks = works.filter(work => work.completedYear > 0);\n    if (validWorks.length === 0) return { from: 0, to: 0 };\n    \n    // 全ての年代をソート\n    const years = validWorks.map(work => work.completedYear).sort((a, b) => a - b);\n    \n    // 最小年と最大年を取得\n    const minYear = years[0];\n    const maxYear = years[years.length - 1];\n    \n    // 100年程度の範囲をランダムに選択（または利用可能な範囲の半分程度）\n    const range = Math.min(100, Math.floor((maxYear - minYear) / 2));\n    \n    // 開始年をランダムに選択（全範囲の中で）\n    const startYearIndex = Math.floor(Math.random() * (years.length - Math.floor(years.length / 4)));\n    const startYear = years[startYearIndex];\n    \n    // 最大でも開始年+範囲、または最大年のいずれか小さい方を終了年とする\n    const endYear = Math.min(startYear + range, maxYear);\n    \n    return { from: startYear, to: endYear };\n  };\n\n  const fetchWorks = async (): Promise<void> => {\n    setLoading(true);\n    try {\n      // ブラウザ内SQLiteを使用してデータを取得\n      const data = await ArchitectureService.getArchitectureForMap();\n      setAllWorks(data);\n      \n      // 初回読み込み時はランダムな年代フィルターを適用\n      if (!filters.yearFrom && !filters.yearTo) {\n        const randomTimeframe = generateRandomTimeframe(data);\n        setFilters({\n          yearFrom: randomTimeframe.from.toString(),\n          yearTo: randomTimeframe.to.toString()\n        });\n        \n        // フィルター適用\n        const filteredData = data.filter(work => \n          work.completedYear >= randomTimeframe.from && \n          work.completedYear <= randomTimeframe.to\n        );\n        \n        setWorks(filteredData);\n      } else {\n        // フィルターによる絞り込み（クライアント側で実行）\n        let filteredWorks = data;\n        \n        if (filters.yearFrom) {\n          filteredWorks = filteredWorks.filter(work => work.completedYear >= parseInt(filters.yearFrom));\n        }\n        \n        if (filters.yearTo) {\n          filteredWorks = filteredWorks.filter(work => work.completedYear <= parseInt(filters.yearTo));\n        }\n        \n        setWorks(filteredWorks);\n      }\n    } catch (error) {\n      console.error('Error fetching works:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleFilterChange = (event: React.ChangeEvent<HTMLInputElement>): void => {\n    const { name, value } = event.target;\n    setFilters({\n      ...filters,\n      [name]: value\n    });\n  };\n\n  const applyFilters = (): void => {\n    setLoading(true);\n    \n    let filteredWorks = allWorks;\n    \n    if (filters.yearFrom) {\n      filteredWorks = filteredWorks.filter(work => work.completedYear >= parseInt(filters.yearFrom));\n    }\n    \n    if (filters.yearTo) {\n      filteredWorks = filteredWorks.filter(work => work.completedYear <= parseInt(filters.yearTo));\n    }\n    \n    setWorks(filteredWorks);\n    setLoading(false);\n  };\n\n  const clearFilters = (): void => {\n    setFilters({\n      yearFrom: '',\n      yearTo: '',\n    });\n    \n    // すべての作品を表示（制限をつけずに表示）\n    setWorks(allWorks);\n  };\n\n  const handleWorkClick = (work: Work): void => {\n    setSelectedWork(work);\n    setShowWorkDetails(true);\n  };\n\n  return (\n    <Container maxWidth=\"lg\" sx={{ py: 4 }}>\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\n        建築地図\n      </Typography>\n\n      <Paper sx={{ p: 3, mb: 4 }}>\n        <Button \n          startIcon={<FilterListIcon />} \n          onClick={() => setShowFilters(!showFilters)}\n          sx={{ mb: 2 }}\n        >\n          {showFilters ? 'フィルターを閉じる' : 'フィルターを表示'}\n        </Button>\n\n        {showFilters && (\n          <Box sx={{ mb: 2 }}>\n            <Grid container spacing={2}>\n              <Grid item xs={12} sm={6} md={4}>\n                <TextField\n                  fullWidth\n                  label=\"年代（から）\"\n                  name=\"yearFrom\"\n                  type=\"number\"\n                  value={filters.yearFrom}\n                  onChange={handleFilterChange}\n                />\n              </Grid>\n              <Grid item xs={12} sm={6} md={4}>\n                <TextField\n                  fullWidth\n                  label=\"年代（まで）\"\n                  name=\"yearTo\"\n                  type=\"number\"\n                  value={filters.yearTo}\n                  onChange={handleFilterChange}\n                />\n              </Grid>\n              <Grid item xs={12} md={4}>\n                <Box sx={{ display: 'flex', gap: 1, height: '100%' }}>\n                  <Button \n                    variant=\"contained\" \n                    color=\"primary\" \n                    onClick={applyFilters}\n                    sx={{ flexGrow: 1 }}\n                  >\n                    フィルター適用\n                  </Button>\n                  <Button \n                    variant=\"outlined\" \n                    onClick={clearFilters} \n                    sx={{ flexGrow: 1 }}\n                  >\n                    クリア\n                  </Button>\n                </Box>\n              </Grid>\n            </Grid>\n          </Box>\n        )}\n\n        <Box sx={{ display: 'flex', alignItems: 'center', mb: 2 }}>\n          <MapIcon sx={{ mr: 1 }} />\n          <Typography variant=\"body2\" color=\"text.secondary\">\n            マップ上に表示された作品: {works.length}件 {filters.yearFrom && filters.yearTo && `(${filters.yearFrom}年〜${filters.yearTo}年)`}\n          </Typography>\n        </Box>\n      </Paper>\n\n      {loading ? (\n        <Box sx={{ display: 'flex', justifyContent: 'center', py: 4 }}>\n          <CircularProgress />\n        </Box>\n      ) : (\n        <Box sx={{ height: 600, bgcolor: 'grey.200', position: 'relative', borderRadius: 1 }}>\n          <MapComponent \n            markers={works}\n            height=\"600px\"\n            zoom={5}\n            center={[35.6762, 139.6503]}\n          />\n          <Box sx={{ position: 'absolute', top: 16, right: 16, width: 320, maxHeight: 568, overflow: 'auto', bgcolor: 'background.paper', borderRadius: 1, boxShadow: 3, p: 2, zIndex: 1000 }}>\n            <Typography variant=\"h6\" gutterBottom>\n              作品リスト\n            </Typography>\n            {works.length === 0 ? (\n              <Typography variant=\"body2\">\n                条件に一致する作品はありません\n              </Typography>\n            ) : (\n              <List dense>\n                {works.map((work) => (\n                  <React.Fragment key={work.id}>\n                    <ListItem \n                      onClick={() => handleWorkClick(work)}\n                      sx={{ \n                        cursor: 'pointer', \n                        bgcolor: selectedWork && selectedWork.id === work.id ? 'action.selected' : 'transparent',\n                        '&:hover': { bgcolor: 'action.hover' } \n                      }}\n                    >\n                      <ListItemText \n                        primary={work.name} \n                        secondary={\n                          <>\n                            {work.architectName && <span>{work.architectName}<br /></span>}\n                            {work.completedYear > 0 && `${work.completedYear}年 | `}\n                            {work.city || ''}\n                          </>\n                        } \n                      />\n                    </ListItem>\n                    <Divider component=\"li\" />\n                  </React.Fragment>\n                ))}\n              </List>\n            )}\n          </Box>\n        </Box>\n      )}\n\n      <Drawer\n        anchor=\"right\"\n        open={showWorkDetails}\n        onClose={() => setShowWorkDetails(false)}\n      >\n        {selectedWork && (\n          <Box sx={{ width: 350, p: 3 }}>\n            <Typography variant=\"h5\" gutterBottom>\n              {selectedWork.name}\n            </Typography>\n            \n            <Box sx={{ mb: 3 }}>\n              {selectedWork.architectName && (\n                <Typography variant=\"subtitle1\" color=\"text.secondary\">\n                  {selectedWork.architectName}\n                </Typography>\n              )}\n              <Typography variant=\"body2\">\n                {selectedWork.completedYear > 0 && `${selectedWork.completedYear}年`}\n                {selectedWork.city && ` | ${selectedWork.city}`}\n              </Typography>\n              {selectedWork.location && (\n                <Typography variant=\"body2\" sx={{ mt: 1 }}>\n                  {selectedWork.location}\n                </Typography>\n              )}\n            </Box>\n            \n            <Box sx={{ mb: 3, height: 200 }}>\n              <MapComponent \n                singleMarker={selectedWork}\n                height=\"200px\"\n                zoom={15}\n                center={[selectedWork.latitude, selectedWork.longitude]}\n              />\n            </Box>\n\n            <Box sx={{ display: 'flex', justifyContent: 'space-between', mt: 4 }}>\n              <Button \n                variant=\"outlined\" \n                onClick={() => setShowWorkDetails(false)}\n              >\n                閉じる\n              </Button>\n              <Button \n                variant=\"contained\" \n                component={RouterLink}\n                to={`/architecture/${selectedWork.id}`}\n              >\n                詳細を見る\n              </Button>\n            </Box>\n          </Box>\n        )}\n      </Drawer>\n    </Container>\n  );\n};\n\nexport default MapPage; ","/**\n * ErrorBoundary component for catching and displaying runtime errors gracefully\n * This improves user experience by showing friendly error messages instead of crashing the app\n */\n\nimport React, { Component, ErrorInfo, ReactNode } from 'react';\nimport { Box, Typography, Button, Paper } from '@mui/material';\n\ninterface Props {\n  children: ReactNode;\n  fallback?: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n  error: Error | null;\n  errorInfo: ErrorInfo | null;\n}\n\nclass ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      hasError: false,\n      error: null,\n      errorInfo: null\n    };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    // Update state so the next render shows the fallback UI\n    return { hasError: true, error, errorInfo: null };\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo): void {\n    // You can log the error to an error reporting service here\n    console.error('Uncaught error:', error, errorInfo);\n    this.setState({\n      error,\n      errorInfo\n    });\n  }\n\n  handleRetry = (): void => {\n    // Simply reload the page as a basic recovery mechanism\n    window.location.reload();\n  };\n\n  render(): ReactNode {\n    if (this.state.hasError) {\n      // Custom fallback UI\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      // Default error UI\n      return (\n        <Box\n          sx={{\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'center',\n            padding: 4,\n            height: '100vh'\n          }}\n        >\n          <Paper\n            elevation={3}\n            sx={{\n              padding: 4,\n              maxWidth: 600,\n              width: '100%',\n              borderRadius: 2,\n              textAlign: 'center'\n            }}\n          >\n            <Typography variant=\"h5\" color=\"error\" gutterBottom>\n              問題が発生しました\n            </Typography>\n            \n            <Typography variant=\"body1\" paragraph>\n              アプリケーションで予期しないエラーが発生しました。\n              お手数ですが、再読み込みをお試しください。\n            </Typography>\n\n            {process.env.NODE_ENV === 'development' && this.state.error && (\n              <Box\n                sx={{\n                  mt: 2,\n                  p: 2,\n                  bgcolor: '#f5f5f5',\n                  borderRadius: 1,\n                  textAlign: 'left',\n                  overflowX: 'auto'\n                }}\n              >\n                <Typography variant=\"subtitle2\" gutterBottom>\n                  Error details (開発モードのみ表示):\n                </Typography>\n                <Typography\n                  variant=\"body2\"\n                  component=\"pre\"\n                  sx={{\n                    whiteSpace: 'pre-wrap',\n                    fontSize: '0.8rem'\n                  }}\n                >\n                  {this.state.error.toString()}\n                </Typography>\n                {this.state.errorInfo && (\n                  <Typography\n                    variant=\"body2\"\n                    component=\"pre\"\n                    sx={{\n                      whiteSpace: 'pre-wrap',\n                      fontSize: '0.8rem',\n                      mt: 1\n                    }}\n                  >\n                    {this.state.errorInfo.componentStack}\n                  </Typography>\n                )}\n              </Box>\n            )}\n\n            <Box sx={{ mt: 3 }}>\n              <Button\n                variant=\"contained\"\n                color=\"primary\"\n                onClick={this.handleRetry}\n                sx={{ mr: 2 }}\n              >\n                ページを再読み込み\n              </Button>\n              <Button\n                variant=\"outlined\"\n                onClick={() => window.location.href = '/'}\n              >\n                ホームに戻る\n              </Button>\n            </Box>\n          </Paper>\n        </Box>\n      );\n    }\n\n    // If there's no error, render children normally\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;","/**\n * GitHub Pages redirection utility\n * \n * This module handles the redirection mechanism used with GitHub Pages\n * for single-page applications. It works with the 404.html pattern\n * to support client-side routing in GitHub Pages.\n */\n\n/**\n * Parse GitHub Pages redirect URL parameters\n * \n * When a user directly accesses a route like /architects/123\n * GitHub Pages serves the 404.html which redirects to /?/architects/123\n * This function extracts the original path and redirects correctly\n */\nexport function handleGitHubPagesRedirect(): void {\n  // Check if we're on a GitHub Pages redirect URL\n  if (\n    typeof window !== 'undefined' && // Check for browser environment\n    window.location.search.includes('?/') // Detect GitHub Pages redirect pattern\n  ) {\n    // Extract the path from the search params\n    const redirectedPath = window.location.search\n      .substring(2) // Remove the '?/' prefix\n      .replace(/~and~/g, '&'); // Replace encoded ampersands\n\n    // Extract any hash fragment\n    const hashFragment = window.location.hash;\n\n    // Remove any search params after handling the redirect\n    const cleanUrl = \n      window.location.origin + \n      window.location.pathname + \n      (hashFragment || '');\n\n    // Use History API to replace the URL without reloading\n    window.history.replaceState(\n      null,\n      document.title,\n      cleanUrl + (hashFragment || '')\n    );\n\n    console.log('Handled GitHub Pages redirect for path:', redirectedPath);\n  }\n}\n\n/**\n * GitHubページに関連するユーティリティ関数\n * GitHub Pagesで動作するSPAに必要な処理を提供\n */\n\n/**\n * 実行環境がGitHub Pagesかどうかを判定\n * @returns GitHub Pages環境ならtrue\n */\nexport const isGitHubPages = (): boolean => {\n  try {\n    // GitHubページのURLパターンをチェック\n    const hostname = window?.location?.hostname || '';\n    return /github\\.io$/.test(hostname);\n  } catch (e) {\n    console.error('環境チェックエラー:', e);\n    return false;\n  }\n};\n\n/**\n * GitHubページのベースURLを取得\n * @returns ベースURL（例: /archi-site）\n */\nexport const getBaseUrl = (): string => {\n  if (!isGitHubPages()) {\n    return '';\n  }\n  \n  try {\n    const pathname = window?.location?.pathname || '';\n    // 最初のパスセグメントを取得（リポジトリ名）\n    const firstPathSegment = pathname.split('/').filter(Boolean)[0];\n    return firstPathSegment ? `/${firstPathSegment}` : '';\n  } catch (e) {\n    console.error('ベースURL取得エラー:', e);\n    return '';\n  }\n};\n\n/**\n * HashRouterで使用する相対パスを絶対パスに変換\n * @param relativePath 相対パス（例: architecture/123）\n * @returns ハッシュ付きのパス（例: /#/architecture/123）\n */\nexport const toHashPath = (relativePath: string): string => {\n  // 先頭の/を除去\n  const cleanPath = relativePath.startsWith('/') \n    ? relativePath.substring(1) \n    : relativePath;\n  \n  // #/プレフィックスを追加\n  return `#/${cleanPath}`;\n};\n\n/**\n * アセットの絶対URLを取得（GitHub Pages環境では相対パスの解決が必要）\n * @param assetPath アセットへの相対パス\n * @returns 絶対パス\n */\nexport const getAssetUrl = (assetPath: string): string => {\n  // 先頭の/を除去\n  const cleanPath = assetPath.startsWith('/') \n    ? assetPath.substring(1) \n    : assetPath;\n  \n  // GitHub Pages環境ではベースパスを先頭に追加\n  if (isGitHubPages()) {\n    const baseUrl = getBaseUrl();\n    return `${baseUrl}/${cleanPath}`;\n  }\n  \n  // 開発環境では通常の相対パスを使用\n  return `/${cleanPath}`;\n};\n\n/**\n * 現在のURL（ハッシュ部分含む）をコピーするための関数\n * シェア機能などで使用\n * @returns 成功時はtrue\n */\nexport const copyCurrentUrl = async (): Promise<boolean> => {\n  try {\n    // 現在のURLを取得\n    const url = window.location.href;\n    \n    // Clipboard APIが利用可能ならそれを使用\n    if (navigator.clipboard) {\n      await navigator.clipboard.writeText(url);\n      return true;\n    }\n    \n    // フォールバック: 一時的な要素を作成してコピー\n    const textArea = document.createElement('textarea');\n    textArea.value = url;\n    textArea.style.position = 'fixed';\n    document.body.appendChild(textArea);\n    textArea.focus();\n    textArea.select();\n    \n    const successful = document.execCommand('copy');\n    document.body.removeChild(textArea);\n    \n    return successful;\n  } catch (err) {\n    console.error('URL複製エラー:', err);\n    return false;\n  }\n};","/**\n * Database Utilities\n * \n * Utility functions for working with database results.\n */\n\ntype QueryResult = {\n  columns: string[];\n  values: any[][];\n};\n\n/**\n * Convert a SQL.js query result to an array of objects\n * where each object represents a row with column names as keys\n * \n * @param result SQL.js query result\n * @returns Array of objects\n */\nexport const resultToObjects = (result?: QueryResult): any[] => {\n  if (!result || !result.columns || !result.values) return [];\n  \n  const { columns, values } = result;\n  return values.map(row => {\n    const obj: Record<string, any> = {};\n    columns.forEach((col, i) => {\n      obj[col] = row[i];\n    });\n    return obj;\n  });\n};\n\n/**\n * Escape and validate a column name for use in ORDER BY clauses\n * to prevent SQL injection\n * \n * @param columnName Column name to escape\n * @returns Safe column name\n */\nexport const escapeSortColumn = (columnName: string): string => {\n  if (!columnName) return 'ZAA_NAME'; // Default sort column\n  \n  // Allow only alphanumeric and underscore characters\n  const safeColumn = columnName.replace(/[^a-zA-Z0-9_]/g, '');\n  \n  // List of allowed columns (whitelist approach)\n  const allowedColumns = [\n    'ZAA_ID', 'ZAA_NAME', 'ZAA_PREFECTURE', 'ZAA_CITY', 'ZAA_YEAR',\n    'ZAR_ID', 'ZAR_NAME', 'ZAR_BIRTHYEAR', 'ZAR_NATIONALITY',\n    'id', 'name', 'prefecture', 'city', 'year', 'birthyear', 'nationality'\n  ];\n  \n  // If the sanitized column is in the allowed list, return it\n  if (allowedColumns.includes(safeColumn)) {\n    return safeColumn;\n  }\n  \n  // For columns not in the whitelist, we still allow them if they're safe\n  // (only contain alphanumeric and underscore characters)\n  return safeColumn;\n};\n\n/**\n * Database utilities for debugging and verification\n */\n\nimport { isDatabaseAvailable } from '../services/db';\nimport { isGitHubPages } from './githubPages';\nimport type { DatabaseMetadata } from '../types/db';\n\n// Debug flag - set to true to enable verbose logging\nconst DEBUG = true;\n\n/**\n * Verifies that the database can be loaded correctly in the current environment\n * and logs detailed information about any issues encountered\n */\nexport async function verifyDatabaseLoading(): Promise<boolean> {\n  try {\n    console.log('🔍 Verifying database availability...');\n    \n    // Check if we're in production (GitHub Pages) environment\n    const isProduction = import.meta.env.PROD;\n    console.log(`📊 Environment: ${isProduction ? 'Production' : 'Development'}`);\n    \n    // Log base URL information\n    const baseUrl = isProduction ? '/archi-site' : '';\n    console.log(`🌐 Base URL: ${baseUrl}`);\n    console.log(`🗄️ Expected database path: ${baseUrl}/db/archimap.sqlite`);\n    console.log(`📑 Expected suffix path: ${baseUrl}/db/archimap.sqlite.suffix`);\n    \n    // Try to check database availability\n    const startTime = performance.now();\n    const isAvailable = await isDatabaseAvailable();\n    const endTime = performance.now();\n    \n    if (isAvailable) {\n      console.log(`✅ Database verification successful! (${(endTime - startTime).toFixed(2)}ms)`);\n      return true;\n    } else {\n      console.error('❌ Database verification failed - database is not available');\n      \n      // More detailed diagnostics in production\n      if (isProduction) {\n        console.error('📋 Production diagnostics:');\n        console.error(' - Check that database files exist in the build output');\n        console.error(' - Verify CORS headers if using a CDN');\n        console.error(' - Check for console errors related to WASM loading');\n        console.error(' - Ensure sql-wasm.wasm is accessible');\n      }\n      \n      return false;\n    }\n  } catch (error) {\n    console.error('💥 Database verification error:', error);\n    return false;\n  }\n}\n\n/**\n * データベース設定の詳細をログに出力\n * 開発時のデバッグ用\n */\nexport const logDatabaseDetails = async (): Promise<void> => {\n  try {\n    const isProduction = import.meta.env?.PROD || false;\n    const isGHPages = isGitHubPages();\n    \n    console.log(`アプリケーション環境: ${isProduction ? '本番' : '開発'}`);\n    console.log(`GitHub Pages環境: ${isGHPages ? 'はい' : 'いいえ'}`);\n    \n    // 本番環境ではデータベース情報ファイルを取得\n    if (isProduction) {\n      try {\n        const dbInfoPath = isGHPages ? './db/database-info.json' : '/db/database-info.json';\n        const response = await fetch(dbInfoPath);\n        \n        if (response.ok) {\n          const dbInfo: DatabaseMetadata = await response.json();\n          \n          console.log('データベース情報:');\n          console.log(`- ファイル: ${dbInfo.database}`);\n          console.log(`- 更新日時: ${dbInfo.date}`);\n          console.log(`- サイズ: ${(dbInfo.size / 1024 / 1024).toFixed(2)} MB`);\n          console.log(`- チャンク: ${dbInfo.chunks} (${dbInfo.chunkSize / 1024}KB)のチャンク`);\n          console.log(`- テーブル数: ${dbInfo.tables.length}`);\n          console.log(`- インデックス数: ${dbInfo.indexes.length}`);\n        } else {\n          console.warn('データベースメタデータが見つかりません:', response.status);\n        }\n      } catch (error) {\n        console.warn('データベースメタデータ読み込みエラー:', error);\n      }\n    } else {\n      console.log('開発環境: データベースメタデータ読み込みをスキップ');\n    }\n  } catch (error) {\n    console.error('データベース設定ログエラー:', error);\n  }\n};\n\n/**\n * データベースエラーのフォーマット\n * @param error エラーオブジェクト\n * @returns フォーマット済みエラーメッセージ\n */\nexport const formatDatabaseError = (error: unknown): string => {\n  if (error instanceof Error) {\n    return `データベースエラー: ${error.message}`;\n  }\n  return `データベースエラー: ${String(error)}`;\n};\n\n/**\n * クエリパフォーマンスを測定するためのラッパー関数\n * @param name クエリの名前/識別子\n * @param fn 実行する非同期関数\n * @returns 元の関数の結果\n */\nexport async function measureQueryPerformance<T>(\n  name: string,\n  fn: () => Promise<T>\n): Promise<T> {\n  const start = performance.now();\n  try {\n    const result = await fn();\n    const duration = performance.now() - start;\n    \n    // 100ms以上かかるクエリは警告\n    if (duration > 100) {\n      console.warn(`クエリパフォーマンス警告 [${name}]: ${duration.toFixed(2)}ms`);\n    } else {\n      console.log(`クエリ実行 [${name}]: ${duration.toFixed(2)}ms`);\n    }\n    \n    return result;\n  } catch (error) {\n    const duration = performance.now() - start;\n    console.error(`クエリエラー [${name}]: ${duration.toFixed(2)}ms`, error);\n    throw error;\n  }\n}\n\n/**\n * Extract database loading errors from error objects\n */\nexport function extractDatabaseErrorDetails(error: unknown): string {\n  if (!error) return 'Unknown error';\n  \n  if (error instanceof Error) {\n    // Check for specific error patterns\n    if (error.message.includes('Failed to fetch')) {\n      return 'Network error: Could not download the database file. ' +\n             'Check your network connection and ensure the database URL is correct.';\n    }\n    \n    if (error.message.includes('WebAssembly')) {\n      return 'WebAssembly error: Could not initialize SQL.js. ' +\n             'Ensure your browser supports WebAssembly and that sql-wasm.wasm is accessible.';\n    }\n    \n    if (error.message.includes('SharedArrayBuffer')) {\n      return 'SharedArrayBuffer error: This feature requires cross-origin isolation. ' +\n             'Please ensure the server has the correct COOP and COEP headers.';\n    }\n    \n    return error.message;\n  }\n  \n  return String(error);\n}","import React, { useEffect, useState } from 'react';\nimport { CircularProgress, Box, Typography, Alert } from '@mui/material';\nimport { initDatabase, DatabaseStatus, getDatabaseStatus } from '../services/db/ClientDatabaseService';\n\ninterface DatabaseLoaderProps {\n  children: React.ReactNode;\n}\n\n/**\n * データベースの初期化と読み込み状態を管理するコンポーネント\n */\nexport const DatabaseLoader: React.FC<DatabaseLoaderProps> = ({ children }) => {\n  const [status, setStatus] = useState<DatabaseStatus>(getDatabaseStatus());\n  const [error, setError] = useState<string | null>(null);\n  const [progress, setProgress] = useState<number>(0);\n  \n  useEffect(() => {\n    let isMounted = true;\n    let progressInterval: NodeJS.Timeout;\n    \n    const initDb = async () => {\n      // 既に接続が確立されている場合は処理不要\n      if (status === DatabaseStatus.READY) {\n        return;\n      }\n      \n      // 進捗表示のためのインターバル（実際の進捗を反映するにはイベントリスナーが必要）\n      progressInterval = setInterval(() => {\n        if (isMounted) {\n          setProgress(prev => {\n            // 95%まで徐々に増加（残りは実際の完了時に設定）\n            const increment = (95 - prev) * 0.1;\n            return Math.min(prev + increment, 95);\n          });\n        }\n      }, 300);\n      \n      try {\n        await initDatabase();\n        \n        if (isMounted) {\n          setProgress(100);\n          setStatus(DatabaseStatus.READY);\n        }\n      } catch (err) {\n        if (isMounted) {\n          setError(`データベースの初期化に失敗しました: ${err instanceof Error ? err.message : '不明なエラー'}`);\n          setStatus(DatabaseStatus.ERROR);\n        }\n      } finally {\n        clearInterval(progressInterval);\n      }\n    };\n    \n    initDb();\n    \n    return () => {\n      isMounted = false;\n      clearInterval(progressInterval);\n    };\n  }, [status]);\n  \n  // 読み込み中の表示\n  if (status !== DatabaseStatus.READY) {\n    return (\n      <Box\n        display=\"flex\"\n        flexDirection=\"column\"\n        justifyContent=\"center\"\n        alignItems=\"center\"\n        height=\"100vh\"\n        bgcolor=\"#f5f5f5\"\n      >\n        <Box textAlign=\"center\" maxWidth=\"600px\" p={3}>\n          <Typography variant=\"h4\" gutterBottom>\n            日本の建築マップ\n          </Typography>\n          \n          {status === DatabaseStatus.ERROR ? (\n            <Alert severity=\"error\" sx={{ mt: 3, mb: 3 }}>\n              {error || 'データベースの読み込み中にエラーが発生しました。再読み込みしてください。'}\n            </Alert>\n          ) : (\n            <>\n              <Typography variant=\"body1\" sx={{ mb: 3 }}>\n                データベースを読み込んでいます。しばらくお待ちください...\n              </Typography>\n              \n              <CircularProgress \n                variant=\"determinate\" \n                value={progress} \n                size={60} \n                thickness={4} \n              />\n              \n              <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mt: 2 }}>\n                {progress.toFixed(0)}% 完了\n              </Typography>\n            </>\n          )}\n          \n          {status === DatabaseStatus.ERROR && (\n            <Box mt={3}>\n              <button\n                onClick={() => {\n                  setError(null);\n                  setStatus(DatabaseStatus.NOT_INITIALIZED);\n                }}\n                style={{\n                  padding: '8px 16px',\n                  fontSize: '1rem',\n                  cursor: 'pointer',\n                }}\n              >\n                再試行\n              </button>\n            </Box>\n          )}\n        </Box>\n      </Box>\n    );\n  }\n  \n  // データベースの準備ができたら子コンポーネントを表示\n  return <>{children}</>;\n};\n\nexport default DatabaseLoader;","import { createTheme, ThemeOptions } from '@mui/material/styles';\n\n// Modern architecture-inspired color palette\nconst palette = {\n  primary: {\n    main: '#2E3440',     // Dark blue-gray (Nordic dark)\n    light: '#4C566A',    // Lighter blue-gray\n    dark: '#1B1F2B',     // Darker blue-gray\n    contrastText: '#FFFFFF',\n  },\n  secondary: {\n    main: '#88C0D0',     // Soft blue (Nordic frost)\n    light: '#B3D4E0',    // Lighter blue\n    dark: '#5E81AC',     // Darker blue\n    contrastText: '#2E3440',\n  },\n  accent: {\n    main: '#D08770',     // Warm orange (Nordic aurora)\n    light: '#E5A088',    // Lighter orange\n    dark: '#BF616A',     // Coral red\n  },\n  background: {\n    default: '#ECEFF4',  // Light gray (Nordic snow)\n    paper: '#FFFFFF',    // Pure white\n    elevated: '#F8F9FA', // Slightly elevated\n  },\n  text: {\n    primary: '#2E3440',  // Dark blue-gray\n    secondary: '#4C566A', // Medium blue-gray\n    disabled: '#D8DEE9', // Light gray\n  },\n  divider: '#E5E9F0',    // Light gray divider\n  success: {\n    main: '#A3BE8C',     // Green (Nordic aurora)\n    light: '#B8CCA3',\n    dark: '#8CAF69',\n  },\n  warning: {\n    main: '#EBCB8B',     // Yellow (Nordic aurora)\n    light: '#F0D5A3',\n    dark: '#D4B571',\n  },\n  error: {\n    main: '#BF616A',     // Red (Nordic aurora)\n    light: '#CC8088',\n    dark: '#A54A56',\n  },\n  info: {\n    main: '#88C0D0',     // Blue (Nordic frost)\n    light: '#B3D4E0',\n    dark: '#5E81AC',\n  },\n};\n\n// Enhanced typography with better hierarchy\nconst typography = {\n  fontFamily: '\"Inter\", \"Roboto\", \"Helvetica Neue\", \"Arial\", sans-serif',\n  h1: {\n    fontSize: '3rem',\n    fontWeight: 700,\n    lineHeight: 1.2,\n    letterSpacing: '-0.02em',\n  },\n  h2: {\n    fontSize: '2.25rem',\n    fontWeight: 600,\n    lineHeight: 1.3,\n    letterSpacing: '-0.01em',\n  },\n  h3: {\n    fontSize: '1.875rem',\n    fontWeight: 600,\n    lineHeight: 1.3,\n    letterSpacing: '-0.01em',\n  },\n  h4: {\n    fontSize: '1.5rem',\n    fontWeight: 600,\n    lineHeight: 1.4,\n  },\n  h5: {\n    fontSize: '1.25rem',\n    fontWeight: 600,\n    lineHeight: 1.4,\n  },\n  h6: {\n    fontSize: '1.125rem',\n    fontWeight: 600,\n    lineHeight: 1.4,\n  },\n  subtitle1: {\n    fontSize: '1rem',\n    fontWeight: 500,\n    lineHeight: 1.5,\n  },\n  subtitle2: {\n    fontSize: '0.875rem',\n    fontWeight: 500,\n    lineHeight: 1.5,\n  },\n  body1: {\n    fontSize: '1rem',\n    fontWeight: 400,\n    lineHeight: 1.6,\n  },\n  body2: {\n    fontSize: '0.875rem',\n    fontWeight: 400,\n    lineHeight: 1.6,\n  },\n  caption: {\n    fontSize: '0.75rem',\n    fontWeight: 400,\n    lineHeight: 1.5,\n  },\n  button: {\n    fontSize: '0.875rem',\n    fontWeight: 600,\n    textTransform: 'none' as const,\n    letterSpacing: '0.02em',\n  },\n};\n\n// Enhanced component styling\nconst components = {\n  MuiButton: {\n    styleOverrides: {\n      root: {\n        borderRadius: 8,\n        padding: '10px 24px',\n        transition: 'all 0.2s ease-in-out',\n        '&:hover': {\n          transform: 'translateY(-1px)',\n          boxShadow: '0 4px 12px rgba(0, 0, 0, 0.15)',\n        },\n      },\n      contained: {\n        boxShadow: '0 2px 8px rgba(0, 0, 0, 0.1)',\n      },\n    },\n  },\n  MuiCard: {\n    styleOverrides: {\n      root: {\n        borderRadius: 12,\n        boxShadow: '0 2px 12px rgba(0, 0, 0, 0.08)',\n        transition: 'all 0.3s ease-in-out',\n        '&:hover': {\n          transform: 'translateY(-2px)',\n          boxShadow: '0 8px 24px rgba(0, 0, 0, 0.15)',\n        },\n      },\n    },\n  },\n  MuiTextField: {\n    styleOverrides: {\n      root: {\n        '& .MuiOutlinedInput-root': {\n          borderRadius: 8,\n          transition: 'all 0.2s ease-in-out',\n          '&:hover': {\n            '& .MuiOutlinedInput-notchedOutline': {\n              borderColor: palette.secondary.main,\n            },\n          },\n          '&.Mui-focused': {\n            '& .MuiOutlinedInput-notchedOutline': {\n              borderColor: palette.primary.main,\n              borderWidth: 2,\n            },\n          },\n        },\n      },\n    },\n  },\n  MuiAppBar: {\n    styleOverrides: {\n      root: {\n        boxShadow: '0 2px 12px rgba(0, 0, 0, 0.1)',\n        backdropFilter: 'blur(10px)',\n        backgroundColor: 'rgba(46, 52, 64, 0.95)',\n      },\n    },\n  },\n  MuiChip: {\n    styleOverrides: {\n      root: {\n        borderRadius: 8,\n        fontWeight: 500,\n      },\n    },\n  },\n  MuiPaper: {\n    styleOverrides: {\n      root: {\n        borderRadius: 12,\n        boxShadow: '0 2px 12px rgba(0, 0, 0, 0.08)',\n      },\n      elevation1: {\n        boxShadow: '0 2px 8px rgba(0, 0, 0, 0.06)',\n      },\n      elevation2: {\n        boxShadow: '0 4px 12px rgba(0, 0, 0, 0.1)',\n      },\n      elevation3: {\n        boxShadow: '0 8px 24px rgba(0, 0, 0, 0.15)',\n      },\n    },\n  },\n};\n\n// Create theme with enhanced styling\nexport const theme = createTheme({\n  palette,\n  typography,\n  components,\n  spacing: 8,\n  shape: {\n    borderRadius: 8,\n  },\n  breakpoints: {\n    values: {\n      xs: 0,\n      sm: 600,\n      md: 960,\n      lg: 1280,\n      xl: 1920,\n    },\n  },\n  transitions: {\n    easing: {\n      easeInOut: 'cubic-bezier(0.4, 0, 0.2, 1)',\n      easeOut: 'cubic-bezier(0.0, 0, 0.2, 1)',\n      easeIn: 'cubic-bezier(0.4, 0, 1, 1)',\n      sharp: 'cubic-bezier(0.4, 0, 0.6, 1)',\n    },\n  },\n} as ThemeOptions);","import React, { useEffect } from 'react';\nimport { HashRouter as Router, Routes, Route, useLocation } from 'react-router-dom';\nimport { ThemeProvider } from '@mui/material/styles';\nimport CssBaseline from '@mui/material/CssBaseline';\nimport Header from './components/Header';\nimport Footer from './components/Footer';\nimport HomePage from './pages/HomePage';\nimport ArchitecturePage from './pages/ArchitecturePage';\nimport ArchitectureSinglePage from './pages/ArchitectureSinglePage';\nimport ArchitectsPage from './pages/ArchitectsPage';\nimport ArchitectSinglePage from './pages/ArchitectSinglePage';\nimport MapPage from './pages/MapPage';\nimport ErrorBoundary from './components/ErrorBoundary';\nimport { logDatabaseDetails } from './utils/dbUtils';\nimport DatabaseLoader from './components/DatabaseLoader';\nimport { theme } from './styles/theme';\n\n/**\n * ScrollToTop component - scrolls to top when route changes\n */\nconst ScrollToTop: React.FC = () => {\n  const { pathname } = useLocation();\n  \n  useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [pathname]);\n  \n  return null;\n};\n\n/**\n * Main application component with routing and providers\n */\nconst AppContent: React.FC = () => {\n  // Log database configuration information when app starts\n  useEffect(() => {\n    // Log if app is running in GitHub Pages production environment\n    const isProduction = import.meta.env?.PROD || false;\n    console.log(`App running in ${isProduction ? 'production' : 'development'} mode`);\n    \n    // Log database configuration details for debugging purposes\n    logDatabaseDetails();\n  }, []);\n\n  return (\n    <>\n      <ScrollToTop />\n      <Header />\n      <main className=\"container\">\n        <Routes>\n          <Route path=\"/\" element={<HomePage />} />\n          <Route path=\"/architecture\" element={<ArchitecturePage />} />\n          <Route path=\"/architecture/:id\" element={<ArchitectureSinglePage />} />\n          <Route path=\"/architects\" element={<ArchitectsPage />} />\n          <Route path=\"/architects/:id\" element={<ArchitectSinglePage />} />\n          <Route path=\"/map\" element={<MapPage />} />\n        </Routes>\n      </main>\n      <Footer />\n    </>\n  );\n};\n\nconst App: React.FC = () => {\n  return (\n    <ErrorBoundary>\n      <ThemeProvider theme={theme}>\n        <CssBaseline />\n        <DatabaseLoader>\n          <Router>\n            <AppContent />\n          </Router>\n        </DatabaseLoader>\n      </ThemeProvider>\n    </ErrorBoundary>\n  );\n};\n\nexport default App;","import React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport { HashRouter } from 'react-router-dom';\nimport './index.css';\nimport App from './App';\n\n// ブラウザコンソールにデバッグメッセージを出力\nconsole.log('React アプリケーションを初期化中...', process.env.NODE_ENV);\nconsole.log('DOM root element:', document.getElementById('root'));\n\n// React 18の新しいcreateRootメソッドを使用\nconst container = document.getElementById('root');\nif (!container) {\n  console.error('root要素が見つかりません。HTMLに<div id=\"root\"></div>が存在するか確認してください。');\n  throw new Error('Failed to find the root element');\n}\nconst root = createRoot(container);\n\n// GitHub Pages対応のためBrowserRouterからHashRouterに変更\n// HashRouterではbasenameは不要（URLのハッシュ部分を使用するため）\nconsole.log('Using HashRouter for GitHub Pages compatibility');\n\ntry {\n  root.render(\n    <React.StrictMode>\n      <HashRouter>\n        <App />\n      </HashRouter>\n    </React.StrictMode>\n  );\n  console.log('React アプリケーションのレンダリングが成功しました');\n} catch (error) {\n  console.error('React アプリケーションのレンダリング中にエラーが発生しました:', error);\n}"],"names":["m","require$$0","createRoot","navLinks","jsx","HomeIcon","ArchitectureIcon","PeopleIcon","MapIcon","StorageIcon","Header","pathname","useLocation","theme","useTheme","isMobile","useMediaQuery","drawerOpen","setDrawerOpen","useState","toggleDrawer","open","event","AppBar","Toolbar","Typography","RouterLink","jsxs","Fragment","IconButton","MenuIcon","Drawer","Box","CloseIcon","List","title","path","icon","ListItem","ListItemText","Button","Footer","Container","DB_CONFIG","WORKER_URL","WASM_URL","dbWorker","isInitializing","initPromise","DatabaseStatus","getDatabaseStatus","initDatabase","createDbWorker","testResult","error","executeQuery","query","params","resultsToObjects","result","columns","values","row","obj","col","i","getSingleResult","results","getResultsArray","getArchitectureById","id","getAllArchitectures","page","limit","searchTerm","sortBy","sortOrder","options","offset","whereClause","joinClause","countQuery","dataQuery","dataParams","total","getArchitectureForMap","bounds","filters","LoadingSkeleton","variant","count","renderCardSkeleton","Card","CardContent","Skeleton","renderListSkeleton","renderHeroSkeleton","renderMapSkeleton","_","index","Grid","HomePage","setSearchTerm","recentWorks","setRecentWorks","loading","setLoading","setError","isDbReady","setIsDbReady","useEffect","data","handleSearch","e","Fade","Stack","Chip","TextField","SearchIcon","TrendingUpIcon","Tooltip","RefreshIcon","Alert","work","CardActionArea","Paper","Divider","ArchitecturePage","architectures","setArchitectures","totalItems","setTotalItems","currentPage","setCurrentPage","tagQuery","setTagQuery","selectedTags","setSelectedTags","selectedTagsWithYears","setSelectedTagsWithYears","availableTags","setAvailableTags","setSortBy","tagYearsMap","setTagYearsMap","yearAnchorEl","setYearAnchorEl","currentTagForYear","setCurrentTagForYear","tagsYears","setTagsYears","itemsPerPage","location","navigate","useNavigate","queryParams","tag","search","year","prefecture","category","architect","sort","tags","t","baseTags","tagWithYears","yearMatch","baseTag","fetchArchitectures","handlePageChange","value","handleSearchChange","handleYearMenuOpen","years","prev","handleYearMenuClose","handleYearSelect","tagWithYear","newTagsWithYears","existingIndex","allTags","tagQueryString","self","searchTermValue","handleTagSelect","newTags","removedTags","removedTag","addedTags","handleClearSearch","handleSortChange","newSortBy","tagValue","yearValue","prefectureValue","categoryValue","architectValue","totalPages","InputAdornment","Autocomplete","getTagProps","option","hasYear","isExpandable","selectedYear","yearDisplay","yearPart","ArrowDropDownIcon","FormControl","InputLabel","Select","SortIcon","MenuItem","Popover","label","color","Pagination","CircularProgress","architecture","PersonIcon","LocationOnIcon","CalendarTodayIcon","L","Map","markers","center","zoom","height","singleMarker","mapCenter","setMapCenter","MapContainer","TileLayer","marker","Marker","Popup","Link","ArchitectureSinglePage","useParams","setWork","ArrowBackIcon","shinkenchikuInfo","shinkenchikuLabel","handleTagClick","getGoogleImageSearchUrl","workName","searchQuery","getWikipediaSearchUrl","CategoryIcon","EmojiEventsIcon","ImageSearchIcon","WikipediaIcon","MapComponent","getArchitectById","getAllArchitects","getArchitectTags","ArchitectsPage","architects","setArchitects","setTotalPages","setSortOrder","nationality","setNationality","setCategory","school","setSchool","birthYearFrom","setBirthYearFrom","birthYearTo","setBirthYearTo","deathYear","setDeathYear","ArchitectService.getArchitectTags","order","nat","cat","sch","birthFrom","birthTo","death","ArchitectService.getAllArchitects","getYearsForArchitectTag","item","updateUrlAndSearch","newParams","newQueryParams","CurrentFilters","activeFilters","f","selectedValue","newSortOrder","ArchitectureList","compact","EventIcon","idx","ArchitectSinglePage","setArchitect","teacherInfo","setTeacherInfo","ArchitectService.getArchitectById","teachers","findArchitectIdByName","err","name","formatEducation","education","eduStr","formatTeachers","teacher","tagType","searchParam","getGoogleSearchUrl","architectName","trimmedTag","architectTags","decade","PublicIcon","CakeIcon","PersonOffIcon","BusinessIcon","LinkIcon","TableContainer","Table","TableBody","TableRow","TableCell","SchoolIcon","MapPage","works","setWorks","allWorks","setAllWorks","setFilters","showFilters","setShowFilters","selectedWork","setSelectedWork","showWorkDetails","setShowWorkDetails","fetchWorks","generateRandomTimeframe","validWorks","a","b","minYear","maxYear","range","startYearIndex","startYear","endYear","ArchitectureService.getArchitectureForMap","randomTimeframe","filteredData","filteredWorks","handleFilterChange","applyFilters","clearFilters","handleWorkClick","FilterListIcon","React","ErrorBoundary","Component","props","errorInfo","isGitHubPages","hostname","logDatabaseDetails","isGHPages","response","dbInfo","DatabaseLoader","children","status","setStatus","progress","setProgress","isMounted","progressInterval","increment","palette","typography","components","createTheme","ScrollToTop","AppContent","Routes","Route","App","ThemeProvider","CssBaseline","Router","container","root","HashRouter"],"mappings":"iiDAEIA,GAAIC,GAENC,GAAqBF,GAAE,WACDA,GAAE,YCyB1B,MAAMG,GAAsB,CAC1B,CAAE,MAAO,MAAO,KAAM,IAAK,KAAMC,EAAAA,IAACC,KAAS,CAAA,EAC3C,CAAE,MAAO,OAAQ,KAAM,gBAAiB,KAAMD,EAAAA,IAACE,KAAiB,CAAA,EAChE,CAAE,MAAO,MAAO,KAAM,cAAe,KAAMF,EAAAA,IAACG,KAAW,CAAA,EACvD,CAAE,MAAO,MAAO,KAAM,OAAQ,KAAMH,EAAAA,IAACI,KAAQ,CAAA,EAC7C,CAAE,MAAO,aAAc,KAAM,eAAgB,KAAMJ,EAAAA,IAACK,KAAY,CAAA,CAClE,EAEMC,GAAmB,IAAM,CAE7B,MAAMC,EADWC,GAAA,EACS,SACpBC,EAAQC,GAAA,EACRC,EAAWC,GAAcH,EAAM,YAAY,KAAK,IAAI,CAAC,EACrD,CAACI,EAAYC,CAAa,EAAIC,EAAAA,SAAkB,EAAK,EAErDC,EAAgBC,GAAmBC,GAAkD,CAEvFA,EAAM,OAAS,YACbA,EAA8B,MAAQ,OAAUA,EAA8B,MAAQ,UAI1FJ,EAAcG,CAAI,CACpB,EAEA,aACGE,GAAA,CAAO,SAAS,SAAS,MAAM,UAC9B,gBAACC,GAAA,CACC,SAAA,CAAApB,EAAAA,IAACqB,EAAA,CACC,QAAQ,KACR,UAAWC,EACX,GAAG,IACH,GAAI,CACF,SAAU,EACV,MAAO,QACP,eAAgB,OAChB,WAAY,MAAA,EAEf,SAAA,UAAA,CAAA,EAIAX,EACCY,EAAAA,KAAAC,WAAA,CACE,SAAA,CAAAxB,EAAAA,IAACyB,GAAA,CACC,KAAK,MACL,MAAM,UACN,aAAW,OACX,QAAST,EAAa,EAAI,EAE1B,eAACU,GAAA,CAAA,CAAS,CAAA,CAAA,EAEZ1B,EAAAA,IAAC2B,GAAA,CACC,OAAO,QACP,KAAMd,EACN,QAASG,EAAa,EAAK,EAE3B,SAAAO,EAAAA,KAACK,EAAA,CACC,GAAI,CAAE,MAAO,GAAA,EACb,KAAK,eACL,QAASZ,EAAa,EAAK,EAC3B,UAAWA,EAAa,EAAK,EAE7B,SAAA,CAAAhB,EAAAA,IAAC4B,GAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,WAAY,EAAG,CAAA,EACzD,SAAA5B,MAACyB,GAAA,CAAW,QAAST,EAAa,EAAK,EACrC,SAAAhB,EAAAA,IAAC6B,GAAA,EAAU,EACb,CAAA,CACF,EACA7B,EAAAA,IAAC8B,IACE,SAAA/B,GAAS,IAAI,CAAC,CAAE,MAAAgC,EAAO,KAAAC,EAAM,KAAAC,CAAA,IAC5BV,EAAAA,KAACW,GAAA,CACC,UAAWZ,EACX,GAAIU,EAEJ,GAAI,CACF,MAAOzB,IAAayB,EAAO,eAAiB,eAC5C,gBAAiBzB,IAAayB,EAAO,sBAAwB,cAC7D,WAAYzB,IAAayB,EAAO,OAAS,SACzC,UAAW,CACT,gBAAiB,qBAAA,CACnB,EAGD,SAAA,CAAAC,EACDjC,MAACmC,IAAa,QAASJ,EAAO,GAAI,CAAE,GAAI,EAAE,CAAG,CAAA,CAAA,EAXxCA,CAAA,CAaR,CAAA,CACH,CAAA,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CACF,EAEA/B,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,MAAA,EACjB,SAAA7B,GAAS,IAAI,CAAC,CAAE,MAAAgC,EAAO,KAAAC,KACtBhC,EAAAA,IAACoC,EAAA,CAEC,UAAWd,EACX,GAAIU,EACJ,MAAM,UACN,GAAI,CACF,GAAI,EACJ,WAAYzB,IAAayB,EAAO,OAAS,SACzC,aAAczB,IAAayB,EAAO,kBAAoB,MAAA,EAGvD,SAAAD,CAAA,EAVIA,CAAA,CAYR,CAAA,CACH,CAAA,CAAA,CAEJ,CAAA,CACF,CAEJ,EC5IMM,GAAmB,IAErBrC,EAAAA,IAAC4B,EAAA,CACC,UAAU,SACV,GAAI,CACF,GAAI,EACJ,GAAI,EACJ,GAAI,OACJ,gBAAiB,eACjB,MAAO,OAAA,EAGT,SAAA5B,EAAAA,IAACsC,IAAU,SAAS,KAClB,gBAACjB,EAAA,CAAW,QAAQ,QAAQ,MAAM,SAAS,SAAA,CAAA,cAC7B,IAAI,KAAA,EAAO,YAAA,CAAY,CAAA,CACrC,CAAA,CACF,CAAA,CAAA,ECfAkB,GAAY,CAChB,KAAM,MACN,OAAQ,CACN,WAAY,OACZ,iBAAkB,KAClB,IAAK,sBAAA,CAET,EAGMC,GAAa,gBACbC,GAAW,kBAGjB,IAAIC,GAAgB,KAChBC,GAAiB,GACjBC,GAAmC,KAKhC,IAAKC,IAAAA,IACVA,EAAA,gBAAkB,kBAClBA,EAAA,aAAe,eACfA,EAAA,MAAQ,QACRA,EAAA,MAAQ,QAJEA,IAAAA,IAAA,CAAA,CAAA,EAUL,MAAMC,GAAoB,IAC3BJ,GACK,QAELC,GACK,eAEF,kBAOII,GAAe,SAA0B,CAEpD,GAAIL,GACF,OAAOA,GAIT,GAAIE,GACF,OAAOA,GAITD,GAAiB,GAEjB,GAAI,CAEFC,GAAcI,GAAAA,eACZ,CAACT,EAAgB,EACjBC,GACAC,GACA,IAAM,QAAQ,IAAI,iBAAiB,CAAA,EAIrCC,GAAW,MAAME,GACjB,QAAQ,IAAI,iBAAiB,EAG7B,MAAMK,EAAa,MAAMP,GAAS,GAAG,KAAK,yBAAyB,EACnE,eAAQ,IAAI,iBAAiBO,EAAW,CAAC,GAAG,OAAO,CAAC,EAAE,CAAC,CAAC,EAAE,EAEnDP,EACT,OAASQ,EAAO,CACd,cAAQ,MAAM,gBAAiBA,CAAK,EAC9BA,CACR,QAAA,CACEP,GAAiB,GACjBC,GAAc,IAChB,CACF,EAQaO,GAAe,MAC1BC,EACAC,EAAgB,KACe,CAC/B,GAAI,CAEF,OAAKX,IACH,MAAMK,GAAA,EAIO,MAAML,GAAS,GAAG,KAAKU,EAAOC,CAAM,CAErD,OAASH,EAAO,CACd,cAAQ,MAAM,YAAaA,CAAK,EAC1BA,CACR,CACF,EAOaI,GACXC,GACQ,CACR,GAAI,CAACA,GAAUA,EAAO,SAAW,EAC/B,MAAO,CAAA,EAGT,KAAM,CAAE,QAAAC,EAAS,OAAAC,GAAWF,EAAO,CAAC,EAEpC,OAAOE,EAAO,IAAIC,GAAO,CACvB,MAAMC,EAA2B,CAAA,EACjC,OAAAH,EAAQ,QAAQ,CAACI,EAAKC,IAAM,CAC1BF,EAAIC,CAAG,EAAIF,EAAIG,CAAC,CAClB,CAAC,EACMF,CACT,CAAC,CACH,EAQaG,GAAkB,MAC7BV,EACAC,EAAgB,KACW,CAC3B,MAAMU,EAAU,MAAMZ,GAAgBC,EAAOC,CAAM,EAEnD,OADgBC,GAAoBS,CAAO,EAC5B,CAAC,CAClB,EAQaC,GAAkB,MAC7BZ,EACAC,EAAgB,KACC,CACjB,MAAMU,EAAU,MAAMZ,GAAgBC,EAAOC,CAAM,EACnD,OAAOC,GAAoBS,CAAO,CACpC,EC7JaE,GAAsB,MAAOC,GACjCJ,GACL,iDACA,CAACI,CAAE,CAAA,EA4BMC,GAAsB,MACjCC,EAAe,EACfC,EAAgB,GAChBC,EAAqB,GACrBC,EAAiB,WACjBC,EAAoB,MACpBC,EAOI,CAAA,IAC8B,CAClC,MAAMC,GAAUN,EAAO,GAAKC,EAG5B,IAAIM,EAAc,MAClB,MAAMtB,EAAgB,CAAA,EAGlBiB,IACFK,GAAe,oEACftB,EAAO,KAAK,IAAIiB,CAAU,IAAK,IAAIA,CAAU,IAAK,IAAIA,CAAU,GAAG,GAIjEG,EAAQ,YACVE,GAAe,2EACftB,EAAO,KAAK,IAAIoB,EAAQ,SAAS,IAAK,IAAIA,EAAQ,SAAS,IAAK,IAAIA,EAAQ,SAAS,GAAG,GAGtFA,EAAQ,WACVE,GAAe,0BACftB,EAAO,KAAK,IAAIoB,EAAQ,QAAQ,GAAG,GAGjCA,EAAQ,aACVE,GAAe,0BACftB,EAAO,KAAKoB,EAAQ,UAAU,GAG5BA,EAAQ,WACVE,GAAe,qBACftB,EAAO,KAAKoB,EAAQ,QAAQ,GAG1BA,EAAQ,SACVE,GAAe,qBACftB,EAAO,KAAKoB,EAAQ,MAAM,GAI5B,IAAIG,EAAa,0EACbH,EAAQ,MAAQA,EAAQ,KAAK,OAAS,IACxCG,GAAc;AAAA;AAAA;AAAA,MAIdD,GAAe,4BACfA,GAAeF,EAAQ,KAAK,IAAI,IAAM,GAAG,EAAE,KAAK,GAAG,EACnDE,GAAe,IACftB,EAAO,KAAK,GAAGoB,EAAQ,IAAI,GAI7B,MAAMI,EAAa;AAAA;AAAA;AAAA,MAGfD,CAAU;AAAA,YACJD,CAAW;AAAA,IAIfG,EAAY;AAAA;AAAA;AAAA,MAGdF,CAAU;AAAA,YACJD,CAAW;AAAA,eACRJ,CAAM,IAAIC,IAAc,OAAS,OAAS,KAAK;AAAA;AAAA,IAKtDO,EAAa,CAAC,GAAG1B,EAAQgB,EAAOK,CAAM,EAE5C,GAAI,CAGF,MAAMM,GADc,MAAMlB,GAAmCe,EAAYxB,CAAM,IACpD,OAAS,EAKpC,MAAO,CACL,QAHoB,MAAMW,GAA8Bc,EAAWC,CAAU,EAI7E,MAAAC,EACA,KAAAZ,EACA,MAAAC,EACA,WAAY,KAAK,KAAKW,EAAQX,CAAK,CAAA,CAEvC,OAASnB,EAAO,CACd,cAAQ,MAAM,gBAAiBA,CAAK,EAC9BA,CACR,CACF,EAoCa+B,GAAwB,MACnCC,EAMAC,EAMI,KACwB,CAE5B,IAAIR,EAAc;AAAA;AAAA;AAAA;AAAA;AAAA,IAOlB,MAAMtB,EAAgB,CACpB6B,EAAO,MACPA,EAAO,MACPA,EAAO,KACPA,EAAO,IAAA,EAILC,EAAQ,aACVR,GAAe,uEACftB,EAAO,KACL,IAAI8B,EAAQ,UAAU,IACtB,IAAIA,EAAQ,UAAU,IACtB,IAAIA,EAAQ,UAAU,GAAA,GAItBA,EAAQ,YACVR,GAAe,2EACftB,EAAO,KACL,IAAI8B,EAAQ,SAAS,IACrB,IAAIA,EAAQ,SAAS,IACrB,IAAIA,EAAQ,SAAS,GAAA,GAIrBA,EAAQ,WACVR,GAAe,qBACftB,EAAO,KAAK8B,EAAQ,QAAQ,GAG1BA,EAAQ,SACVR,GAAe,qBACftB,EAAO,KAAK8B,EAAQ,MAAM,GAI5B,IAAIP,EAAa,0EACbO,EAAQ,MAAQA,EAAQ,KAAK,OAAS,IACxCP,GAAc;AAAA;AAAA;AAAA,MAIdD,GAAe,4BACfA,GAAeQ,EAAQ,KAAK,IAAI,IAAM,GAAG,EAAE,KAAK,GAAG,EACnDR,GAAe,IACftB,EAAO,KAAK,GAAG8B,EAAQ,IAAI,GAI7B,MAAM/B,EAAQ;AAAA;AAAA;AAAA,MAGVwB,CAAU;AAAA,YACJD,CAAW;AAAA;AAAA,IAIrB,OAAOX,GAA8BZ,EAAOC,CAAM,CACpD,ECxPM+B,GAAkD,CAAC,CACvD,QAAAC,EAAU,OACV,MAAAC,EAAQ,CACV,IAAM,CACJ,MAAMC,EAAqB,IACzBvF,EAAAA,IAACwF,GAAA,CAAK,GAAI,CAAE,OAAQ,MAAA,EAClB,SAAAjE,EAAAA,KAACkE,GAAA,CACC,SAAA,CAAAzF,EAAAA,IAAC0F,GAAA,CAAS,QAAQ,OAAO,OAAQ,GAAI,GAAI,CAAE,GAAI,CAAA,CAAE,CAAG,EACpD1F,EAAAA,IAAC0F,GAAA,CAAS,QAAQ,OAAO,OAAQ,GAAI,GAAI,CAAE,GAAI,CAAA,CAAE,CAAG,QACnDA,GAAA,CAAS,QAAQ,OAAO,OAAQ,GAAI,MAAM,KAAA,CAAM,CAAA,CAAA,CACnD,CAAA,CACF,EAGIC,EAAqB,IACzBpE,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,EAAG,GACZ,SAAA,CAAA5B,EAAAA,IAAC0F,GAAA,CAAS,QAAQ,OAAO,OAAQ,GAAI,GAAI,CAAE,GAAI,CAAA,CAAE,CAAG,EACpD1F,EAAAA,IAAC0F,GAAA,CAAS,QAAQ,OAAO,OAAQ,GAAI,GAAI,CAAE,GAAI,CAAA,CAAE,CAAG,QACnDA,GAAA,CAAS,QAAQ,OAAO,OAAQ,GAAI,MAAM,KAAA,CAAM,CAAA,EACnD,EAGIE,EAAqB,IACzB5F,MAACsC,GAAA,CAAU,SAAS,KAClB,SAAAf,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,UAAW,SAAU,GAAI,GAClC,SAAA,CAAA5B,EAAAA,IAAC0F,GAAA,CAAS,QAAQ,OAAO,OAAQ,GAAI,GAAI,CAAE,GAAI,CAAA,CAAE,CAAG,EACpD1F,EAAAA,IAAC0F,GAAA,CAAS,QAAQ,OAAO,OAAQ,GAAI,GAAI,CAAE,GAAI,CAAA,CAAE,CAAG,EACpD1F,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,SAAU,GAAI,CAAA,EACxD,SAAA5B,EAAAA,IAAC0F,IAAS,QAAQ,cAAc,MAAO,IAAK,OAAQ,GAAI,GAAI,CAAE,aAAc,CAAA,CAAE,CAAG,CAAA,CACnF,CAAA,CAAA,CACF,CAAA,CACF,EAGIG,EAAoB,IACxB7F,EAAAA,IAAC0F,GAAA,CACC,QAAQ,cACR,MAAM,OACN,OAAQ,IACR,GAAI,CAAE,aAAc,CAAA,CAAE,CAAA,EAI1B,OAAIL,IAAY,OACPO,EAAA,EAGLP,IAAY,MACPQ,EAAA,EAGLR,IAAY,OAEZrF,MAAC4B,EAAA,CACE,SAAA,MAAM,KAAK,CAAE,OAAQ0D,CAAA,CAAO,EAAE,IAAI,CAACQ,EAAGC,IACrC/F,EAAAA,IAAC4B,EAAA,CAAgB,GAAI,CAAE,aAAc,qBAClC,SAAA+D,EAAA,CAAmB,EADZI,CAEV,CACD,CAAA,CACH,EAKF/F,EAAAA,IAACgG,EAAA,CAAK,UAAS,GAAC,QAAS,EACtB,SAAA,MAAM,KAAK,CAAE,OAAQV,CAAA,CAAO,EAAE,IAAI,CAACQ,EAAGC,IACrC/F,EAAAA,IAACgG,EAAA,CAAK,KAAI,GAAa,GAAI,GAAI,GAAI,EAAG,GAAI,EACvC,SAAAT,EAAA,CAAmB,EADNQ,CAEhB,CACD,EACH,CAEJ,EC/CME,GAAqB,IAAM,CAC/B,KAAM,CAAC3B,EAAY4B,CAAa,EAAInF,EAAAA,SAAiB,EAAE,EACjD,CAACoF,EAAaC,CAAc,EAAIrF,EAAAA,SAA6B,CAAA,CAAE,EAC/D,CAACsF,EAASC,CAAU,EAAIvF,EAAAA,SAAkB,EAAI,EAC9C,CAACmC,EAAOqD,CAAQ,EAAIxF,EAAAA,SAAwB,IAAI,EAChD,CAACyF,EAAWC,CAAY,EAAI1F,EAAAA,SAAkB,EAAK,EAEzD2F,EAAAA,UAAU,IAAM,EACW,SAA2B,CAClD,GAAI,CACFJ,EAAW,EAAI,EACfC,EAAS,IAAI,EACb,QAAQ,IAAI,gBAAgB,EAC5B,MAAMI,EAAO,MAAMxC,GAAoB,EAAG,CAAC,EAC3CiC,EAAeO,EAAK,KAAK,EACzBF,EAAa,EAAI,EACjB,QAAQ,IAAI,iBAAkBE,CAAI,CACpC,OAASzD,EAAY,CACnB,QAAQ,MAAM,cAAeA,CAAK,EAClCqD,EAASrD,EAAM,SAAW,sBAAsB,CAClD,QAAA,CACEoD,EAAW,EAAK,CAClB,CACF,GAEA,CACF,EAAG,CAAA,CAAE,EAEL,MAAMM,EAAgBC,GAA6B,CACjDA,EAAE,eAAA,EACEvC,EAAW,SACb,OAAO,SAAS,KAAO,wBAAwB,mBAAmBA,CAAU,CAAC,GAEjF,EAEA,OACE/C,EAAAA,KAACe,GAAA,CAAU,SAAS,KAElB,SAAA,CAAAtC,EAAAA,IAAC8G,GAAA,CAAK,GAAI,GAAM,QAAS,IACvB,SAAAvF,EAAAA,KAACK,EAAA,CACC,GAAI,CACF,GAAI,EACJ,GAAI,EACJ,UAAW,SACX,WAAY,oDACZ,aAAc,EACd,GAAI,EACJ,SAAU,WACV,SAAU,QAAA,EAGZ,SAAA,CAAA5B,EAAAA,IAAC4B,EAAA,CACC,GAAI,CACF,SAAU,WACV,IAAK,EACL,KAAM,EACN,MAAO,EACP,OAAQ,EACR,QAAS,GACT,WAAY,yHAAA,CACd,CAAA,EAEFL,OAACK,GAAI,GAAI,CAAE,SAAU,WAAY,OAAQ,GACvC,SAAA,CAAA5B,EAAAA,IAACqB,EAAA,CACC,UAAU,KACV,QAAQ,KACR,MAAM,SACN,MAAM,eACN,aAAY,GACZ,GAAI,CACF,WAAY,oDACZ,eAAgB,OAChB,qBAAsB,OACtB,MAAO,cACP,GAAI,CAAA,EAEP,SAAA,UAAA,CAAA,EAGDE,EAAAA,KAACF,EAAA,CACC,QAAQ,KACR,MAAM,SACN,MAAM,iBACN,UAAS,GACT,GAAI,CAAE,GAAI,EAAG,SAAU,IAAK,GAAI,MAAA,EACjC,SAAA,CAAA,6BAEE,KAAA,EAAG,EAAE,YAAA,CAAA,CAAA,EAKRE,EAAAA,KAACwF,GAAA,CACC,UAAU,MACV,QAAS,EACT,eAAe,SACf,GAAI,CAAE,GAAI,CAAA,EAEV,SAAA,CAAA/G,EAAAA,IAACgH,EAAA,CACC,WAAO9G,GAAA,EAAiB,EACxB,MAAM,eACN,MAAM,UACN,QAAQ,UAAA,CAAA,EAEVF,EAAAA,IAACgH,EAAA,CACC,WAAO7G,GAAA,EAAW,EAClB,MAAM,aACN,MAAM,YACN,QAAQ,UAAA,CAAA,EAEVH,EAAAA,IAACgH,EAAA,CACC,WAAO5G,GAAA,EAAQ,EACf,MAAM,OACN,MAAM,OACN,QAAQ,UAAA,CAAA,CACV,CAAA,CAAA,EAIDoG,EACCxG,EAAAA,IAAC8G,GAAA,CAAK,GAAI,GAAM,QAAS,KACvB,SAAAvF,EAAAA,KAACK,EAAA,CACC,UAAU,OACV,SAAUgF,EACV,GAAI,CACF,GAAI,EACJ,QAAS,OACT,eAAgB,SAChB,WAAY,SACZ,SAAU,IACV,GAAI,OACJ,IAAK,CAAA,EAGP,SAAA,CAAA5G,EAAAA,IAACiH,GAAA,CACC,UAAS,GACT,QAAQ,WACR,YAAY,mBACZ,MAAO3C,EACP,SAAWuC,GAAMX,EAAcW,EAAE,OAAO,KAAK,EAC7C,GAAI,CACF,2BAA4B,CAC1B,gBAAiB,QACjB,UAAW,+BAAA,CACb,CACF,CAAA,EAEF7G,EAAAA,IAACoC,EAAA,CACC,KAAK,SACL,QAAQ,YACR,MAAM,UACN,gBAAY8E,GAAA,EAAW,EACvB,KAAK,QACL,GAAI,CACF,GAAI,EACJ,GAAI,IACJ,SAAU,GAAA,EAEb,SAAA,IAAA,CAAA,CAED,CAAA,CAAA,CACF,CACF,EAEAlH,EAAAA,IAACoF,GAAA,CAAgB,QAAQ,MAAA,CAAO,CAAA,CAAA,CAEpC,CAAA,CAAA,CAAA,EAEJ,SAGCxD,EAAA,CAAI,GAAI,CAAE,GAAI,GACb,SAAA,CAAAL,OAACK,GAAI,GAAI,CACP,QAAS,OACT,eAAgB,gBAChB,WAAY,SACZ,GAAI,CAAA,EAEJ,SAAA,CAAAL,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,IAAK,CAAA,EACrD,SAAA,CAAA5B,EAAAA,IAACmH,GAAA,CAAe,MAAM,SAAA,CAAU,QAC/B9F,EAAA,CAAW,QAAQ,KAAK,WAAW,OAAO,SAAA,SAAA,CAE3C,CAAA,EACF,EAECmF,GACCxG,EAAAA,IAACoH,GAAA,CAAQ,MAAM,SACb,SAAApH,EAAAA,IAACyB,GAAA,CACC,QAAS,IAAM,OAAO,SAAS,OAAA,EAC/B,MAAM,UAEN,eAAC4F,GAAA,CAAA,CAAY,CAAA,CAAA,CACf,CACF,CAAA,EAEJ,EAECnE,GACClD,EAAAA,IAAC8G,GAAA,CAAK,GAAI,GACR,SAAA9G,EAAAA,IAACsH,GAAA,CACC,SAAS,QACT,GAAI,CACF,GAAI,EACJ,aAAc,EACd,sBAAuB,CACrB,QAAS,OACT,WAAY,SACZ,IAAK,CAAA,CACP,EAGF,gBAAC1F,EAAA,CACE,SAAA,CAAAsB,EACDlD,EAAAA,IAACoC,EAAA,CACC,KAAK,QACL,QAAQ,WACR,GAAI,CAAE,GAAI,CAAA,EACV,UAAWd,EACX,GAAG,eACJ,SAAA,UAAA,CAAA,CAED,CAAA,CACF,CAAA,CAAA,EAEJ,EAGD+E,QACEjB,GAAA,CAAgB,QAAQ,OAAO,MAAO,CAAA,CAAG,EACxCe,EAAY,OAAS,EACvBnG,EAAAA,IAAC8G,GAAA,CAAK,GAAI,GAAM,QAAS,IACvB,SAAA9G,MAACgG,EAAA,CAAK,UAAS,GAAC,QAAS,EACtB,SAAAG,EAAY,IAAI,CAACoB,EAAMxB,UACrBC,EAAA,CAAK,KAAI,GAAmB,GAAI,GAAI,GAAI,EAAG,GAAI,EAC9C,SAAAhG,MAAC8G,GAAA,CAAK,GAAI,GAAM,QAAS,IAAOf,EAAQ,IACtC,SAAA/F,EAAAA,IAACwF,GAAA,CACC,GAAI,CACF,OAAQ,OACR,QAAS,OACT,cAAe,SACf,WAAY,oDACZ,OAAQ,oBACR,UAAW,CACT,kBAAmB,CACjB,UAAW,kBAAA,CACb,CACF,EAGF,SAAAxF,EAAAA,IAACwH,GAAA,CACC,UAAWlG,EACX,GAAI,iBAAiBiG,EAAK,MAAM,GAChC,GAAI,CAAE,OAAQ,MAAA,EAEd,SAAAhG,EAAAA,KAACkE,GAAA,CACC,UAAU,eACV,GAAI,CACF,SAAU,EACV,WAAY,6BACZ,EAAG,CAAA,EAGL,SAAA,CAAAzF,EAAAA,IAACqB,EAAA,CACC,aAAY,GACZ,QAAQ,KACR,UAAU,KACV,GAAI,CACF,WAAY,IACZ,MAAO,eACP,GAAI,EACJ,WAAY,GAAA,EAGb,SAAAkG,EAAK,QAAA,CAAA,EAGRhG,EAAAA,KAACwF,GAAA,CAAM,QAAS,EACd,SAAA,CAAAxF,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,IAAK,CAAA,EACrD,SAAA,CAAA5B,EAAAA,IAACG,GAAA,CAAW,SAAS,QAAQ,MAAM,YAAY,EAC/CH,EAAAA,IAACqB,GAAW,QAAQ,QAAQ,MAAM,iBAC/B,SAAAkG,EAAK,eAAiB,OAAA,CACzB,CAAA,EACF,EAEAhG,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,IAAK,CAAA,EACrD,SAAA,CAAA5B,EAAAA,IAACI,GAAA,CAAQ,SAAS,QAAQ,MAAM,YAAY,EAC5CmB,EAAAA,KAACF,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAC/B,SAAA,CAAAkG,EAAK,aAAe,OAAO,MAAIA,EAAK,UAAYA,EAAK,WAAa,EAAIA,EAAK,SAAW,IAAM,MAAA,CAAA,CAC/F,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CACF,CACF,CAAA,EA7DcA,EAAK,MA8DrB,CACD,EACH,CAAA,CACF,EAEAhG,EAAAA,KAACkG,GAAA,CAAM,GAAI,CACT,EAAG,EACH,UAAW,SACX,WAAY,mDAAA,EAEZ,SAAA,CAAAzH,EAAAA,IAACqB,GAAW,QAAQ,KAAK,MAAM,iBAAiB,aAAY,GAAC,SAAA,iBAAA,CAE7D,QACCA,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAAiB,SAAA,oBAAA,CAEnD,CAAA,EACF,EAGDmF,GACCxG,EAAAA,IAAC8G,GAAA,CAAK,GAAI,GAAM,QAAS,KACvB,SAAA9G,MAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,SAAU,GAAI,GACxD,SAAA5B,EAAAA,IAACoC,EAAA,CACC,QAAQ,WACR,MAAM,UACN,UAAWd,EACX,GAAG,gBACH,KAAK,QACL,GAAI,CACF,GAAI,EACJ,GAAI,IACJ,YAAa,EACb,UAAW,CACT,YAAa,CAAA,CACf,EAEH,SAAA,WAAA,CAAA,EAGH,CAAA,CACF,CAAA,EAEJ,QAECoG,GAAA,CAAQ,GAAI,CAAE,GAAI,GAAK,EAGxB1H,EAAAA,IAAC8G,GAAA,CAAK,GAAI,GAAM,QAAS,KACvB,SAAAvF,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,GAAI,CAAA,EACb,SAAA,CAAA5B,EAAAA,IAACqB,EAAA,CACC,QAAQ,KACR,MAAM,SACN,aAAY,GACZ,GAAI,CAAE,GAAI,EAAG,WAAY,MAAA,EAC1B,SAAA,WAAA,CAAA,EAIDE,EAAAA,KAACyE,EAAA,CAAK,UAAS,GAAC,QAAS,EACvB,SAAA,CAAAhG,MAACgG,GAAK,KAAI,GAAC,GAAI,GAAI,GAAI,EACrB,SAAAzE,EAAAA,KAACiE,GAAA,CACC,GAAI,CACF,OAAQ,OACR,QAAS,OACT,cAAe,SACf,WAAY,oDACZ,MAAO,QACP,SAAU,WACV,SAAU,QAAA,EAGZ,SAAA,CAAAxF,EAAAA,IAAC4B,EAAA,CACC,GAAI,CACF,SAAU,WACV,IAAK,IACL,MAAO,IACP,QAAS,EAAA,EAGX,eAAC1B,GAAA,CAAiB,GAAI,CAAE,SAAU,IAAI,CAAG,CAAA,CAAA,EAE3CqB,EAAAA,KAACkE,GAAA,CAAY,GAAI,CAAE,SAAU,WAAY,OAAQ,EAAG,EAAG,CAAA,EACrD,SAAA,CAAAlE,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,GAAI,CAAA,EACpD,SAAA,CAAA5B,MAACE,IAAiB,GAAI,CAAE,GAAI,EAAG,SAAU,IAAM,QAC9CmB,EAAA,CAAW,QAAQ,KAAK,WAAW,OAAO,SAAA,MAAA,CAE3C,CAAA,EACF,EACArB,EAAAA,IAACqB,EAAA,CAAW,UAAS,GAAC,GAAI,CAAE,GAAI,EAAG,QAAS,EAAA,EAAO,SAAA,wDAAA,CAEnD,EACArB,EAAAA,IAACoC,EAAA,CACC,QAAQ,YACR,UAAWd,EACX,GAAG,gBACH,GAAI,CACF,GAAI,OACJ,gBAAiB,2BACjB,MAAO,QACP,UAAW,CACT,gBAAiB,0BAAA,CACnB,EAEH,SAAA,OAAA,CAAA,CAED,CAAA,CACF,CAAA,CAAA,CAAA,EAEJ,QAEC0E,EAAA,CAAK,KAAI,GAAC,GAAI,GAAI,GAAI,EACrB,SAAAzE,EAAAA,KAACiE,GAAA,CACC,GAAI,CACF,OAAQ,OACR,QAAS,OACT,cAAe,SACf,WAAY,oDACZ,MAAO,QACP,SAAU,WACV,SAAU,QAAA,EAGZ,SAAA,CAAAxF,EAAAA,IAAC4B,EAAA,CACC,GAAI,CACF,SAAU,WACV,IAAK,IACL,MAAO,IACP,QAAS,EAAA,EAGX,eAACzB,GAAA,CAAW,GAAI,CAAE,SAAU,IAAI,CAAG,CAAA,CAAA,EAErCoB,EAAAA,KAACkE,GAAA,CAAY,GAAI,CAAE,SAAU,WAAY,OAAQ,EAAG,EAAG,CAAA,EACrD,SAAA,CAAAlE,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,GAAI,CAAA,EACpD,SAAA,CAAA5B,MAACG,IAAW,GAAI,CAAE,GAAI,EAAG,SAAU,IAAM,QACxCkB,EAAA,CAAW,QAAQ,KAAK,WAAW,OAAO,SAAA,KAAA,CAE3C,CAAA,EACF,EACArB,EAAAA,IAACqB,EAAA,CAAW,UAAS,GAAC,GAAI,CAAE,GAAI,EAAG,QAAS,EAAA,EAAO,SAAA,iDAAA,CAEnD,EACArB,EAAAA,IAACoC,EAAA,CACC,QAAQ,YACR,UAAWd,EACX,GAAG,cACH,GAAI,CACF,GAAI,OACJ,gBAAiB,2BACjB,MAAO,QACP,UAAW,CACT,gBAAiB,0BAAA,CACnB,EAEH,SAAA,QAAA,CAAA,CAED,CAAA,CACF,CAAA,CAAA,CAAA,EAEJ,QAEC0E,EAAA,CAAK,KAAI,GAAC,GAAI,GAAI,GAAI,EACrB,SAAAzE,EAAAA,KAACiE,GAAA,CACC,GAAI,CACF,OAAQ,OACR,QAAS,OACT,cAAe,SACf,WAAY,oDACZ,MAAO,QACP,SAAU,WACV,SAAU,QAAA,EAGZ,SAAA,CAAAxF,EAAAA,IAAC4B,EAAA,CACC,GAAI,CACF,SAAU,WACV,IAAK,IACL,MAAO,IACP,QAAS,EAAA,EAGX,eAACxB,GAAA,CAAQ,GAAI,CAAE,SAAU,IAAI,CAAG,CAAA,CAAA,EAElCmB,EAAAA,KAACkE,GAAA,CAAY,GAAI,CAAE,SAAU,WAAY,OAAQ,EAAG,EAAG,CAAA,EACrD,SAAA,CAAAlE,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,GAAI,CAAA,EACpD,SAAA,CAAA5B,MAACI,IAAQ,GAAI,CAAE,GAAI,EAAG,SAAU,IAAM,QACrCiB,EAAA,CAAW,QAAQ,KAAK,WAAW,OAAO,SAAA,OAAA,CAE3C,CAAA,EACF,EACArB,EAAAA,IAACqB,EAAA,CAAW,UAAS,GAAC,GAAI,CAAE,GAAI,EAAG,QAAS,EAAA,EAAO,SAAA,6CAAA,CAEnD,EACArB,EAAAA,IAACoC,EAAA,CACC,QAAQ,YACR,UAAWd,EACX,GAAG,OACH,GAAI,CACF,GAAI,OACJ,gBAAiB,2BACjB,MAAO,QACP,UAAW,CACT,gBAAiB,0BAAA,CACnB,EAEH,SAAA,QAAA,CAAA,CAED,CAAA,CACF,CAAA,CAAA,CAAA,CACF,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,CAEJ,ECrgBMqG,GAAmB,IAAM,CAC7B,KAAM,CAACC,EAAeC,CAAgB,EAAI9G,EAAAA,SAAS,CAAA,CAAE,EAC/C,CAACsF,EAASC,CAAU,EAAIvF,EAAAA,SAAS,EAAI,EACrC,CAAC+G,EAAYC,CAAa,EAAIhH,EAAAA,SAAS,CAAC,EACxC,CAACiH,EAAaC,CAAc,EAAIlH,EAAAA,SAAS,CAAC,EAC1C,CAACuD,EAAY4B,CAAa,EAAInF,EAAAA,SAAS,EAAE,EACzC,CAACmH,EAAUC,CAAW,EAAIpH,EAAAA,SAAS,EAAE,EACrC,CAACqH,EAAcC,CAAe,EAAItH,EAAAA,SAAS,CAAA,CAAE,EAC7C,CAACuH,EAAuBC,CAAwB,EAAIxH,EAAAA,SAAS,CAAA,CAAE,EAC/D,CAACyH,EAAeC,EAAgB,EAAI1H,EAAAA,SAAS,CAAA,CAAE,EAC/C,CAACwD,EAAQmE,CAAS,EAAI3H,EAAAA,SAAS,WAAW,EAC1C,CAAC4H,EAAaC,CAAc,EAAI7H,EAAAA,SAAS,CAAA,CAAE,EAC3C,CAAC8H,EAAcC,EAAe,EAAI/H,EAAAA,SAAS,IAAI,EAC/C,CAACgI,EAAmBC,EAAoB,EAAIjI,EAAAA,SAAS,EAAE,EACvD,CAACkI,EAAWC,EAAY,EAAInI,EAAAA,SAAS,CAAA,CAAE,EACvCoI,GAAe,GACfC,EAAW5I,GAAA,EACX6I,EAAWC,GAAA,EAGjB5C,EAAAA,UAAU,IAAM,EACI,SAAY,CAC5B,GAAI,CAGF+B,GADgB,CAAA,CACQ,CAC1B,OAASvF,EAAO,CACd,QAAQ,MAAM,WAAYA,CAAK,CACjC,CACF,GACA,CACF,EAAG,CAAA,CAAE,EAELwD,EAAAA,UAAU,IAAM,CAEd,MAAM6C,EAAc,IAAI,gBAAgBH,EAAS,MAAM,EACjDI,EAAMD,EAAY,IAAI,KAAK,EAC3BE,EAASF,EAAY,IAAI,QAAQ,EACjCG,EAAOH,EAAY,IAAI,MAAM,EAC7BI,EAAaJ,EAAY,IAAI,YAAY,EACzCK,EAAWL,EAAY,IAAI,UAAU,EACrCM,EAAYN,EAAY,IAAI,WAAW,EACvCO,EAAOP,EAAY,IAAI,MAAM,EAQnC,GALIO,GACFpB,EAAUoB,CAAI,EAIZN,EAAK,CACP,MAAMO,EAAOP,EAAI,MAAM,GAAG,EAAE,IAAIQ,GAAKA,EAAE,KAAA,CAAM,EAAE,UAAYA,CAAC,EACtDC,MAAe,IACfC,EAAe,CAAA,EAGrBH,EAAK,QAAQC,GAAK,CAChB,MAAMG,EAAYH,EAAE,MAAM,kBAAkB,EAC5C,GAAIG,EAAW,CACb,MAAMC,EAAUJ,EAAE,QAAQG,EAAU,CAAC,EAAG,EAAE,EAAE,KAAA,EACxCC,IACFH,EAAS,IAAIG,CAAO,EACpBF,EAAa,KAAKF,CAAC,EAEvB,MACEC,EAAS,IAAID,CAAC,CAElB,CAAC,EAED3B,EAAgB,MAAM,KAAK4B,CAAQ,CAAC,EACpC1B,EAAyB2B,CAAY,EACrC/B,EAAYqB,CAAG,EACftD,EAAc,OAAOsD,CAAG,EAAE,EAC1Ba,EAAmB,EAAG,OAAOb,CAAG,GAAIM,GAAQvF,CAAM,CACpD,MAAWmF,GACTxD,EAAc,QAAQwD,CAAI,EAAE,EAC5BW,EAAmB,EAAG,QAAQX,CAAI,GAAII,GAAQvF,CAAM,GAC3CoF,GACTzD,EAAc,cAAcyD,CAAU,EAAE,EACxCU,EAAmB,EAAG,cAAcV,CAAU,GAAIG,GAAQvF,CAAM,GACvDqF,GACT1D,EAAc,YAAY0D,CAAQ,EAAE,EACpCS,EAAmB,EAAG,YAAYT,CAAQ,GAAIE,GAAQvF,CAAM,GACnDsF,GACT3D,EAAc,aAAa2D,CAAS,EAAE,EACtCQ,EAAmB,EAAG,aAAaR,CAAS,GAAIC,GAAQvF,CAAM,GACrDkF,GACTvD,EAAcuD,CAAM,EACpBY,EAAmB,EAAGZ,EAAQK,GAAQvF,CAAM,GAE5C8F,EAAmB,EAAG/F,EAAYwF,GAAQvF,CAAM,CAEpD,EAAG,CAAC6E,EAAS,MAAM,CAAC,EAEpB,MAAMiB,EAAqB,MAAOjG,EAAMqF,EAASnF,EAAYwF,EAAOvF,IAAW,CAC7E+B,EAAW,EAAI,EACf,GAAI,CACF,MAAM/C,EAAS,MAAMY,GAAoBC,EAAM+E,GAAcM,EAAQK,CAAI,EACzEjC,EAAiBtE,EAAO,KAAK,EAC7BwE,EAAcxE,EAAO,KAAK,EAC1B0E,EAAe7D,CAAI,CACrB,OAASlB,EAAO,CACd,QAAQ,MAAM,gCAAiCA,CAAK,CACtD,QAAA,CACEoD,EAAW,EAAK,CAClB,CACF,EAEMgE,GAAmB,CAACpJ,EAAOqJ,IAAU,CACzCtC,EAAesC,CAAK,EACpBF,EAAmBE,EAAOjG,EAAYC,CAAM,EAC5C,OAAO,SAAS,EAAG,CAAC,CACtB,EAEMiG,GAAsBtJ,GAAU,CACpCgF,EAAchF,EAAM,OAAO,KAAK,CAClC,EAGMuJ,GAAqB,MAAOvJ,EAAOsI,IAAQ,CAC/CV,GAAgB5H,EAAM,aAAa,EACnC8H,GAAqBQ,CAAG,EAGxB,GAAI,CAEF,MAAMkB,EAAQ,CAAA,EACdxB,GAAayB,IAAS,CACpB,GAAGA,EACH,CAACnB,CAAG,EAAGkB,CAAA,EACP,CACJ,OAASxH,EAAO,CACd,QAAQ,MAAM,+BAA+BsG,CAAG,IAAKtG,CAAK,CAC5D,CACF,EAGM0H,GAAsB,IAAM,CAChC9B,GAAgB,IAAI,EACpBE,GAAqB,EAAE,CACzB,EAGM6B,GAAoBnB,GAAS,CACjC,MAAMoB,EAAcpB,EAAO,GAAGX,CAAiB,GAAGW,CAAI,GAAKX,EAE3D,IAAIgC,EAAmB,CAAC,GAAGzC,CAAqB,EAChD,MAAM0C,EAAgBD,EAAiB,aACrCf,EAAE,WAAWjB,CAAiB,IAAMiB,IAAMjB,GACxCiB,EAAE,MAAM,IAAI,OAAO,IAAIjB,CAAiB,oBAAoB,CAAC,GAC7DiB,EAAE,MAAM,IAAI,OAAO,IAAIjB,CAAiB,WAAW,CAAC,GACpDiB,EAAE,MAAM,IAAI,OAAO,IAAIjB,CAAiB,QAAQ,CAAC,GACjDiB,EAAE,MAAM,IAAI,OAAO,IAAIjB,CAAiB,cAAc,CAAC,EAAA,EAIvDiC,GAAiB,EACftB,EAEFqB,EAAiBC,CAAa,EAAIF,EAGlCC,EAAiB,OAAOC,EAAe,CAAC,EAEjCtB,GAETqB,EAAiB,KAAKD,CAAW,EAGnCvC,EAAyBwC,CAAgB,EACzCH,GAAA,EAGA,MAAMK,EAAU,CAAC,GAAG7C,CAAY,EAC3B6C,EAAQ,SAASlC,CAAiB,GACrCkC,EAAQ,KAAKlC,CAAiB,EAGhC,MAAMmC,EAAiB,CAAC,GAAGD,EAAS,GAAGF,CAAgB,EACpD,OAAO,CAACvB,EAAKzD,EAAOoF,IAEnBA,EAAK,QAAQ3B,CAAG,IAAMzD,GACtB,CAACgF,EAAiB,KAAKf,GAAKA,IAAMR,GAAOQ,EAAE,WAAWR,CAAG,CAAC,CAAA,EAE3D,KAAK,GAAG,EAEXrB,EAAY+C,CAAc,EAC1B,MAAME,EAAkB,OAAOF,CAAc,GAC7ChF,EAAckF,CAAe,EAG7Bf,EAAmB,EAAGe,EAAiB7G,CAAM,EAC7C,MAAMgF,EAAc,IAAI,gBACxBA,EAAY,IAAI,MAAO2B,CAAc,EACjC3G,IAAW,aACbgF,EAAY,IAAI,OAAQhF,CAAM,EAEhC8E,EAAS,CAAE,OAAQE,EAAY,SAAA,EAAY,CAC7C,EAGM8B,GAAkB,CAACnK,EAAOoK,IAAY,CAE1C,MAAMC,EAAcnD,EAAa,OAAOoB,GAAO,CAAC8B,EAAQ,SAAS9B,CAAG,CAAC,EAGrE,IAAIuB,EAAmB,CAAC,GAAGzC,CAAqB,EAAE,OAAOkB,GACvD,CAAC+B,EAAY,QAAmB/B,EAAI,WAAWgC,CAAU,CAAC,CAAA,EAI5D,MAAMC,EAAYH,EAAQ,OAAO9B,GAAO,CAACpB,EAAa,SAASoB,CAAG,CAAC,EA8BnE,GA3BIiC,EAAU,OAAS,GACrBA,EAAU,QAAQ,MAAOjC,GAAQ,CAC/B,GAAI,CAACP,EAAUO,CAAG,EAChB,GAAI,CAER,MAAMkB,EAAQ,CAAA,EAOR,GANAxB,GAAayB,IAAS,CACpB,GAAGA,EACH,CAACnB,CAAG,EAAGkB,CAAA,EACP,EAGEA,GAASA,EAAM,SAAW,EAAG,CAC/B,MAAMI,EAAc,GAAGtB,CAAG,GAAGkB,EAAM,CAAC,CAAC,GACrCK,EAAiB,KAAKD,CAAW,CACnC,CACF,OAAS5H,EAAO,CACd,QAAQ,MAAM,+BAA+BsG,CAAG,IAAKtG,CAAK,CAC5D,CAEJ,CAAC,EAGHmF,EAAgBiD,CAAO,EACvB/C,EAAyBwC,CAAgB,EAGrCO,EAAQ,OAAS,GAAKP,EAAiB,OAAS,EAAG,CACrD,MAAMG,EAAiB,CAAC,GAAGI,EAAS,GAAGP,CAAgB,EACpD,OAAO,CAACvB,EAAKzD,EAAOoF,IAEnBA,EAAK,QAAQ3B,CAAG,IAAMzD,GACtB,CAACgF,EAAiB,KAAKf,GAAKA,IAAMR,GAAOQ,EAAE,WAAWR,CAAG,CAAC,CAAA,EAE3D,KAAK,GAAG,EAEXrB,EAAY+C,CAAc,EAC1B,MAAME,EAAkB,OAAOF,CAAc,GAC7ChF,EAAckF,CAAe,EAG7Bf,EAAmB,EAAGe,EAAiB7G,CAAM,EAC7C,MAAMgF,EAAc,IAAI,gBACxBA,EAAY,IAAI,MAAO2B,CAAc,EACjC3G,IAAW,aACbgF,EAAY,IAAI,OAAQhF,CAAM,EAEhC8E,EAAS,CAAE,OAAQE,EAAY,SAAA,EAAY,CAC7C,MACEmC,GAAA,CAEJ,EAGMC,GAAoBzK,GAAU,CAClC,MAAM0K,EAAY1K,EAAM,OAAO,MAC/BwH,EAAUkD,CAAS,EAGnBvB,EAAmBrC,EAAa1D,EAAYsH,CAAS,EAGrD,MAAMrC,EAAc,IAAI,gBAAgBH,EAAS,MAAM,EACvDG,EAAY,IAAI,OAAQqC,CAAS,EACjCvC,EAAS,CAAE,OAAQE,EAAY,SAAA,EAAY,CAC7C,EAEM3C,GAAe,IAAM,CACzBqB,EAAe,CAAC,EAChBoC,EAAmB,EAAG/F,EAAYC,CAAM,EAGxC,MAAMgF,EAAc,IAAI,gBAQxB,GALIhF,IAAW,aACbgF,EAAY,IAAI,OAAQhF,CAAM,EAI5BD,EAAW,WAAW,MAAM,EAAG,CAEjC,MAAMuH,EAAWvH,EAAW,UAAU,CAAC,EAAE,KAAA,EACzCiF,EAAY,IAAI,MAAOsC,CAAQ,CACjC,SAAWvH,EAAW,WAAW,OAAO,EAAG,CACzC,MAAMwH,EAAYxH,EAAW,UAAU,CAAC,EAAE,KAAA,EAC1CiF,EAAY,IAAI,OAAQuC,CAAS,CACnC,SAAWxH,EAAW,WAAW,aAAa,EAAG,CAC/C,MAAMyH,EAAkBzH,EAAW,UAAU,EAAE,EAAE,KAAA,EACjDiF,EAAY,IAAI,aAAcwC,CAAe,CAC/C,SAAWzH,EAAW,WAAW,WAAW,EAAG,CAC7C,MAAM0H,EAAgB1H,EAAW,UAAU,CAAC,EAAE,KAAA,EAC9CiF,EAAY,IAAI,WAAYyC,CAAa,CAC3C,SAAW1H,EAAW,WAAW,YAAY,EAAG,CAC9C,MAAM2H,EAAiB3H,EAAW,UAAU,EAAE,EAAE,KAAA,EAChDiF,EAAY,IAAI,YAAa0C,CAAc,CAC7C,MAAW3H,GAETiF,EAAY,IAAI,SAAUjF,CAAU,EAGtC+E,EAAS,CAAE,OAAQE,EAAY,SAAA,EAAY,CAC7C,EAEMmC,GAAoB,IAAM,CAC9BvD,EAAY,EAAE,EACdjC,EAAc,EAAE,EAChBmC,EAAgB,CAAA,CAAE,EAClBE,EAAyB,CAAA,CAAE,EAC3BN,EAAe,CAAC,EAChBoC,EAAmB,EAAG,GAAI9F,CAAM,EAGhC,MAAMgF,EAAc,IAAI,gBACpBhF,IAAW,aACbgF,EAAY,IAAI,OAAQhF,CAAM,EAEhC8E,EAAS,CAAE,OAAQE,EAAY,SAAA,EAAY,CAC7C,EAEM2C,GAAa,KAAK,KAAKpE,EAAaqB,EAAY,EAEtD,OACE5H,EAAAA,KAACe,IAAU,SAAS,KAAK,GAAI,CAAE,GAAI,GACjC,SAAA,CAAAtC,EAAAA,IAACqB,GAAW,QAAQ,KAAK,UAAU,KAAK,aAAY,GAAC,SAAA,QAAA,CAErD,EAEAE,OAACkG,IAAM,GAAI,CAAE,EAAG,EAAG,GAAI,GAErB,SAAA,CAAAlG,EAAAA,KAACK,GAAI,GAAI,CAAE,QAAS,OAAQ,cAAe,CAAE,GAAI,SAAU,GAAI,OAAS,IAAK,EAAG,GAAI,GAClF,SAAA,CAAA5B,EAAAA,IAACiH,GAAA,CACC,UAAS,GACT,MAAM,kBACN,MAAO3C,EACP,SAAUkG,GACV,WAAa3D,GAAMA,EAAE,MAAQ,SAAWD,GAAA,EACxC,WAAY,CACV,eACE5G,EAAAA,IAACmM,GAAA,CAAe,SAAS,QACvB,SAAAnM,EAAAA,IAACkH,KAAW,CAAA,CACd,CAAA,CAEJ,CAAA,EAEFlH,EAAAA,IAACoC,EAAA,CACC,QAAQ,YACR,QAASwE,GACT,GAAI,CAAE,SAAU,OAAA,EACjB,SAAA,IAAA,CAAA,CAED,EACF,SAGChF,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,cAAe,CAAE,GAAI,SAAU,GAAI,KAAA,EAAS,IAAK,EAAG,GAAI,EAAG,WAAY,cAEjG,SAAA,CAAA5B,EAAAA,IAACoM,GAAA,CACC,SAAQ,GACR,GAAG,gBACH,QAAS5D,EACT,MAAOJ,EACP,SAAUiD,GACV,YAAchI,GACZrD,EAAAA,IAACiH,GAAA,CACE,GAAG5D,EACJ,QAAQ,WACR,MAAM,UACN,YAAY,OAAA,CAAA,EAGhB,WAAY,CAACkH,EAAO8B,IAClB9B,EAAM,IAAI,CAAC+B,EAAQvG,IAAU,CAE3B,MAAMwG,EAAUjE,EAAsB,KAAKkB,GAAOA,EAAI,WAAW8C,CAAM,GAAK9C,IAAQ8C,CAAM,EAEpFE,EAAe,GAAQvD,EAAUqD,CAAM,GAAKrD,EAAUqD,CAAM,EAAE,OAAS,GAEvEG,EAAenE,EAAsB,KAAKkB,GAAOA,EAAI,WAAW8C,CAAM,GAAK9C,IAAQ8C,CAAM,EAE/F,IAAII,EAAc,GAClB,GAAID,EAAc,CAChB,MAAME,EAAWF,EAAa,UAAUH,EAAO,MAAM,EAGjDK,EAAS,MAAM,kBAAkB,EAEnCD,EAAcC,EAAS,QAAQ,WAAY,CAAC7G,EAAG4D,IAAS,IAAIA,EAAK,UAAU,CAAC,CAAC,EAAE,EACtEiD,EAAS,MAAM,UAAU,EAElCD,EAAcC,EAAS,QAAQ,WAAY,CAAC7G,EAAG4D,IAAS,IAAIA,EAAK,UAAU,CAAC,CAAC,EAAE,EACtEiD,EAAS,MAAM,OAAO,EAE/BD,EAAcC,EACLA,EAAS,MAAM,WAAW,EAEnCD,EAAcC,EAAS,QAAQ,cAAe,CAAC7G,EAAG4D,IAAS,IAAIA,EAAK,UAAU,CAAC,CAAC,EAAE,EAGlFgD,EAAcC,CAElB,CAEA,OACE3M,EAAAA,IAACgH,EAAA,CAEC,aACGpF,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,QAAA,EACrC,SAAA,CAAA0K,EACAG,GACCzM,EAAAA,IAACqB,EAAA,CACC,QAAQ,UACR,GAAI,CACF,GAAI,GACJ,WAAY,OACZ,gBAAiB,sBACjB,aAAc,MACd,GAAI,GACJ,GAAI,EAAA,EAGL,SAAAqL,CAAA,CAAA,EAGJF,GACCxM,EAAAA,IAAC4M,GAAA,CAAkB,SAAS,OAAA,CAAQ,CAAA,EAExC,EAED,GAAGP,EAAY,CAAE,MAAAtG,EAAO,EACzB,MAAOwG,EAAU,UAAY,UAC7B,QAAQ,WACR,QAAUrL,GAAU,CAElBA,EAAM,gBAAA,EACNuJ,GAAmBvJ,EAAOoL,CAAM,CAClC,EACA,SAAWpL,GAAU,CAEnBmL,EAAY,CAAE,MAAAtG,CAAA,CAAO,EAAE,SAAS7E,CAAK,CACvC,EACA,GAAI,CACF,SAAU,OACV,mBAAoB,CAClB,SAAU,SACV,WAAY,SACZ,aAAc,UAAA,CAChB,CACF,EA3CKoL,CAAA,CA8CX,CAAC,EAEH,GAAI,CAAE,KAAM,CAAA,CAAE,CAAA,EAIhB/K,OAACsL,IAAY,GAAI,CAAE,SAAU,IAAK,KAAM,GACtC,SAAA,CAAA7M,EAAAA,IAAC8M,GAAA,CAAW,GAAG,oBAAoB,SAAA,OAAI,EACvCvL,EAAAA,KAACwL,GAAA,CACC,QAAQ,oBACR,GAAG,cACH,MAAOxI,EACP,MAAM,OACN,SAAUoH,GACV,eACE3L,EAAAA,IAACmM,GAAA,CAAe,SAAS,QACvB,SAAAnM,MAACgN,KAAS,EACZ,EAGF,SAAA,CAAAhN,EAAAA,IAACiN,EAAA,CAAS,MAAM,YAAY,SAAA,WAAQ,EACpCjN,EAAAA,IAACiN,EAAA,CAAS,MAAM,WAAW,SAAA,UAAO,EAClCjN,EAAAA,IAACiN,EAAA,CAAS,MAAM,WAAW,SAAA,SAAM,EACjCjN,EAAAA,IAACiN,EAAA,CAAS,MAAM,YAAY,SAAA,SAAM,EAClCjN,EAAAA,IAACiN,EAAA,CAAS,MAAM,gBAAgB,SAAA,UAAO,EACvCjN,EAAAA,IAACiN,EAAA,CAAS,MAAM,iBAAiB,SAAA,SAAA,CAAO,CAAA,CAAA,CAAA,CAC1C,CAAA,CACF,CAAA,EACF,EAGAjN,EAAAA,IAACkN,GAAA,CACC,KAAM,EAAQrE,EACd,SAAUA,EACV,QAAS+B,GACT,aAAc,CACZ,SAAU,SACV,WAAY,MAAA,EAGd,SAAArJ,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,EAAG,EAAG,UAAW,IAAK,MAAO,QAAS,UAAW,MAAA,EAC1D,SAAA,CAAAL,OAACF,GAAW,QAAQ,YAAY,GAAI,CAAE,GAAI,GACvC,SAAA,CAAA0H,EAAkB,OAAA,EACrB,EACAxH,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,cAAe,SAAU,IAAK,CAAA,EACxD,SAAA,CAAA5B,EAAAA,IAACgH,EAAA,CACC,MAAM,OACN,QAAS,IAAM6D,GAAiB,EAAE,EAClC,QAAQ,WACR,KAAK,QACL,MACEzC,EAAa,SAASW,CAAiB,GACvC,CAACT,EAAsB,KAAK0B,GAAKA,EAAE,WAAWjB,CAAiB,GAAKiB,IAAMjB,CAAiB,EACvF,UAAY,SAAA,CAAA,EAGnBE,EAAUF,CAAiB,GAAG,IAAIW,GAAQ,CAEzC,IAAIyD,EAAQzD,EACR0D,EAAwF,UAE5F,OAAI9E,EAAsB,KAAK0B,GAAKA,IAAM,GAAGjB,CAAiB,GAAGW,CAAI,EAAE,IACrE0D,EAAQ,WAIRpN,EAAAA,IAACgH,EAAA,CAEC,MAAAmG,EACA,QAAS,IAAMtC,GAAiBnB,CAAI,EACpC,QAAQ,WACR,KAAK,QACL,MAAA0D,EACA,GAAI,CACF,SAAU,SACV,aAAc,WACd,SAAU,MAAA,CACZ,EAVK1D,CAAA,CAaX,CAAC,CAAA,CAAA,CACH,CAAA,CAAA,CACF,CAAA,CAAA,GAIAxB,GAAY5D,IACZtE,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,GAAI,GACb,SAAA5B,EAAAA,IAACsH,GAAA,CACC,SAAS,OACT,aACGlF,EAAA,CAAO,MAAM,UAAU,KAAK,QAAQ,QAASsJ,GAAmB,SAAA,KAAA,CAEjE,EAGD,SAAAxD,EAAW,MAAMA,CAAQ,UAAY,IAAI5D,CAAU,OAAA,CAAA,EAExD,EAGF/C,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,gBAAiB,WAAY,SAAU,GAAI,CAAA,EACrF,SAAA,CAAAL,EAAAA,KAACF,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAC/B,SAAA,CAAAyG,EAAW,SAAA,EACd,EACCoE,GAAa,GACZlM,EAAAA,IAACqN,GAAA,CACC,MAAOnB,GACP,KAAMlE,EACN,SAAUsC,GACV,MAAM,UACN,KAAK,OAAA,CAAA,CACP,CAAA,CAEJ,CAAA,EACF,EAECjE,EACCrG,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,SAAU,GAAI,GACxD,SAAA5B,MAACsN,GAAA,CAAA,CAAiB,CAAA,CACpB,EAEA/L,EAAAA,KAAAC,WAAA,CACG,SAAA,CAAAoG,EAAc,SAAW,EACxBrG,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,UAAW,SAAU,GAAI,CAAA,EAClC,SAAA,CAAA5B,EAAAA,IAACqB,EAAA,CAAW,QAAQ,KAAK,SAAA,kBAEzB,EACArB,EAAAA,IAACqB,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAAiB,GAAI,CAAE,GAAI,GAAK,SAAA,kBAAA,CAElE,CAAA,CAAA,CACF,QAEC2E,EAAA,CAAK,UAAS,GAAC,QAAS,EACtB,SAAA4B,EAAc,IAAK2F,SACjBvH,EAAA,CAAK,KAAI,GAAuB,GAAI,GAAI,GAAI,EAAG,GAAI,EAAG,GAAI,EACzD,SAAAhG,EAAAA,IAACwF,GAAA,CACC,GAAI,CACF,OAAQ,OACR,QAAS,OACT,cAAe,SACf,WAAY,iBACZ,UAAW,CACT,UAAW,aAAA,CACb,EAGF,SAAAxF,EAAAA,IAACwH,GAAA,CACC,UAAWlG,EACX,GAAI,iBAAiBiM,EAAa,EAAE,GACpC,GAAI,CACF,QAAS,OACT,cAAe,SACf,WAAY,aACZ,OAAQ,MAAA,EAGV,SAAAhM,EAAAA,KAACkE,IAAY,GAAI,CAAE,MAAO,OAAQ,SAAU,GAC1C,SAAA,CAAAzF,EAAAA,IAACqB,EAAA,CAAW,aAAY,GAAC,QAAQ,KAAK,UAAU,KAC7C,WAAa,IAAA,CAChB,EAEAE,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,cAAe,SAAU,IAAK,EAAG,GAAI,CAAA,EAC9D,SAAA,CAAA2L,EAAa,eACZhM,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,IAAK,CAAA,EACrD,SAAA,CAAA5B,EAAAA,IAACwN,GAAA,CAAW,SAAS,QAAQ,MAAM,SAAS,QAC3CnM,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAC/B,WAAa,aAAA,CAChB,CAAA,EACF,EAGDkM,EAAa,MACZhM,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,IAAK,CAAA,EACrD,SAAA,CAAA5B,EAAAA,IAACyN,GAAA,CAAe,SAAS,QAAQ,MAAM,SAAS,QAC/CpM,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAC/B,WAAa,IAAA,CAChB,CAAA,EACF,EAGDkM,EAAa,cAAgB,GAC5BhM,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,IAAK,GACrD,SAAA,CAAA5B,EAAAA,IAAC0N,GAAA,CAAkB,SAAS,QAAQ,MAAM,SAAS,EACnDnM,EAAAA,KAACF,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAC/B,SAAA,CAAAkM,EAAa,cAAc,GAAA,CAAA,CAC9B,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,EAzDcA,EAAa,EA0D7B,CACD,EACH,EAGDrB,GAAa,GACZlM,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,SAAU,GAAI,CAAA,EACxD,SAAA5B,EAAAA,IAACqN,GAAA,CACC,MAAOnB,GACP,KAAMlE,EACN,SAAUsC,GACV,MAAM,SAAA,CAAA,CACR,CACF,CAAA,CAAA,CAEJ,CAAA,EAEJ,CAEJ,EC7rBA,OAAOqD,GAAE,KAAK,QAAQ,UAAU,YAChCA,GAAE,KAAK,QAAQ,aAAa,CAC1B,cAAe,iEACf,QAAS,8DACT,UAAW,+DACb,CAAC,EAwBD,MAAMC,GAA0B,CAAC,CAC/B,QAAAC,EAAU,CAAA,EACV,OAAAC,EACA,KAAAC,EAAO,GACP,OAAAC,EAAS,QACT,aAAAC,CACF,IAAM,CACJ,KAAM,CAACC,EAAWC,CAAY,EAAIpN,EAAAA,SAA6B+M,CAAM,EAGrEpH,OAAAA,EAAAA,UAAU,IAAM,CACVuH,GAAgBA,EAAa,UAAYA,EAAa,UACxDE,EAAa,CAACF,EAAa,SAAUA,EAAa,SAAS,CAAC,EACnDH,GACTK,EAAaL,CAAM,CAEvB,EAAG,CAACG,EAAcH,CAAM,CAAC,EAGvB9N,MAAC,OAAI,MAAO,CAAE,OAAAgO,EAAQ,MAAO,OAAQ,aAAc,MAAA,EACjD,SAAAzM,EAAAA,KAAC6M,GAAA,CACC,OAAQF,EACR,KAAAH,EACA,MAAO,CAAE,OAAQ,OAAQ,MAAO,MAAA,EAEhC,SAAA,CAAA/N,EAAAA,IAACqO,GAAA,CACC,YAAY,qFACZ,IAAI,oDAAA,CAAA,EAILR,EAAQ,IAAI,CAACS,EAAQvI,IACpBuI,EAAO,UAAYA,EAAO,UACxBtO,EAAAA,IAACuO,GAAA,CAEC,SAAU,CAACD,EAAO,SAAUA,EAAO,SAAS,EAE5C,gBAACE,GAAA,CACC,SAAA,CAAAxO,EAAAA,IAACqB,EAAA,CAAW,QAAQ,KAAM,SAAAiN,EAAO,KAAK,EACtCtO,EAAAA,IAACqB,EAAA,CAAW,QAAQ,QAAS,WAAO,SAAS,EAC7CrB,EAAAA,IAACoC,EAAA,CACC,UAAWqM,EACX,GAAI,iBAAiBH,EAAO,EAAE,GAC9B,KAAK,QACL,QAAQ,WACR,GAAI,CAAE,GAAI,CAAA,EACX,SAAA,OAAA,CAAA,CAED,CAAA,CACF,CAAA,EAfK,UAAUA,EAAO,IAAMvI,CAAK,EAAA,EAiBjC,IACL,EAGAkI,GAAgBA,EAAa,UAAYA,EAAa,WACrDjO,EAAAA,IAACuO,GAAA,CACC,SAAU,CAACN,EAAa,SAAUA,EAAa,SAAS,EAExD,gBAACO,GAAA,CACC,SAAA,CAAAxO,EAAAA,IAACqB,EAAA,CAAW,QAAQ,KAAM,SAAA4M,EAAa,KAAK,EAC5CjO,EAAAA,IAACqB,EAAA,CAAW,QAAQ,QAAS,WAAa,QAAA,CAAS,CAAA,CAAA,CACrD,CAAA,CAAA,CACF,CAAA,CAAA,EAGN,CAEJ,EC/EMqN,GAAyB,IAAM,CACnC,KAAM,CAAE,GAAAxK,CAAA,EAAOyK,GAAA,EACT,CAACpH,EAAMqH,CAAO,EAAI7N,EAAAA,SAAS,IAAI,EAC/B,CAACsF,EAASC,CAAU,EAAIvF,EAAAA,SAAS,EAAI,EACrC,CAACmC,EAAOqD,CAAQ,EAAIxF,EAAAA,SAAS,IAAI,EACjCsI,EAAWC,GAAA,EAsBjB,GApBA5C,EAAAA,UAAU,IAAM,EACI,SAAY,CAC5BJ,EAAW,EAAI,EACf,GAAI,CACF,MAAMK,EAAO,MAAM1C,GAAoBC,CAAE,EACzC,GAAI,CAACyC,EACH,MAAM,IAAI,MAAM,gBAAgB,EAElCiI,EAAQjI,CAAI,CACd,OAASzD,EAAO,CACd,QAAQ,MAAM,uBAAwBA,CAAK,EAC3CqD,EAASrD,EAAM,OAAO,CACxB,QAAA,CACEoD,EAAW,EAAK,CAClB,CACF,GAEA,CACF,EAAG,CAACpC,CAAE,CAAC,EAEHmC,EACF,OACErG,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,SAAU,WAAY,SAAU,UAAW,QACrF,SAAA5B,EAAAA,IAACsN,KAAiB,EACpB,EAIJ,GAAIpK,EACF,cACGZ,GAAA,CACC,SAAA,CAAAf,EAAAA,KAACF,EAAA,CAAW,QAAQ,KAAK,MAAM,QAAQ,GAAI,CAAE,UAAW,SAAU,GAAI,CAAA,EAAK,SAAA,CAAA,eAC5D6B,CAAA,EACf,EACAlD,EAAAA,IAACoC,EAAA,CACC,QAAQ,YACR,UAAWd,EACX,GAAG,gBACH,gBAAYuN,GAAA,EAAc,EAC3B,SAAA,WAAA,CAAA,CAED,EACF,EAIJ,GAAI,CAACtH,EACH,cACGjF,GAAA,CACC,SAAA,CAAAtC,EAAAA,IAACqB,EAAA,CAAW,QAAQ,KAAK,GAAI,CAAE,UAAW,SAAU,GAAI,CAAA,EAAK,SAAA,iBAAA,CAE7D,EACArB,EAAAA,IAACoC,EAAA,CACC,QAAQ,YACR,UAAWd,EACX,GAAG,gBACH,gBAAYuN,GAAA,EAAc,EAC3B,SAAA,WAAA,CAAA,CAED,EACF,EAKJ,MAAM9E,EAAOxC,EAAK,IACdA,EAAK,IAAI,MAAM,GAAG,EACf,OAAOiC,GAAOA,EAAI,KAAA,IAAW,IAAM,CAACA,EAAI,SAAS,OAAO,CAAC,EAC5D,CAAA,EAGEsF,EAAmB/E,EAAK,QAAYP,EAAI,SAAS,KAAK,CAAC,EACvDuF,EAAoBD,EAAmBA,EAAiB,QAAQ,MAAO,EAAE,EAAI,GAG7EE,EAAkBxF,GAAQ,CAC9B,QAAQ,IAAI,iBAAiBA,CAAG,EAAE,EAElCH,EAAS,qBAAqB,mBAAmBG,CAAG,CAAC,EAAE,CACzD,EAGMyF,EAA0B,CAACC,EAAUrF,IAAc,CACvD,MAAMsF,EAAc,GAAGD,CAAQ,IAAIrF,GAAW,MAAQ,EAAE,MACxD,MAAO,mCAAmC,mBAAmBsF,CAAW,CAAC,WAC3E,EAEMC,EAAyBF,GACtB,uDAAuD,mBAAmBA,CAAQ,CAAC,GAG5F,OACE3N,EAAAA,KAACe,IAAU,SAAS,KAAK,GAAI,CAAE,GAAI,GACjC,SAAA,CAAAtC,EAAAA,IAACoC,EAAA,CACC,QAAQ,WACR,UAAWd,EACX,GAAG,gBACH,gBAAYuN,GAAA,EAAc,EAC1B,GAAI,CAAE,GAAI,CAAA,EACX,SAAA,WAAA,CAAA,EAIDtN,OAACkG,IAAM,GAAI,CAAE,EAAG,EAAG,GAAI,GACrB,SAAA,CAAAlG,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,GAAI,GACb,SAAA,CAAA5B,EAAAA,IAACqB,EAAA,CAAW,QAAQ,KAAK,UAAU,KAAK,aAAY,GACjD,SAAAkG,EAAK,MAAQ,IAAA,CAChB,EAECA,EAAK,UACJhG,OAACF,EAAA,CAAW,QAAQ,YAAY,MAAM,iBAAiB,aAAY,GACjE,SAAA,CAAArB,EAAAA,IAACyN,GAAA,CAAe,SAAS,QAAQ,GAAI,CAAE,cAAe,SAAU,GAAI,EAAA,CAAI,CAAG,EAC1ElG,EAAK,QAAA,EACR,EAIFhG,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,SAAU,OAAQ,IAAK,EAAG,GAAI,CAAA,EACvD,SAAA,CAAA2F,EAAK,gBAAkB,GACtBvH,EAAAA,IAACgH,EAAA,CACC,WAAO0G,GAAA,EAAkB,EACzB,MAAO,GAAGnG,EAAK,aAAa,IAC5B,QAAQ,WACR,KAAK,QACL,QAAS,IAAM8B,EAAS,sBAAsB9B,EAAK,aAAa,EAAE,EAClE,UAAS,EAAA,CAAA,EAGZA,EAAK,MACJvH,EAAAA,IAACgH,EAAA,CACC,WAAOyG,GAAA,EAAe,EACtB,MAAOlG,EAAK,KACZ,QAAQ,WACR,KAAK,QACL,QAAS,IAAM8B,EAAS,4BAA4B,mBAAmB9B,EAAK,IAAI,CAAC,EAAE,EACnF,UAAS,EAAA,CAAA,EAGZA,EAAK,WAAaA,EAAK,UAAU,MAChCvH,EAAAA,IAACgH,EAAA,CACC,WAAOwG,GAAA,EAAW,EAClB,MAAOjG,EAAK,UAAU,KACtB,UAAWjG,EACX,GAAI,eAAeiG,EAAK,UAAU,EAAE,GACpC,UAAS,GACT,MAAM,UACN,KAAK,OAAA,CAAA,EAGRA,EAAK,aACJvH,EAAAA,IAACgH,EAAA,CACC,WAAOqI,GAAA,EAAa,EACpB,MAAO9H,EAAK,YACZ,QAAQ,WACR,KAAK,QACL,QAAS,IAAM8B,EAAS,0BAA0B,mBAAmB9B,EAAK,WAAW,CAAC,EAAE,EACxF,UAAS,EAAA,CAAA,EAGZA,EAAK,UAAYA,EAAK,WAAaA,EAAK,aACvCvH,EAAAA,IAACgH,EAAA,CACC,WAAOqI,GAAA,EAAa,EACpB,MAAO9H,EAAK,SACZ,QAAQ,WACR,KAAK,QACL,QAAS,IAAM8B,EAAS,0BAA0B,mBAAmB9B,EAAK,QAAQ,CAAC,EAAE,EACrF,UAAS,EAAA,CAAA,CACX,EAEJ,EAGCwC,EAAK,OAAS,GACb/J,MAAC4B,GAAI,GAAI,CAAE,QAAS,OAAQ,SAAU,OAAQ,IAAK,EAAG,GAAI,GACvD,WAAK,IAAI,CAAC4H,EAAKzD,IACd/F,EAAAA,IAACgH,EAAA,CAEC,WAAOsI,GAAA,EAAgB,EACvB,MAAO9F,EACP,QAAS,IAAMwF,EAAexF,CAAG,EACjC,UAAS,GACT,MAAM,YACN,QAAQ,WACR,KAAK,OAAA,EAPAzD,CAAA,CASR,CAAA,CACH,CAAA,EAEJ,QAEC2B,GAAA,CAAQ,GAAI,CAAE,GAAI,GAAK,EAGxBnG,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,GAAI,EAAG,QAAS,OAAQ,cAAe,MAAO,IAAK,CAAA,EAE3D,SAAA,CAAA2F,EAAK,iBACJvH,MAACoH,GAAA,CAAQ,MAAM,YACb,SAAA7F,EAAAA,KAACa,EAAA,CACC,QAAQ,YACR,KAAMmF,EAAK,gBACX,OAAO,SACP,IAAI,sBACJ,KAAK,QACL,GAAI,CACF,gBAAiB,UACjB,MAAO,UACP,UAAW,CACT,gBAAiB,SAAA,CACnB,EAGF,SAAA,CAAAvH,MAAC4B,GAAI,GAAI,CACP,QAAS,OACT,WAAY,SACZ,eAAgB,SAChB,GAAI,EAAA,EAEJ,SAAA5B,EAAAA,IAAC,MAAA,CACC,IAAI,+CACJ,IAAI,SACJ,MAAO,CACL,OAAQ,OACR,MAAO,OACP,YAAa,KAAA,CACf,CAAA,EAEJ,EACC+O,GACC/O,EAAAA,IAACqB,EAAA,CAAW,QAAQ,UACjB,SAAA0N,CAAA,CACH,CAAA,CAAA,CAAA,EAGN,EAGF/O,EAAAA,IAACoH,GAAA,CAAQ,MAAM,aACb,SAAApH,EAAAA,IAACoC,EAAA,CACC,KAAM6M,EAAwB1H,EAAK,KAAMA,EAAK,SAAS,EACvD,OAAO,SACP,IAAI,sBACJ,gBAAYgI,GAAA,EAAgB,EAC5B,QAAQ,YACR,KAAK,QACL,GAAI,CACF,gBAAiB,UACjB,MAAO,UACP,UAAW,CACT,gBAAiB,SAAA,CACnB,EAEH,SAAA,IAAA,CAAA,EAGH,EAEAvP,EAAAA,IAACoH,GAAA,CAAQ,MAAM,eACb,SAAApH,EAAAA,IAACoC,EAAA,CACC,KAAMgN,EAAsB7H,EAAK,IAAI,EACrC,OAAO,SACP,IAAI,sBACJ,gBAAYiI,GAAA,EAAc,EAC1B,QAAQ,YACR,KAAK,QACL,GAAI,CACF,gBAAiB,UACjB,MAAO,UACP,UAAW,CACT,gBAAiB,SAAA,CACnB,EAEH,SAAA,WAAA,CAAA,CAED,CACF,CAAA,EACF,EAECjI,EAAK,aACJhG,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,GAAI,GACb,SAAA,CAAA5B,MAACqB,EAAA,CAAW,QAAQ,KAAK,aAAY,GAAC,SAAA,KAEtC,EACArB,EAAAA,IAACqB,EAAA,CAAW,QAAQ,QAAQ,UAAS,GAAC,GAAI,CAAE,WAAY,UAAA,EACrD,SAAAkG,EAAK,WAAA,CACR,CAAA,EACF,EAGDA,EAAK,UAAYA,EAAK,WACrBhG,EAAAA,KAACK,GAAI,GAAI,CAAE,GAAI,CAAA,EACb,SAAA,CAAA5B,MAACqB,EAAA,CAAW,QAAQ,KAAK,aAAY,GAAC,SAAA,OAEtC,QACCO,EAAA,CAAI,GAAI,CAAE,OAAQ,QAAS,MAAO,OAAQ,GAAI,EAAG,OAAQ,iBAAkB,aAAc,MAAO,SAAU,UACzG,SAAA5B,EAAAA,IAACyP,GAAA,CACC,aAAc,CACZ,GAAIlI,EAAK,IAAM,EACf,SAAUA,EAAK,SACf,UAAWA,EAAK,UAChB,KAAMA,EAAK,KACX,SAAUA,EAAK,QAAA,EAEjB,OAAQ,CAACA,EAAK,SAAUA,EAAK,SAAS,EACtC,KAAM,EAAA,CAAA,CACR,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,EACF,CAEJ,EC7UamI,GAAmB,MAAOxL,GAC9BJ,GACL,8CACA,CAACI,CAAE,CAAA,EAeMyL,GAAmB,MAC9BvL,EAAe,EACfC,EAAgB,GAChBC,EAAqB,GACrByF,EAAiB,CAAA,EACjBxF,EAAiB,WACjBC,EAAoB,MACpBC,EAOI,KAC4B,CAChC,MAAMC,GAAUN,EAAO,GAAKC,EAG5B,IAAIM,EAAc,MAClB,MAAMtB,EAAgB,CAAA,EAGlBiB,IACFK,GAAe,kEACftB,EAAO,KAAK,IAAIiB,CAAU,IAAK,IAAIA,CAAU,IAAK,IAAIA,CAAU,GAAG,GAIjEG,EAAQ,cACVE,GAAe,2BACftB,EAAO,KAAKoB,EAAQ,WAAW,GAG7BA,EAAQ,WACVE,GAAe,wBACftB,EAAO,KAAKoB,EAAQ,QAAQ,GAG1BA,EAAQ,SACVE,GAAe,sBACftB,EAAO,KAAKoB,EAAQ,MAAM,GAGxBA,EAAQ,gBACVE,GAAe,0BACftB,EAAO,KAAKoB,EAAQ,aAAa,GAG/BA,EAAQ,cACVE,GAAe,0BACftB,EAAO,KAAKoB,EAAQ,WAAW,GAG7BA,EAAQ,YACVE,GAAe,yBACftB,EAAO,KAAKoB,EAAQ,SAAS,GAI/B,IAAIG,EAAa,GACbmF,GAAQA,EAAK,OAAS,IACxBnF,EAAa;AAAA;AAAA;AAAA,MAIbD,GAAe,4BACfA,GAAeoF,EAAK,IAAI,IAAM,GAAG,EAAE,KAAK,GAAG,EAC3CpF,GAAe,IACftB,EAAO,KAAK,GAAG0G,CAAI,GAIrB,MAAMlF,EAAa;AAAA;AAAA;AAAA,MAGfD,CAAU;AAAA,YACJD,CAAW;AAAA,IAIfG,EAAY;AAAA;AAAA;AAAA,MAGdF,CAAU;AAAA,YACJD,CAAW;AAAA,eACRJ,CAAM,IAAIC,IAAc,OAAS,OAAS,KAAK;AAAA;AAAA,IAKtDO,EAAa,CAAC,GAAG1B,EAAQgB,EAAOK,CAAM,EAE5C,GAAI,CAGF,MAAMM,GADc,MAAMlB,GAAmCe,EAAYxB,CAAM,IACpD,OAAS,EAKpC,MAAO,CACL,QAHiB,MAAMW,GAA2Bc,EAAWC,CAAU,EAIvE,MAAAC,EACA,KAAAZ,EACA,MAAAC,EACA,WAAY,KAAK,KAAKW,EAAQX,CAAK,CAAA,CAEvC,OAASnB,EAAO,CACd,cAAQ,MAAM,eAAgBA,CAAK,EAC7BA,CACR,CACF,EAMa0M,GAAmB,SACvB5L,GAAqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAM3B,EC7GG6L,GAA2B,IAAM,CACrC,QAAQ,IAAI,oCAAoC,EAGhD,KAAM,CAACC,EAAYC,CAAa,EAAIhP,EAAAA,SAAsB,CAAA,CAAE,EACtD,CAACsF,EAASC,CAAU,EAAIvF,EAAAA,SAAkB,EAAI,EAC9C,CAACmL,EAAY8D,CAAa,EAAIjP,EAAAA,SAAiB,CAAC,EAChD,CAAC+G,EAAYC,CAAa,EAAIhH,EAAAA,SAAiB,CAAC,EAChD,CAACiH,EAAaC,CAAc,EAAIlH,EAAAA,SAAiB,CAAC,EAClD,CAACuD,EAAY4B,CAAa,EAAInF,EAAAA,SAAiB,EAAE,EACjD,CAACqH,EAAcC,CAAe,EAAItH,EAAAA,SAAmB,CAAA,CAAE,EACvD,CAACuH,EAAuBC,CAAwB,EAAIxH,EAAAA,SAAmB,CAAA,CAAE,EACzE,CAACyH,EAAeC,EAAgB,EAAI1H,EAAAA,SAAmB,CAAA,CAAE,EACzD,CAACwD,EAAQmE,CAAS,EAAI3H,EAAAA,SAAiB,MAAM,EAC7C,CAACyD,EAAWyL,CAAY,EAAIlP,EAAAA,SAAiB,KAAK,EAGlD,CAAC8H,EAAcC,EAAe,EAAI/H,EAAAA,SAA6B,IAAI,EACnE,CAACgI,EAAmBC,EAAoB,EAAIjI,EAAAA,SAAiB,EAAE,EAC/D,CAACkI,EAAWC,EAAY,EAAInI,EAAAA,SAAmC,CAAA,CAAE,EAGjE,CAACmP,GAAaC,CAAc,EAAIpP,EAAAA,SAAiB,EAAE,EACnD,CAAC6I,EAAUwG,CAAW,EAAIrP,EAAAA,SAAiB,EAAE,EAC7C,CAACsP,GAAQC,EAAS,EAAIvP,EAAAA,SAAiB,EAAE,EACzC,CAACwP,GAAeC,EAAgB,EAAIzP,EAAAA,SAAiB,EAAE,EACvD,CAAC0P,GAAaC,EAAc,EAAI3P,EAAAA,SAAiB,EAAE,EACnD,CAAC4P,GAAWC,EAAY,EAAI7P,EAAAA,SAAiB,EAAE,EAE/CsI,GAAWC,GAAA,EACXF,GAAW5I,GAAA,EACX+I,EAAc,IAAI,gBAAgBH,GAAS,MAAM,EAGvD1C,EAAAA,UAAU,IAAM,CACd,QAAQ,IAAI,wBAAyB,EAAQmC,CAAa,CAC5D,EAAG,CAACA,CAAY,CAAC,EAUjBnC,EAAAA,UAAU,IAAM,CACd,QAAQ,IAAI,0BAA0B,GACrB,SAAY,CAC3B,GAAI,CACF,QAAQ,IAAI,WAAW,EACvB,MAAMqD,EAAO,MAAM8G,GAAiB,EACpC,QAAQ,IAAI,aAAc9G,CAAI,EAI9BtB,GADiB,CAAC,KAAM,QAAS,KAAM,KAAM,IAAI,CACxB,CAC3B,OAASvF,EAAO,CACd,QAAQ,MAAM,WAAYA,CAAK,CACjC,CACF,GAEA,CACF,EAAG,CAAA,CAAE,EAGLwD,EAAAA,UAAU,IAAM,CACd,QAAQ,IAAI,+BAAgC0C,GAAS,MAAM,GACpC,SAAY,CACjC9C,EAAW,EAAI,EACf,GAAI,CAEF,MAAMlC,EAAO,SAASmF,EAAY,IAAI,MAAM,GAAK,GAAG,EAC9CE,EAASF,EAAY,IAAI,QAAQ,GAAK,GACtCQ,EAAOR,EAAY,IAAI,MAAM,EAAIA,EAAY,IAAI,MAAM,EAAE,MAAM,GAAG,EAAI,CAAA,EACtEO,EAAOP,EAAY,IAAI,QAAQ,GAAK,OACpCuH,EAAQvH,EAAY,IAAI,WAAW,GAAK,MAGxCwH,GAAMxH,EAAY,IAAI,aAAa,GAAK,GACxCyH,GAAMzH,EAAY,IAAI,UAAU,GAAK,GACrC0H,GAAM1H,EAAY,IAAI,QAAQ,GAAK,GACnC2H,GAAY3H,EAAY,IAAI,eAAe,GAAK,GAChD4H,GAAU5H,EAAY,IAAI,aAAa,GAAK,GAC5C6H,GAAQ7H,EAAY,IAAI,WAAW,GAAK,GAE9C,QAAQ,IAAI,mBAAoB,CAAE,KAAAnF,EAAM,OAAAqF,EAAQ,KAAAM,EAAM,KAAAD,EAAM,MAAAgH,EAAO,IAAAC,GAAK,IAAAC,GAAK,IAAAC,GAAK,UAAAC,GAAW,QAAAC,GAAS,MAAAC,GAAO,EAG7GnJ,EAAe7D,CAAI,EACnB8B,EAAcuD,CAAM,EACpBpB,EAAgB0B,CAAI,EACpBrB,EAAUoB,CAAI,EACdmG,EAAaa,CAAK,EAClBX,EAAeY,EAAG,EAClBX,EAAYY,EAAG,EACfV,GAAUW,EAAG,EACbT,GAAiBU,EAAS,EAC1BR,GAAeS,EAAO,EACtBP,GAAaQ,EAAK,EAGlB,QAAQ,IAAI,cAAe,CAAE,KAAAhN,EAAM,OAAAqF,EAAQ,KAAAM,EAAM,KAAAD,EAAM,MAAAgH,EAAO,IAAAC,GAAK,IAAAC,GAAK,IAAAC,GAAK,UAAAC,GAAW,QAAAC,GAAS,MAAAC,GAAO,EACxG,MAAM7N,GAAS,MAAM8N,GACnBjN,EACA,GACAqF,EACAM,EACAD,EACAgH,EACAC,GACAC,GACAC,GACAC,GAAY,SAASA,EAAS,EAAI,EAClCC,GAAU,SAASA,EAAO,EAAI,EAC9BC,GAAQ,SAASA,EAAK,EAAI,CAAA,EAG5B,QAAQ,IAAI,cAAe7N,EAAM,EACjCwM,EAAcxM,GAAO,KAAK,EAC1ByM,EAAczM,GAAO,UAAU,EAC/BwE,EAAcxE,GAAO,KAAK,CAC5B,OAASL,EAAO,CACd,QAAQ,MAAM,eAAgBA,CAAK,CACrC,QAAA,CACEoD,EAAW,EAAK,CAClB,CACF,GAEA,CACF,EAAG,CAAC8C,GAAS,MAAM,CAAC,EAGpB,MAAMkI,EAA0B,MAAO9H,GAAgB,CACrD,QAAQ,IAAI,GAAGA,CAAG,SAAS,EAC3B,IAAIpG,EAAQ,GAaZ,GAZIoG,IAAQ,KACVpG,EAAQ,kHACCoG,IAAQ,QACjBpG,EAAQ,yGACCoG,IAAQ,KACjBpG,EAAQ,mGACCoG,IAAQ,KACjBpG,EAAQ,+GACCoG,IAAQ,OACjBpG,EAAQ,gHAGN,CAACA,EAAO,MAAO,CAAA,EAEnB,GAAI,CAKF,OAHgB,MAAMY,GAA4CZ,CAAK,GAGxD,IAAImO,GAAQ,OAAOA,EAAK,KAAK,CAAC,EAAE,OAAO,OAAO,CAC/D,OAASrO,EAAO,CACd,eAAQ,MAAM,GAAGsG,CAAG,WAAYtG,CAAK,EAC9B,CAAA,CACT,CACF,EAGMuH,EAAqB,MAAOvJ,EAAsCsI,IAAgB,CAMtF,GALA,QAAQ,IAAI,GAAGA,CAAG,aAActI,EAAM,aAAa,EACnD4H,GAAgB5H,EAAM,aAAa,EACnC8H,GAAqBQ,CAAG,EAGpB,CAACP,EAAUO,CAAG,EAChB,GAAI,CACF,MAAMkB,EAAQ,MAAM4G,EAAwB9H,CAAG,EAC/C,QAAQ,IAAI,OAAOA,CAAG,OAAQkB,CAAK,EACnCxB,GAAayB,IAAS,CACpB,GAAGA,EACH,CAACnB,CAAG,EAAGkB,CAAA,EACP,CACJ,OAASxH,EAAO,CACd,QAAQ,MAAM,GAAGsG,CAAG,YAAatG,CAAK,CACxC,CAEJ,EAGM0H,EAAsB,IAAM,CAChC,QAAQ,IAAI,YAAY,EACxB9B,GAAgB,IAAI,EACpBE,GAAqB,EAAE,CACzB,EAGM6B,EAAoBnB,GAAiB,CACzC,QAAQ,IAAI,SAASA,CAAI,SAASX,CAAiB,GAAG,EAElDA,IAAsB,KACxBoH,EAAezG,CAAI,EACVX,IAAsB,QAC/BqH,EAAY1G,CAAI,EACPX,IAAsB,KAC/BuH,GAAU5G,CAAI,EACLX,IAAsB,KAC/ByH,GAAiB9G,CAAI,EACZX,IAAsB,MAC/B6H,GAAalH,CAAI,EAGnBkB,EAAA,EACA4G,EAAA,CACF,EAGMnG,EAAkB,CAACnK,EAA6BoK,IAAsB,CAC1E,QAAQ,IAAI,UAAWA,CAAO,EAC9BjD,EAAgBiD,CAAO,EAGvB,MAAMC,EAAcnD,EAAa,OAAOoB,GAAO,CAAC8B,EAAQ,SAAS9B,CAAG,CAAC,EAErE,UAAWA,KAAO+B,EACZ/B,IAAQ,KACV2G,EAAe,EAAE,EACR3G,IAAQ,QACjB4G,EAAY,EAAE,EACL5G,IAAQ,KACjB8G,GAAU,EAAE,EACH9G,IAAQ,MACjBgH,GAAiB,EAAE,EACnBE,GAAe,EAAE,GACRlH,IAAQ,MACjBoH,GAAa,EAAE,EAKnB,MAAMnF,EAAYH,EAAQ,OAAO9B,GAAO,CAACpB,EAAa,SAASoB,CAAG,CAAC,EAE/DiC,EAAU,OAAS,GACrBA,EAAU,QAAQ,MAAOjC,GAAQ,CAC/B,GAAI,CAACP,EAAUO,CAAG,EAChB,GAAI,CACF,MAAMkB,EAAQ,MAAM4G,EAAwB9H,CAAG,EAC/CN,GAAayB,KAAS,CACpB,GAAGA,GACH,CAACnB,CAAG,EAAGkB,CAAA,EACP,CACJ,OAASxH,EAAO,CACd,QAAQ,MAAM,GAAGsG,CAAG,YAAatG,CAAK,CACxC,CAEJ,CAAC,EAGHsO,EAAA,CACF,EAkBMlH,EAAmB,CAACpJ,EAAmCqJ,IAAkB,CAC7E,QAAQ,IAAI,UAAUA,CAAK,EAAE,EAC7BtC,EAAesC,CAAK,EAEpB,MAAMkH,EAAY,IAAI,gBAAgBrI,GAAS,MAAM,EACrDqI,EAAU,IAAI,OAAQlH,EAAM,SAAA,CAAU,EACtClB,GAAS,CAAE,OAAQoI,EAAU,SAAA,EAAY,CAC3C,EAGM7K,EAAe,IAAM,CACzB,QAAQ,IAAI,SAAStC,CAAU,EAAE,EACjCkN,EAAA,CACF,EAGM9F,EAAoB,IAAM,CAC9B,QAAQ,IAAI,UAAU,EACtBxF,EAAc,EAAE,EAChBmC,EAAgB,CAAA,CAAE,EAClBE,EAAyB,CAAA,CAAE,EAC3B4H,EAAe,EAAE,EACjBC,EAAY,EAAE,EACdE,GAAU,EAAE,EACZE,GAAiB,EAAE,EACnBE,GAAe,EAAE,EACjBE,GAAa,EAAE,EACf3I,EAAe,CAAC,EAGhB,MAAMsB,EAAc,IAAI,gBACpBhF,IAAW,QACbgF,EAAY,IAAI,SAAUhF,CAAM,EAE9BC,IAAc,OAChB+E,EAAY,IAAI,YAAa/E,CAAS,EAExC6E,GAAS,CAAE,OAAQE,EAAY,SAAA,EAAY,CAC7C,EAGMiI,EAAqB,IAAM,CAC/B,QAAQ,IAAI,WAAW,EACvB,MAAME,EAAiB,IAAI,gBAEvB1J,EAAc,GAAG0J,EAAe,IAAI,OAAQ1J,EAAY,UAAU,EAClE1D,GAAYoN,EAAe,IAAI,SAAUpN,CAAU,EACnD8D,EAAa,OAAS,GAAGsJ,EAAe,IAAI,OAAQtJ,EAAa,KAAK,GAAG,CAAC,EAC1E7D,IAAW,QAAQmN,EAAe,IAAI,SAAUnN,CAAM,EACtDC,IAAc,OAAOkN,EAAe,IAAI,YAAalN,CAAS,EAC9D0L,IAAawB,EAAe,IAAI,cAAexB,EAAW,EAC1DtG,GAAU8H,EAAe,IAAI,WAAY9H,CAAQ,EACjDyG,IAAQqB,EAAe,IAAI,SAAUrB,EAAM,EAC3CE,IAAemB,EAAe,IAAI,gBAAiBnB,EAAa,EAChEE,IAAaiB,EAAe,IAAI,cAAejB,EAAW,EAC1DE,IAAWe,EAAe,IAAI,YAAaf,EAAS,EAExD,QAAQ,IAAI,eAAgBe,EAAe,SAAA,CAAU,EACrDrI,GAAS,CAAE,OAAQqI,EAAe,SAAA,EAAY,CAChD,EAGMC,EAAiB,IAAM,CAC3B,MAAMC,EAAgB,CAAA,EAQtB,OANI1B,MAA2B,KAAK,CAAE,MAAO,OAAOA,EAAW,GAAI,SAAU,IAAM,CAAEC,EAAe,EAAE,EAAGqB,EAAA,CAAsB,EAAG,EAC9HjB,MAA6B,KAAK,CAAE,MAAO,OAAOA,EAAa,GAAI,SAAU,IAAM,CAAEC,GAAiB,EAAE,EAAGgB,EAAA,CAAsB,EAAG,EACpIb,MAAyB,KAAK,CAAE,MAAO,OAAOA,EAAS,GAAI,SAAU,IAAM,CAAEC,GAAa,EAAE,EAAGY,EAAA,CAAsB,EAAG,EACxH5H,KAAwB,KAAK,CAAE,MAAO,UAAUA,CAAQ,GAAI,SAAU,IAAM,CAAEwG,EAAY,EAAE,EAAGoB,EAAA,CAAsB,EAAG,EACxHnB,MAAsB,KAAK,CAAE,MAAO,OAAOA,EAAM,GAAI,SAAU,IAAM,CAAEC,GAAU,EAAE,EAAGkB,EAAA,CAAsB,EAAG,EAE/GI,EAAc,SAAW,GAAK,CAACtN,GAAc8D,EAAa,SAAW,EAAU,WAGhFxG,EAAA,CAAI,GAAI,CAAE,GAAI,GACb,SAAA5B,EAAAA,IAACsH,GAAA,CACC,SAAS,OACT,aACGlF,EAAA,CAAO,MAAM,UAAU,KAAK,QAAQ,QAASsJ,EAAmB,SAAA,KAAA,CAEjE,EAGD,SAAAkG,EAAc,OAAS,EACpB,UAAUA,EAAc,IAAIC,GAAKA,EAAE,KAAK,EAAE,KAAK,IAAI,CAAC,GACpDvN,EACE,IAAIA,CAAU,QACd8D,EAAa,OAAS,EACpB,MAAMA,EAAa,KAAK,IAAI,CAAC,UAC7B,EAAA,CAAA,EAEZ,CAEJ,EAEA,OACE7G,EAAAA,KAACe,IAAU,SAAS,KAAK,GAAI,CAAE,GAAI,GACjC,SAAA,CAAAtC,EAAAA,IAACqB,GAAW,QAAQ,KAAK,UAAU,KAAK,aAAY,GAAC,SAAA,OAAA,CAErD,EAEAE,OAACkG,IAAM,GAAI,CAAE,EAAG,EAAG,GAAI,GAErB,SAAA,CAAAlG,EAAAA,KAACK,GAAI,GAAI,CAAE,QAAS,OAAQ,cAAe,CAAE,GAAI,SAAU,GAAI,OAAS,IAAK,EAAG,GAAI,GAClF,SAAA,CAAA5B,EAAAA,IAACiH,GAAA,CACC,UAAS,GACT,MAAM,mBACN,MAAO3C,EACP,SAAWuC,GAAMX,EAAcW,EAAE,OAAO,KAAK,EAC7C,WAAaA,GAAMA,EAAE,MAAQ,SAAWD,EAAA,EACxC,WAAY,CACV,eACE5G,EAAAA,IAACmM,GAAA,CAAe,SAAS,QACvB,SAAAnM,EAAAA,IAACkH,KAAW,CAAA,CACd,CAAA,CAEJ,CAAA,EAEFlH,EAAAA,IAACoC,EAAA,CACC,QAAQ,YACR,QAASwE,EACT,GAAI,CAAE,SAAU,OAAA,EACjB,SAAA,IAAA,CAAA,CAED,EACF,SAGChF,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,cAAe,CAAE,GAAI,SAAU,GAAI,KAAA,EAAS,IAAK,EAAG,GAAI,EAAG,WAAY,cAEjG,SAAA,CAAA5B,EAAAA,IAACoM,GAAA,CACC,SAAQ,GACR,GAAG,gBACH,QAAS5D,EACT,MAAOJ,EACP,SAAUiD,EACV,UAAS,GACT,YAAchI,GACZrD,EAAAA,IAACiH,GAAA,CACE,GAAG5D,EACJ,QAAQ,WACR,MAAM,UACN,YAAY,OAAA,CAAA,EAGhB,WAAY,CAACkH,EAAO8B,IAClB9B,EAAM,IAAI,CAAC+B,EAAQvG,IAAU,CAE3B,MAAMyG,EAAe,GAAQvD,EAAUqD,CAAM,GAAKrD,EAAUqD,CAAM,EAAE,OAAS,GAG7E,IAAIwF,EAAgB,GACpB,OAAIxF,IAAW,KAAMwF,EAAgB5B,GAC5B5D,IAAW,QAASwF,EAAgBlI,EACpC0C,IAAW,KAAMwF,EAAgBzB,GACjC/D,IAAW,KAAMwF,EAAgBvB,GACjCjE,IAAW,OAAMwF,EAAgBnB,IAGxC3Q,EAAAA,IAACgH,EAAA,CAEC,aACGpF,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,QAAA,EACrC,SAAA,CAAA0K,EACAwF,GACC9R,EAAAA,IAACqB,EAAA,CACC,QAAQ,UACR,GAAI,CACF,GAAI,GACJ,WAAY,OACZ,gBAAiB,sBACjB,aAAc,MACd,GAAI,GACJ,GAAI,EAAA,EAGL,SAAAyQ,CAAA,CAAA,EAGJtF,GACCxM,EAAAA,IAAC4M,GAAA,CAAkB,SAAS,OAAA,CAAQ,CAAA,EAExC,EAED,GAAGP,EAAY,CAAE,MAAAtG,EAAO,EACzB,MAAO+L,EAAgB,UAAY,UACnC,QAAQ,WACR,QAAU5Q,IAAU,CAElBA,GAAM,gBAAA,EACNuJ,EAAmBvJ,GAAOoL,CAAM,CAClC,EACA,SAAWpL,IAAU,CAEnBmL,EAAY,CAAE,MAAAtG,CAAA,CAAO,EAAE,SAAS7E,EAAK,CACvC,EACA,GAAI,CACF,SAAU,OACV,mBAAoB,CAClB,SAAU,SACV,WAAY,QAAA,CACd,CACF,EA1CKoL,CAAA,CA6CX,CAAC,CAAA,CAAA,SAKJO,GAAA,CAAY,GAAI,CAAE,SAAU,KAC3B,SAAA,CAAA7M,EAAAA,IAAC8M,GAAA,CAAW,GAAG,oBAAoB,SAAA,OAAI,EACvCvL,EAAAA,KAACwL,GAAA,CACC,QAAQ,oBACR,MAAO,GAAGxI,CAAM,IAAIC,CAAS,GAC7B,MAAM,OACN,SAAWqC,GAAM,CACf,KAAM,CAAC+E,EAAWmG,CAAY,EAAIlL,EAAE,OAAO,MAAM,MAAM,GAAG,EAC1D6B,EAAUkD,CAAS,EACnBqE,EAAa8B,CAAY,EACzBP,EAAA,CACF,EAEA,SAAA,CAAAxR,EAAAA,IAACiN,EAAA,CAAS,MAAM,WAAW,SAAA,UAAO,EAClCjN,EAAAA,IAACiN,EAAA,CAAS,MAAM,YAAY,SAAA,UAAO,EACnCjN,EAAAA,IAACiN,EAAA,CAAS,MAAM,gBAAgB,SAAA,UAAO,EACvCjN,EAAAA,IAACiN,EAAA,CAAS,MAAM,iBAAiB,SAAA,UAAO,EACxCjN,EAAAA,IAACiN,EAAA,CAAS,MAAM,kBAAkB,SAAA,UAAO,EACzCjN,EAAAA,IAACiN,EAAA,CAAS,MAAM,mBAAmB,SAAA,SAAA,CAAO,CAAA,CAAA,CAAA,CAC5C,CAAA,CACF,CAAA,EACF,EAGAjN,EAAAA,IAACkN,GAAA,CACC,KAAM,EAAQrE,EACd,SAAUA,EACV,QAAS+B,EACT,aAAc,CACZ,SAAU,SACV,WAAY,MAAA,EAEd,gBAAiB,CACf,SAAU,MACV,WAAY,MAAA,EAGd,SAAArJ,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,EAAG,EAAG,MAAO,IAAK,UAAW,IAAK,SAAU,MAAA,EACrD,SAAA,CAAA5B,EAAAA,IAACqB,EAAA,CAAW,QAAQ,YAAY,aAAY,GACzC,SAAA0H,IAAsB,KAAO,QAC7BA,IAAsB,QAAU,WAChCA,IAAsB,KAAO,QAC7BA,IAAsB,KAAO,QAC7BA,IAAsB,KAAO,QAAU,QAAA,CAC1C,EAEAxH,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,SAAU,OAAQ,IAAK,EAAG,GAAI,CAAA,EACxD,SAAA,CAAA5B,EAAAA,IAACgH,EAAA,CACC,MAAM,OACN,QAAS,IAAM6D,EAAiB,EAAE,EAClC,QAAQ,WACR,KAAK,QACL,GAAI,CAAE,GAAI,CAAA,CAAE,CAAA,EAGb5B,EAAUF,CAAiB,GAAG,IAAIW,GACjC1J,EAAAA,IAACgH,EAAA,CAEC,MAAO0C,EACP,QAAS,IAAMmB,EAAiBnB,CAAI,EACpC,QAAQ,WACR,KAAK,QACL,MACGX,IAAsB,MAAQW,IAASwG,IACvCnH,IAAsB,SAAWW,IAASE,GAC1Cb,IAAsB,MAAQW,IAAS2G,IACvCtH,IAAsB,MAAQW,IAAS6G,IACvCxH,IAAsB,MAAQW,IAASiH,GACpC,UACA,UAEN,GAAI,CACF,SAAU,SACV,aAAc,WACd,SAAU,MAAA,CACZ,EAlBKjH,CAAA,CAoBR,CAAA,CAAA,CACH,CAAA,CAAA,CACF,CAAA,CAAA,QAIDiI,EAAA,EAAe,EAEhBpQ,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,gBAAiB,WAAY,SAAU,GAAI,CAAA,EACrF,SAAA,CAAAL,EAAAA,KAACF,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAC/B,SAAA,CAAAyG,EAAW,OAAA,EACd,EACCoE,EAAa,GACZlM,EAAAA,IAACqN,GAAA,CACC,MAAOnB,EACP,KAAMlE,EACN,SAAUsC,EACV,MAAM,UACN,KAAK,OAAA,CAAA,CACP,CAAA,CAEJ,CAAA,EACF,EAECjE,EACCrG,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,SAAU,GAAI,GACxD,SAAA5B,MAACsN,GAAA,CAAA,CAAiB,CAAA,CACpB,EAEA/L,EAAAA,KAAAC,WAAA,CACG,SAAA,CAAAsO,EAAW,SAAW,EACrBvO,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,UAAW,SAAU,GAAI,CAAA,EAClC,SAAA,CAAA5B,EAAAA,IAACqB,EAAA,CAAW,QAAQ,KAAK,SAAA,iBAEzB,EACArB,EAAAA,IAACqB,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAAiB,GAAI,CAAE,GAAI,GAAK,SAAA,kBAAA,CAElE,CAAA,CAAA,CACF,QAEC2E,EAAA,CAAK,UAAS,GAAC,QAAS,EACtB,WAAW,IAAK6D,GACf7J,EAAAA,IAACgG,EAAA,CAAK,KAAI,GAAC,GAAI,GAAI,GAAI,EAAG,GAAI,EAC5B,SAAAhG,EAAAA,IAACwF,GAAA,CACC,GAAI,CACF,OAAQ,OACR,QAAS,OACT,cAAe,SACf,WAAY,iBACZ,UAAW,CACT,UAAW,aAAA,CACb,EAGF,SAAAxF,EAAAA,IAACwH,GAAA,CAAe,UAAWlG,EAAY,GAAI,eAAeuI,EAAU,EAAE,GACpE,SAAAtI,EAAAA,KAACkE,GAAA,CACC,SAAA,CAAAzF,EAAAA,IAACqB,EAAA,CAAW,QAAQ,KAAK,UAAU,MAAM,aAAY,GAClD,WAAU,IAAA,CACb,SACCA,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAAiB,aAAY,GAC5D,SAAA,CAAAwI,EAAU,YAAY,MAAIA,EAAU,WAAa,IAAI,IAAEA,EAAU,WAAa,IAAA,EACjF,QACCjI,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,SAAU,OAAQ,IAAK,GAAK,GAAI,CAAA,EACzD,SAAAiI,EAAU,MAAQA,EAAU,KAAK,IAAKL,GACrCxJ,EAAAA,IAACgH,EAAA,CAEC,MAAOwC,EACP,KAAK,QACL,QAAQ,WACR,GAAI,CAAE,cAAe,MAAA,CAAO,EAJvBA,CAAA,CAMR,CAAA,CACH,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CAAA,CACF,EAjCoCK,EAAU,EAkChD,CACD,EACH,EAIDqC,EAAa,GACZlM,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,SAAU,GAAI,CAAA,EACxD,SAAA5B,EAAAA,IAACqN,GAAA,CACC,MAAOnB,EACP,KAAMlE,EACN,SAAUsC,EACV,MAAM,SAAA,CAAA,CACR,CACF,CAAA,CAAA,CAEJ,CAAA,EAEJ,CAEJ,EC9pBM0H,GAAoD,CAAC,CAAE,cAAApK,EAAe,QAAAqK,EAAU,MAChF,CAACrK,GAAiBA,EAAc,SAAW,QAE1CvG,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAAiB,SAAA,mBAEnD,EAKFrB,EAAAA,IAACgG,GAAK,UAAS,GAAC,QAASiM,EAAU,EAAI,EACpC,SAAArK,EAAc,IAAK2F,GAClBvN,MAACgG,EAAA,CAAK,KAAI,GAAuB,GAAI,GAAI,GAAI,EAAG,GAAIiM,EAAU,EAAI,EAChE,SAAAjS,EAAAA,IAACwF,GAAA,CACC,GAAI,CACF,OAAQ,OACR,QAAS,OACT,cAAe,SACf,WAAY,iBACZ,UAAW,CACT,UAAW,aAAA,CACb,EAGF,SAAAxF,EAAAA,IAACwH,GAAA,CACC,UAAWlG,EACX,GAAI,iBAAiBiM,EAAa,EAAE,GACpC,GAAI,CAAE,SAAU,CAAA,EAEhB,gBAAC9H,GAAA,CACC,SAAA,CAAAzF,EAAAA,IAACqB,EAAA,CAAW,aAAY,GAAC,QAAQ,KAAK,UAAU,KAC7C,WAAa,IAAA,CAChB,EAECkM,EAAa,cAAgB,GAC5BhM,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,GAAI,GACpD,SAAA,CAAA5B,EAAAA,IAACkS,GAAA,CAAU,SAAS,QAAQ,GAAI,CAAE,GAAI,EAAG,MAAO,gBAAA,CAAiB,CAAG,EACpE3Q,EAAAA,KAACF,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAC/B,SAAA,CAAAkM,EAAa,cAAc,GAAA,CAAA,CAC9B,CAAA,EACF,GAGAA,EAAa,MAAQA,EAAa,kBACjC3L,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,GAAI,GACpD,SAAA,CAAA5B,EAAAA,IAACyN,GAAA,CAAe,SAAS,QAAQ,GAAI,CAAE,GAAI,EAAG,MAAO,gBAAA,CAAiB,CAAG,EACzElM,EAAAA,KAACF,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAC/B,SAAA,CAAAkM,EAAa,KAAOA,EAAa,KAAO,GACxCA,EAAa,MAAQA,EAAa,SAAW,MAAQ,GACrDA,EAAa,SAAWA,EAAa,SAAW,EAAA,CAAA,CACnD,CAAA,EACF,EAIDA,EAAa,KACZvN,MAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,SAAU,OAAQ,IAAK,GAAK,GAAI,CAAA,EACzD,SAAA2L,EAAa,IAAI,MAAM,GAAG,EACxB,OAAO/D,GAAOA,EAAI,KAAA,IAAW,IAAM,CAACA,EAAI,SAAS,OAAO,CAAC,EACzD,IAAI,CAACA,EAAK2I,IACTnS,EAAAA,IAACgH,EAAA,CAEC,MAAOwC,EAAI,KAAA,EACX,KAAK,QACL,MAAM,YACN,QAAQ,WACR,GAAI,CAAE,OAAQ,OAAQ,SAAU,SAAA,CAAU,EALrC2I,CAAA,CAOR,CAAA,CAEL,CAAA,CAAA,CAEJ,CAAA,CAAA,CACF,CAAA,CACF,EA9Dc5E,EAAa,EA+D7B,CACD,EACH,ECjEEiC,GAAgB,IACpBxP,EAAAA,IAAC4B,EAAA,CACC,UAAU,OACV,GAAI,CACF,QAAS,cACT,WAAY,SACZ,eAAgB,SAChB,MAAO,GACP,OAAQ,EAAA,EAGV,SAAA5B,EAAAA,IAACqB,EAAA,CACC,QAAQ,UACR,UAAU,OACV,GAAI,CACF,WAAY,QACZ,WAAY,OACZ,SAAU,MAAA,EAEb,SAAA,GAAA,CAAA,CAED,CACF,EAGI+Q,GAAsB,IAAM,CAChC,KAAM,CAAE,GAAAlO,CAAA,EAAOyK,GAAA,EACT,CAAC9E,EAAWwI,CAAY,EAAItR,EAAAA,SAAS,IAAI,EACzC,CAACsF,EAASC,CAAU,EAAIvF,EAAAA,SAAS,EAAI,EACrC,CAACmC,EAAOqD,CAAQ,EAAIxF,EAAAA,SAAS,IAAI,EACjC,CAACuR,EAAaC,CAAc,EAAIxR,EAAAA,SAAS,CAAA,CAAE,EAC3CsI,EAAWC,GAAA,EAEjB5C,EAAAA,UAAU,IAAM,CAuDVxC,IAtDmB,SAAY,CACjCoC,EAAW,EAAI,EACf,GAAI,CACF,MAAMK,EAAO,MAAM6L,GAAkC,SAAStO,CAAE,CAAC,EACjE,GAAI,CAACyC,EAAM,CACTJ,EAAS,mBAAmB,EAC5BD,EAAW,EAAK,EAChB,MACF,CACA+L,EAAa1L,CAAI,EAGjB,MAAM8L,EAAW,CAAA,EACjB,GAAI9L,EAAK,SAAU,CACjB,MAAM2L,EAAc,CAAE,KAAM3L,EAAK,SAAU,GAAI,IAAA,EAC/C,GAAI,CAGF2L,EAAY,GAAK,MAAMI,EAAsB/L,EAAK,QAAQ,CAC5D,OAASgM,EAAK,CACZ,QAAQ,MAAM,cAAeA,CAAG,CAClC,CACAF,EAAS,KAAKH,CAAW,CAC3B,CAEA,GAAI3L,EAAK,SAAU,CACjB,MAAM2L,EAAc,CAAE,KAAM3L,EAAK,SAAU,GAAI,IAAA,EAC/C,GAAI,CACF2L,EAAY,GAAK,MAAMI,EAAsB/L,EAAK,QAAQ,CAC5D,OAASgM,EAAK,CACZ,QAAQ,MAAM,cAAeA,CAAG,CAClC,CACAF,EAAS,KAAKH,CAAW,CAC3B,CAEA,GAAI3L,EAAK,SAAU,CACjB,MAAM2L,EAAc,CAAE,KAAM3L,EAAK,SAAU,GAAI,IAAA,EAC/C,GAAI,CACF2L,EAAY,GAAK,MAAMI,EAAsB/L,EAAK,QAAQ,CAC5D,OAASgM,EAAK,CACZ,QAAQ,MAAM,cAAeA,CAAG,CAClC,CACAF,EAAS,KAAKH,CAAW,CAC3B,CAEAC,EAAeE,CAAQ,CACzB,OAASE,EAAK,CACZ,QAAQ,MAAM,eAAgBA,CAAG,EACjCpM,EAAS,yBAAyB,CACpC,QAAA,CACED,EAAW,EAAK,CAClB,CACF,GAGE,CAEJ,EAAG,CAACpC,CAAE,CAAC,EAGP,MAAMwO,EAAwB,MAAOE,GAI5B,KAIHC,EAAkB,IAAM,CAC5B,GAAI,CAAChJ,EAAW,OAAO,KAEvB,MAAMiJ,EAAY,CAAA,EAElB,GAAIjJ,EAAU,OAAQ,CACpB,IAAIkJ,EAASlJ,EAAU,OACnBA,EAAU,UACZkJ,GAAU,IAAIlJ,EAAU,OAAO,IAEjCiJ,EAAU,KAAKC,CAAM,CACvB,CAEA,OAAIlJ,EAAU,cACZiJ,EAAU,KAAKjJ,EAAU,YAAY,EAGhCiJ,EAAU,OAAS,EAAIA,EAAU,KAAK,GAAG,EAAI,IACtD,EAGME,EAAiB,IACjB,CAACV,GAAeA,EAAY,SAAW,EAAU,KAE9CA,EAAY,IAAI,CAACW,EAASlN,WAC9B,OAAA,CACE,SAAA,CAAAA,EAAQ,GAAK,IACbkN,EAAQ,GACPjT,EAAAA,IAACyO,IAAK,UAAWnN,EAAY,GAAI,eAAe2R,EAAQ,EAAE,GAAI,MAAM,UAAU,UAAU,QACrF,SAAAA,EAAQ,KACX,EAEAA,EAAQ,IAAA,CAAA,EAPDlN,CASX,CACD,EAIGiJ,EAAiB,CAACkE,EAAS3I,IAAU,CACzC,GAAI,CAACA,EAAO,OAEZ,IAAI4I,EAAc,GAElB,OAAQD,EAAA,CACN,IAAK,cACHC,EAAc,eAAe,mBAAmB5I,CAAK,CAAC,GACtD,MACF,IAAK,OACH4I,EAAc,kBAAkB,mBAAmB5I,CAAK,CAAC,iBAAiB,mBAAmBA,CAAK,CAAC,GACnG,MACF,IAAK,OACH4I,EAAc,aAAa,mBAAmB5I,CAAK,CAAC,GACpD,MACF,IAAK,WACH4I,EAAc,YAAY,mBAAmB5I,CAAK,CAAC,GACnD,MACF,QACE,MAAA,CAGJlB,EAAS,eAAe8J,CAAW,EAAE,CACvC,EAGMC,EAAqB,CAACC,EAAenD,IAAgB,CACzD,MAAMf,EAAc,GAAGkE,CAAa,IAAInD,GAAe,EAAE,OACzD,MAAO,mCAAmC,mBAAmBf,CAAW,CAAC,EAC3E,EAEMC,EAAyBiE,GACtB,uDAAuD,mBAAmBA,CAAa,CAAC,GAGjG,GAAIhN,EACF,OACErG,EAAAA,IAACsC,IAAU,SAAS,KAAK,GAAI,CAAE,GAAI,CAAA,EACjC,SAAAtC,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,SAAU,GAAI,GACxD,SAAA5B,EAAAA,IAACsN,GAAA,EAAiB,CAAA,CACpB,CAAA,CACF,EAIJ,GAAIpK,GAAS,CAAC2G,EACZ,OACE7J,EAAAA,IAACsC,GAAA,CAAU,SAAS,KAAK,GAAI,CAAE,GAAI,CAAA,EACjC,gBAACmF,GAAA,CAAM,GAAI,CAAE,EAAG,GACd,SAAA,CAAAzH,EAAAA,IAACqB,GAAW,QAAQ,KAAK,MAAM,QAAQ,aAAY,GAAC,SAAA,KAAA,CAEpD,EACArB,EAAAA,IAACqB,EAAA,CAAW,UAAS,GAClB,YAAS,oBACZ,EACArB,EAAAA,IAACoC,EAAA,CACC,QAAQ,WACR,gBAAYyM,GAAA,EAAc,EAC1B,QAAS,IAAMxF,EAAS,EAAE,EAC3B,SAAA,IAAA,CAAA,CAED,CAAA,CACF,CAAA,CACF,EAKJ,MAAM4B,MAAc,IAChBpB,EAAU,OACZA,EAAU,MAAM,QAAQtC,GAAQ,CAC1BA,EAAK,KACMA,EAAK,IAAI,MAAM,GAAG,EAC1B,QAAQiC,GAAO,CAClB,MAAM8J,EAAa9J,EAAI,KAAA,EACnB8J,GAAc,CAACA,EAAW,SAAS,OAAO,GAC5CrI,EAAQ,IAAIqI,CAAU,CAE1B,CAAC,CAEL,CAAC,EAIH,MAAMC,GAAgB,CAAA,EAItB,GAHI1J,EAAU,aACZ0J,GAAc,KAAK,eAAe1J,EAAU,WAAW,EAAE,EAEvDA,EAAU,UAAY,EAAG,CAE3B,MAAM2J,EAAS,KAAK,MAAM3J,EAAU,UAAY,EAAE,EAAI,GACtD0J,GAAc,KAAK,QAAQC,CAAM,GAAG,CACtC,CACA,OAAI3J,EAAU,UAAY,GACxB0J,GAAc,KAAK,QAAQ1J,EAAU,SAAS,EAAE,EAE9CA,EAAU,UACZ0J,GAAc,KAAK,YAAY1J,EAAU,QAAQ,EAAE,EAEjDA,EAAU,QACZ0J,GAAc,KAAK,UAAU1J,EAAU,MAAM,EAAE,EAI/CtI,EAAAA,KAACe,IAAU,SAAS,KAAK,GAAI,CAAE,GAAI,GACjC,SAAA,CAAAtC,EAAAA,IAACoC,EAAA,CACC,QAAQ,WACR,UAAWd,EACX,GAAG,cACH,gBAAYuN,GAAA,EAAc,EAC1B,GAAI,CAAE,GAAI,CAAA,EACX,SAAA,UAAA,CAAA,EAIDtN,OAACkG,IAAM,GAAI,CAAE,EAAG,EAAG,GAAI,GACrB,SAAA,CAAAzH,EAAAA,IAACqB,EAAA,CAAW,QAAQ,KAAK,UAAU,KAAK,aAAY,GACjD,SAAAwI,EAAU,MAAQ,IAAA,CACrB,EAEAtI,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,SAAU,OAAQ,IAAK,EAAG,GAAI,CAAA,EAEvD,SAAA,CAAAiI,EAAU,aACT7J,EAAAA,IAACgH,EAAA,CACC,WAAOyM,GAAA,EAAW,EAClB,MAAO,eAAe5J,EAAU,WAAW,GAC3C,QAAQ,WACR,QAAS,IAAMmF,EAAe,cAAenF,EAAU,WAAW,EAClE,UAAS,EAAA,CAAA,EAGZA,EAAU,UAAY,GACrB7J,EAAAA,IAACgH,EAAA,CACC,WAAO0M,GAAA,EAAS,EAChB,MAAO,QAAQ,KAAK,MAAM7J,EAAU,UAAY,EAAE,EAAI,EAAE,IACxD,QAAQ,WACR,QAAS,IAAMmF,EAAe,OAAQ,KAAK,MAAMnF,EAAU,UAAY,EAAE,EAAI,EAAE,EAC/E,UAAS,EAAA,CAAA,EAGZA,EAAU,UAAY,GACrB7J,EAAAA,IAACgH,EAAA,CACC,WAAO2M,GAAA,EAAc,EACrB,MAAO,QAAQ9J,EAAU,SAAS,GAClC,QAAQ,WACR,QAAS,IAAMmF,EAAe,OAAQnF,EAAU,SAAS,EACzD,UAAS,EAAA,CAAA,EAGZA,EAAU,UACT7J,EAAAA,IAACgH,EAAA,CACC,WAAOqI,GAAA,EAAa,EACpB,MAAO,YAAYxF,EAAU,QAAQ,GACrC,QAAQ,WACR,QAAS,IAAMmF,EAAe,WAAYnF,EAAU,QAAQ,EAC5D,UAAS,EAAA,CAAA,EAGZA,EAAU,QACT7J,EAAAA,IAACgH,EAAA,CACC,WAAO4M,GAAA,EAAa,EACpB,MAAO/J,EAAU,OACjB,QAAQ,UAAA,CAAA,CACV,EAEJ,QAECnC,GAAA,CAAQ,GAAI,CAAE,GAAI,GAAK,EAGxBnG,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,GAAI,EAAG,QAAS,OAAQ,cAAe,MAAO,IAAK,CAAA,EAE3D,SAAA,CAAAiI,EAAU,SACT7J,MAACoH,GAAA,CAAQ,MAAM,WACb,SAAApH,EAAAA,IAACoC,EAAA,CACC,KAAMyH,EAAU,QAAQ,WAAW,MAAM,EAAIA,EAAU,QAAU,UAAUA,EAAU,OAAO,GAC5F,OAAO,SACP,IAAI,sBACJ,gBAAYgK,GAAA,EAAS,EACrB,QAAQ,YACR,KAAK,QACL,GAAI,CACF,gBAAiB,UACjB,MAAO,UACP,UAAW,CACT,gBAAiB,SAAA,CACnB,EAEH,SAAA,QAAA,CAAA,EAGH,EAGF7T,EAAAA,IAACoH,GAAA,CAAQ,MAAM,WACb,SAAApH,EAAAA,IAACoC,EAAA,CACC,KAAMgR,EAAmBvJ,EAAU,KAAMA,EAAU,WAAW,EAC9D,OAAO,SACP,IAAI,sBACJ,gBAAY3C,GAAA,EAAW,EACvB,QAAQ,YACR,KAAK,QACL,GAAI,CACF,gBAAiB,UACjB,MAAO,UACP,UAAW,CACT,gBAAiB,SAAA,CACnB,EAEH,SAAA,IAAA,CAAA,EAGH,EAEAlH,EAAAA,IAACoH,GAAA,CAAQ,MAAM,eACb,SAAApH,EAAAA,IAACoC,EAAA,CACC,KAAMgN,EAAsBvF,EAAU,IAAI,EAC1C,OAAO,SACP,IAAI,sBACJ,gBAAY2F,GAAA,EAAc,EAC1B,QAAQ,YACR,KAAK,QACL,GAAI,CACF,gBAAiB,UACjB,MAAO,UACP,UAAW,CACT,gBAAiB,SAAA,CACnB,EAEH,SAAA,WAAA,CAAA,CAED,CACF,CAAA,EACF,EAEAxP,MAAC8T,GAAA,CAAe,UAAWrM,GAAO,QAAQ,WAAW,GAAI,CAAE,GAAI,CAAA,EAC7D,SAAAzH,EAAAA,IAAC+T,GAAA,CACC,gBAACC,GAAA,CACE,SAAA,CAAAnK,EAAU,oBACRoK,GAAA,CACC,SAAA,CAAAjU,MAACkU,EAAA,CAAU,UAAU,KAAK,GAAI,CAAE,MAAO,MAAO,QAAS,qBAAA,EACrD,SAAAlU,EAAAA,IAACqB,EAAA,CAAW,QAAQ,YAAY,cAAE,EACpC,EACArB,EAAAA,IAACkU,EAAA,CAAW,SAAArK,EAAU,WAAA,CAAY,CAAA,EACpC,GAGAA,EAAU,UAAY,GAAKA,EAAU,UAAY,WAChDoK,GAAA,CACC,SAAA,CAAAjU,MAACkU,EAAA,CAAU,UAAU,KAAK,GAAI,CAAE,MAAO,MAAO,QAAS,qBAAA,EACrD,SAAAlU,EAAAA,IAACqB,EAAA,CAAW,QAAQ,YAAY,mBAAO,EACzC,SACC6S,EAAA,CACE,SAAA,CAAArK,EAAU,UAAY,EAAI,GAAGA,EAAU,SAAS,IAAM,KACtDA,EAAU,UAAY,EAAI,MAAMA,EAAU,SAAS,IAAM,EAAA,CAAA,CAC5D,CAAA,EACF,EAGDA,EAAU,QACTtI,EAAAA,KAAC0S,GAAA,CACC,SAAA,CAAAjU,MAACkU,EAAA,CAAU,UAAU,KAAK,GAAI,CAAE,MAAO,MAAO,QAAS,qBAAA,EACrD,SAAAlU,EAAAA,IAACqB,EAAA,CAAW,QAAQ,YAAY,eAAG,EACrC,EACArB,EAAAA,IAACkU,EAAA,CAAW,SAAArK,EAAU,MAAA,CAAO,CAAA,EAC/B,EAGDA,EAAU,YACTtI,EAAAA,KAAC0S,GAAA,CACC,SAAA,CAAAjU,MAACkU,EAAA,CAAU,UAAU,KAAK,GAAI,CAAE,MAAO,MAAO,QAAS,qBAAA,EACrD,SAAAlU,EAAAA,IAACqB,EAAA,CAAW,QAAQ,YAAY,cAAE,EACpC,EACArB,EAAAA,IAACkU,EAAA,CAAW,SAAArK,EAAU,UAAA,CAAW,CAAA,EACnC,EAGDA,EAAU,QACTtI,EAAAA,KAAC0S,GAAA,CACC,SAAA,CAAAjU,MAACkU,EAAA,CAAU,UAAU,KAAK,GAAI,CAAE,MAAO,MAAO,QAAS,qBAAA,EACrD,SAAAlU,EAAAA,IAACqB,EAAA,CAAW,QAAQ,YAAY,gBAAI,EACtC,EACArB,EAAAA,IAACkU,EAAA,CAAW,SAAArK,EAAU,MAAA,CAAO,CAAA,EAC/B,GAIAA,EAAU,QAAUA,EAAU,SAAWA,EAAU,sBAClDoK,GAAA,CACC,SAAA,CAAAjU,MAACkU,EAAA,CAAU,UAAU,KAAK,GAAI,CAAE,MAAO,MAAO,QAAS,qBAAA,EACrD,SAAAlU,EAAAA,IAACqB,EAAA,CAAW,QAAQ,YAAY,gBAAI,EACtC,EACArB,EAAAA,IAACkU,EAAA,CACC,SAAA3S,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,QAAA,EACtC,SAAA,CAAA5B,EAAAA,IAACmU,GAAA,CAAW,GAAI,CAAE,GAAI,EAAG,SAAU,OAAQ,MAAO,gBAAA,CAAiB,CAAG,EACtEnU,EAAAA,IAACqB,EAAA,CAAW,QAAQ,QAAS,YAAgB,CAAE,CAAA,CAAA,CACjD,CAAA,CACF,CAAA,EACF,GAIAwI,EAAU,UAAYA,EAAU,UAAYA,EAAU,kBACrDoK,GAAA,CACC,SAAA,CAAAjU,MAACkU,EAAA,CAAU,UAAU,KAAK,GAAI,CAAE,MAAO,MAAO,QAAS,qBAAA,EACrD,SAAAlU,EAAAA,IAACqB,EAAA,CAAW,QAAQ,YAAY,mBAAO,EACzC,EACArB,EAAAA,IAACkU,EAAA,CACC,SAAAlU,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,cAAe,SAAU,IAAK,CAAA,EACvD,SAAAoR,EAAA,EACH,CAAA,CACF,CAAA,EACF,EAIDnJ,EAAU,UACTtI,EAAAA,KAAC0S,GAAA,CACC,SAAA,CAAAjU,MAACkU,EAAA,CAAU,UAAU,KAAK,GAAI,CAAE,MAAO,MAAO,QAAS,qBAAA,EACrD,SAAAlU,EAAAA,IAACqB,EAAA,CAAW,QAAQ,YAAY,iBAAK,EACvC,EACArB,EAAAA,IAACkU,EAAA,CAAW,SAAArK,EAAU,QAAA,CAAS,CAAA,CAAA,CACjC,CAAA,CAAA,CAEJ,EACF,EACF,EAGCoB,EAAQ,KAAO,GACd1J,EAAAA,KAACK,GAAI,GAAI,CAAE,GAAI,CAAA,EACb,SAAA,CAAA5B,MAACqB,EAAA,CAAW,QAAQ,KAAK,aAAY,GAAC,SAAA,SAEtC,EACArB,MAAC4B,GAAI,GAAI,CAAE,QAAS,OAAQ,SAAU,OAAQ,IAAK,EAAG,GAAI,CAAA,EACvD,eAAM,KAAKqJ,CAAO,EAAE,IAAI,CAACzB,EAAKzD,IAC7B/F,EAAAA,IAACgH,EAAA,CAEC,WAAOsI,GAAA,EAAgB,EACvB,MAAO,OAAO9F,CAAG,EACjB,QAAS,IAAMwF,EAAe,WAAYxF,CAAG,EAC7C,UAAS,GACT,MAAM,YACN,QAAQ,WACR,KAAK,OAAA,EAPAzD,CAAA,CASR,CAAA,CACH,CAAA,EACF,EAGD8D,EAAU,KACTtI,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,GAAI,GACb,SAAA,CAAA5B,MAACqB,EAAA,CAAW,QAAQ,KAAK,aAAY,GAAC,SAAA,KAEtC,EACArB,EAAAA,IAACqB,EAAA,CAAW,QAAQ,QAAQ,GAAI,CAAE,WAAY,UAAA,EAC3C,SAAAwI,EAAU,GAAA,CACb,CAAA,EACF,EAGDA,EAAU,OAASA,EAAU,MAAM,OAAS,GAC3CtI,EAAAA,KAAAC,WAAA,CACE,SAAA,CAAAD,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,GAAI,GACb,SAAA,CAAA5B,MAACqB,EAAA,CAAW,QAAQ,KAAK,aAAY,GAAC,SAAA,QAEtC,EACCwI,EAAU,MAAM,KAAKtC,GAAQA,EAAK,UAAYA,EAAK,SAAS,EAC3DvH,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,OAAQ,QAAS,MAAO,OAAQ,GAAI,EAAG,OAAQ,iBAAkB,aAAc,MAAO,SAAU,QAAA,EACzG,SAAA5B,EAAAA,IAACyP,GAAA,CACC,QAAS5F,EAAU,MAAM,UAAetC,EAAK,UAAYA,EAAK,SAAS,EACvE,KAAM,EACN,OAAQ,CAACsC,EAAU,MAAM,CAAC,EAAE,UAAY,QAASA,EAAU,MAAM,CAAC,EAAE,WAAa,QAAQ,CAAA,CAAA,EAE7F,EAEA7J,MAACqB,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAAiB,SAAA,uBAAA,CAEnD,CAAA,EAEJ,SAECO,EAAA,CAAI,GAAI,CAAE,GAAI,GACb,SAAA,CAAA5B,MAACqB,EAAA,CAAW,QAAQ,KAAK,aAAY,GAAC,SAAA,OAEtC,EACArB,EAAAA,IAACgS,GAAA,CAAiB,cAAenI,EAAU,KAAA,CAAO,CAAA,CAAA,CACpD,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,EACF,CAEJ,EC9gBMuK,GAAoB,IAAM,CAC9B,KAAM,CAAC/N,EAASC,CAAU,EAAIvF,EAAAA,SAAkB,EAAI,EAC9C,CAACsT,EAAOC,CAAQ,EAAIvT,EAAAA,SAAiB,CAAA,CAAE,EACvC,CAACwT,EAAUC,CAAW,EAAIzT,EAAAA,SAAiB,CAAA,CAAE,EAC7C,CAACoE,EAASsP,CAAU,EAAI1T,WAAkB,CAC9C,SAAU,GACV,OAAQ,EAAA,CACT,EACK,CAAC2T,EAAaC,CAAc,EAAI5T,EAAAA,SAAkB,EAAK,EACvD,CAAC6T,EAAcC,CAAe,EAAI9T,EAAAA,SAAsB,IAAI,EAC5D,CAAC+T,EAAiBC,CAAkB,EAAIhU,EAAAA,SAAkB,EAAK,EAErE2F,EAAAA,UAAU,IAAM,CACdsO,EAAA,CACF,EAAG,CAAA,CAAE,EAGL,MAAMC,EAA2BZ,GAAmC,CAClE,GAAI,CAACA,GAASA,EAAM,SAAW,QAAU,CAAE,KAAM,EAAG,GAAI,CAAA,EAGxD,MAAMa,EAAab,EAAM,OAAO9M,GAAQA,EAAK,cAAgB,CAAC,EAC9D,GAAI2N,EAAW,SAAW,EAAG,MAAO,CAAE,KAAM,EAAG,GAAI,CAAA,EAGnD,MAAMxK,EAAQwK,EAAW,IAAI3N,GAAQA,EAAK,aAAa,EAAE,KAAK,CAAC4N,EAAGC,IAAMD,EAAIC,CAAC,EAGvEC,GAAU3K,EAAM,CAAC,EACjB4K,EAAU5K,EAAMA,EAAM,OAAS,CAAC,EAGhC6K,GAAQ,KAAK,IAAI,IAAK,KAAK,OAAOD,EAAUD,IAAW,CAAC,CAAC,EAGzDG,EAAiB,KAAK,MAAM,KAAK,OAAA,GAAY9K,EAAM,OAAS,KAAK,MAAMA,EAAM,OAAS,CAAC,EAAE,EACzF+K,GAAY/K,EAAM8K,CAAc,EAGhCE,GAAU,KAAK,IAAID,GAAYF,GAAOD,CAAO,EAEnD,MAAO,CAAE,KAAMG,GAAW,GAAIC,EAAA,CAChC,EAEMV,EAAa,SAA2B,CAC5C1O,EAAW,EAAI,EACf,GAAI,CAEF,MAAMK,EAAO,MAAMgP,GAAoB,EAIvC,GAHAnB,EAAY7N,CAAI,EAGZ,CAACxB,EAAQ,UAAY,CAACA,EAAQ,OAAQ,CACxC,MAAMyQ,EAAkBX,EAAwBtO,CAAI,EACpD8N,EAAW,CACT,SAAUmB,EAAgB,KAAK,SAAA,EAC/B,OAAQA,EAAgB,GAAG,SAAA,CAAS,CACrC,EAGD,MAAMC,EAAelP,EAAK,WACxBY,GAAK,eAAiBqO,EAAgB,MACtCrO,GAAK,eAAiBqO,EAAgB,EAAA,EAGxCtB,EAASuB,CAAY,CACvB,KAAO,CAEL,IAAIC,EAAgBnP,EAEhBxB,EAAQ,WACV2Q,EAAgBA,EAAc,OAAOvO,GAAQA,EAAK,eAAiB,SAASpC,EAAQ,QAAQ,CAAC,GAG3FA,EAAQ,SACV2Q,EAAgBA,EAAc,OAAOvO,GAAQA,EAAK,eAAiB,SAASpC,EAAQ,MAAM,CAAC,GAG7FmP,EAASwB,CAAa,CACxB,CACF,OAAS5S,EAAO,CACd,QAAQ,MAAM,wBAAyBA,CAAK,CAC9C,QAAA,CACEoD,EAAW,EAAK,CAClB,CACF,EAEMyP,EAAsB7U,GAAqD,CAC/E,KAAM,CAAE,KAAA0R,EAAM,MAAArI,CAAA,EAAUrJ,EAAM,OAC9BuT,EAAW,CACT,GAAGtP,EACH,CAACyN,CAAI,EAAGrI,CAAA,CACT,CACH,EAEMyL,GAAe,IAAY,CAC/B1P,EAAW,EAAI,EAEf,IAAIwP,EAAgBvB,EAEhBpP,EAAQ,WACV2Q,EAAgBA,EAAc,OAAOvO,GAAQA,EAAK,eAAiB,SAASpC,EAAQ,QAAQ,CAAC,GAG3FA,EAAQ,SACV2Q,EAAgBA,EAAc,OAAOvO,GAAQA,EAAK,eAAiB,SAASpC,EAAQ,MAAM,CAAC,GAG7FmP,EAASwB,CAAa,EACtBxP,EAAW,EAAK,CAClB,EAEM2P,EAAe,IAAY,CAC/BxB,EAAW,CACT,SAAU,GACV,OAAQ,EAAA,CACT,EAGDH,EAASC,CAAQ,CACnB,EAEM2B,EAAmB3O,GAAqB,CAC5CsN,EAAgBtN,CAAI,EACpBwN,EAAmB,EAAI,CACzB,EAEA,OACExT,EAAAA,KAACe,IAAU,SAAS,KAAK,GAAI,CAAE,GAAI,GACjC,SAAA,CAAAtC,EAAAA,IAACqB,GAAW,QAAQ,KAAK,UAAU,KAAK,aAAY,GAAC,SAAA,MAAA,CAErD,EAEAE,OAACkG,IAAM,GAAI,CAAE,EAAG,EAAG,GAAI,GACrB,SAAA,CAAAzH,EAAAA,IAACoC,EAAA,CACC,gBAAY+T,GAAA,EAAe,EAC3B,QAAS,IAAMxB,EAAe,CAACD,CAAW,EAC1C,GAAI,CAAE,GAAI,CAAA,EAET,WAAc,YAAc,UAAA,CAAA,EAG9BA,GACC1U,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,GAAI,CAAA,EACb,SAAAL,EAAAA,KAACyE,EAAA,CAAK,UAAS,GAAC,QAAS,EACvB,SAAA,CAAAhG,EAAAA,IAACgG,EAAA,CAAK,KAAI,GAAC,GAAI,GAAI,GAAI,EAAG,GAAI,EAC5B,SAAAhG,EAAAA,IAACiH,GAAA,CACC,UAAS,GACT,MAAM,SACN,KAAK,WACL,KAAK,SACL,MAAO9B,EAAQ,SACf,SAAU4Q,CAAA,CAAA,EAEd,EACA/V,EAAAA,IAACgG,GAAK,KAAI,GAAC,GAAI,GAAI,GAAI,EAAG,GAAI,EAC5B,SAAAhG,EAAAA,IAACiH,GAAA,CACC,UAAS,GACT,MAAM,SACN,KAAK,SACL,KAAK,SACL,MAAO9B,EAAQ,OACf,SAAU4Q,CAAA,CAAA,EAEd,QACC/P,EAAA,CAAK,KAAI,GAAC,GAAI,GAAI,GAAI,EACrB,SAAAzE,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,IAAK,EAAG,OAAQ,QAC1C,SAAA,CAAA5B,EAAAA,IAACoC,EAAA,CACC,QAAQ,YACR,MAAM,UACN,QAAS4T,GACT,GAAI,CAAE,SAAU,CAAA,EACjB,SAAA,SAAA,CAAA,EAGDhW,EAAAA,IAACoC,EAAA,CACC,QAAQ,WACR,QAAS6T,EACT,GAAI,CAAE,SAAU,CAAA,EACjB,SAAA,KAAA,CAAA,CAED,CAAA,CACF,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,EAGF1U,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,WAAY,SAAU,GAAI,CAAA,EACpD,SAAA,CAAA5B,EAAAA,IAACI,GAAA,CAAQ,GAAI,CAAE,GAAI,GAAK,EACxBmB,EAAAA,KAACF,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAAiB,SAAA,CAAA,iBAClCgT,EAAM,OAAO,KAAGlP,EAAQ,UAAYA,EAAQ,QAAU,IAAIA,EAAQ,QAAQ,KAAKA,EAAQ,MAAM,IAAA,CAAA,CAC9G,CAAA,CAAA,CACF,CAAA,EACF,EAECkB,EACCrG,EAAAA,IAAC4B,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,SAAU,GAAI,CAAA,EACxD,SAAA5B,EAAAA,IAACsN,GAAA,CAAA,CAAiB,CAAA,CACpB,EAEA/L,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,OAAQ,IAAK,QAAS,WAAY,SAAU,WAAY,aAAc,CAAA,EAC/E,SAAA,CAAA5B,EAAAA,IAACyP,GAAA,CACC,QAAS4E,EACT,OAAO,QACP,KAAM,EACN,OAAQ,CAAC,QAAS,QAAQ,CAAA,CAAA,EAE5B9S,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,SAAU,WAAY,IAAK,GAAI,MAAO,GAAI,MAAO,IAAK,UAAW,IAAK,SAAU,OAAQ,QAAS,mBAAoB,aAAc,EAAG,UAAW,EAAG,EAAG,EAAG,OAAQ,GAAA,EAC3K,SAAA,CAAA5B,MAACqB,EAAA,CAAW,QAAQ,KAAK,aAAY,GAAC,SAAA,QAEtC,EACCgT,EAAM,SAAW,EAChBrU,EAAAA,IAACqB,GAAW,QAAQ,QAAQ,2BAE5B,EAEArB,EAAAA,IAAC8B,IAAK,MAAK,GACR,WAAM,IAAKyF,GACVhG,OAAC6U,GAAM,SAAN,CACC,SAAA,CAAApW,EAAAA,IAACkC,GAAA,CACC,QAAS,IAAMgU,EAAgB3O,CAAI,EACnC,GAAI,CACF,OAAQ,UACR,QAASqN,GAAgBA,EAAa,KAAOrN,EAAK,GAAK,kBAAoB,cAC3E,UAAW,CAAE,QAAS,cAAA,CAAe,EAGvC,SAAAvH,EAAAA,IAACmC,GAAA,CACC,QAASoF,EAAK,KACd,UACEhG,EAAAA,KAAAC,WAAA,CACG,SAAA,CAAA+F,EAAK,sBAAkB,OAAA,CAAM,SAAA,CAAAA,EAAK,oBAAe,KAAA,CAAA,CAAG,CAAA,EAAE,EACtDA,EAAK,cAAgB,GAAK,GAAGA,EAAK,aAAa,OAC/CA,EAAK,MAAQ,EAAA,CAAA,CAChB,CAAA,CAAA,CAEJ,CAAA,EAEFvH,EAAAA,IAAC0H,GAAA,CAAQ,UAAU,IAAA,CAAK,CAAA,GApBLH,EAAK,EAqB1B,CACD,CAAA,CACH,CAAA,CAAA,CAEJ,CAAA,EACF,EAGFvH,EAAAA,IAAC2B,GAAA,CACC,OAAO,QACP,KAAMmT,EACN,QAAS,IAAMC,EAAmB,EAAK,EAEtC,SAAAH,UACEhT,EAAA,CAAI,GAAI,CAAE,MAAO,IAAK,EAAG,CAAA,EACxB,SAAA,CAAA5B,MAACqB,GAAW,QAAQ,KAAK,aAAY,GAClC,WAAa,KAChB,SAECO,EAAA,CAAI,GAAI,CAAE,GAAI,GACZ,SAAA,CAAAgT,EAAa,qBACXvT,EAAA,CAAW,QAAQ,YAAY,MAAM,iBACnC,WAAa,aAAA,CAChB,EAEFE,EAAAA,KAACF,EAAA,CAAW,QAAQ,QACjB,SAAA,CAAAuT,EAAa,cAAgB,GAAK,GAAGA,EAAa,aAAa,IAC/DA,EAAa,MAAQ,MAAMA,EAAa,IAAI,EAAA,EAC/C,EACCA,EAAa,UACZ5U,EAAAA,IAACqB,EAAA,CAAW,QAAQ,QAAQ,GAAI,CAAE,GAAI,CAAA,EACnC,SAAAuT,EAAa,QAAA,CAChB,CAAA,EAEJ,EAEA5U,MAAC4B,GAAI,GAAI,CAAE,GAAI,EAAG,OAAQ,KACxB,SAAA5B,EAAAA,IAACyP,GAAA,CACC,aAAcmF,EACd,OAAO,QACP,KAAM,GACN,OAAQ,CAACA,EAAa,SAAUA,EAAa,SAAS,CAAA,CAAA,EAE1D,EAEArT,EAAAA,KAACK,EAAA,CAAI,GAAI,CAAE,QAAS,OAAQ,eAAgB,gBAAiB,GAAI,CAAA,EAC/D,SAAA,CAAA5B,EAAAA,IAACoC,EAAA,CACC,QAAQ,WACR,QAAS,IAAM2S,EAAmB,EAAK,EACxC,SAAA,KAAA,CAAA,EAGD/U,EAAAA,IAACoC,EAAA,CACC,QAAQ,YACR,UAAWd,EACX,GAAI,iBAAiBsT,EAAa,EAAE,GACrC,SAAA,OAAA,CAAA,CAED,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CAEJ,EACF,CAEJ,EClVA,MAAMyB,WAAsBC,EAAAA,SAAwB,CAClD,YAAYC,EAAc,CACxB,MAAMA,CAAK,EACX,KAAK,MAAQ,CACX,SAAU,GACV,MAAO,KACP,UAAW,IAAA,CAEf,CAEA,OAAO,yBAAyBrT,EAAqB,CAEnD,MAAO,CAAE,SAAU,GAAM,MAAAA,EAAO,UAAW,IAAA,CAC7C,CAEA,kBAAkBA,EAAcsT,EAA4B,CAE1D,QAAQ,MAAM,kBAAmBtT,EAAOsT,CAAS,EACjD,KAAK,SAAS,CACZ,MAAAtT,EACA,UAAAsT,CAAA,CACD,CACH,CAEA,YAAc,IAAY,CAExB,OAAO,SAAS,OAAA,CAClB,EAEA,QAAoB,CAClB,OAAI,KAAK,MAAM,SAET,KAAK,MAAM,SACN,KAAK,MAAM,SAKlBxW,EAAAA,IAAC4B,EAAA,CACC,GAAI,CACF,QAAS,OACT,cAAe,SACf,WAAY,SACZ,eAAgB,SAChB,QAAS,EACT,OAAQ,OAAA,EAGV,SAAAL,EAAAA,KAACkG,GAAA,CACC,UAAW,EACX,GAAI,CACF,QAAS,EACT,SAAU,IACV,MAAO,OACP,aAAc,EACd,UAAW,QAAA,EAGb,SAAA,CAAAzH,EAAAA,IAACqB,GAAW,QAAQ,KAAK,MAAM,QAAQ,aAAY,GAAC,SAAA,WAAA,CAEpD,QAECA,EAAA,CAAW,QAAQ,QAAQ,UAAS,GAAC,SAAA,kDAGtC,EAEC,UAwCAO,EAAA,CAAI,GAAI,CAAE,GAAI,CAAA,EACb,SAAA,CAAA5B,EAAAA,IAACoC,EAAA,CACC,QAAQ,YACR,MAAM,UACN,QAAS,KAAK,YACd,GAAI,CAAE,GAAI,CAAA,EACX,SAAA,WAAA,CAAA,EAGDpC,EAAAA,IAACoC,EAAA,CACC,QAAQ,WACR,QAAS,IAAM,OAAO,SAAS,KAAO,IACvC,SAAA,QAAA,CAAA,CAED,EACF,CAAA,CAAA,CAAA,CACF,CAAA,EAMC,KAAK,MAAM,QACpB,CACF,CC/FO,MAAMqU,GAAgB,IAAe,CAC1C,GAAI,CAEF,MAAMC,EAAW,QAAQ,UAAU,UAAY,GAC/C,MAAO,cAAc,KAAKA,CAAQ,CACpC,OAAS7P,EAAG,CACV,eAAQ,MAAM,aAAcA,CAAC,EACtB,EACT,CACF,EC0Da8P,GAAqB,SAA2B,CAC3D,GAAI,CAEF,MAAMC,EAAYH,GAAA,EAElB,QAAQ,IAAI,gBAA2C,EACvD,QAAQ,IAAI,mBAAmBG,EAAY,KAAO,KAAK,EAAE,EAIvD,GAAI,CAEF,MAAMC,EAAW,MAAM,MADJD,EAAY,0BAA4B,wBACpB,EAEvC,GAAIC,EAAS,GAAI,CACf,MAAMC,EAA2B,MAAMD,EAAS,KAAA,EAEhD,QAAQ,IAAI,WAAW,EACvB,QAAQ,IAAI,WAAWC,EAAO,QAAQ,EAAE,EACxC,QAAQ,IAAI,WAAWA,EAAO,IAAI,EAAE,EACpC,QAAQ,IAAI,WAAWA,EAAO,KAAO,KAAO,MAAM,QAAQ,CAAC,CAAC,KAAK,EACjE,QAAQ,IAAI,WAAWA,EAAO,MAAM,KAAKA,EAAO,UAAY,IAAI,UAAU,EAC1E,QAAQ,IAAI,YAAYA,EAAO,OAAO,MAAM,EAAE,EAC9C,QAAQ,IAAI,cAAcA,EAAO,QAAQ,MAAM,EAAE,CACnD,MACE,QAAQ,KAAK,uBAAwBD,EAAS,MAAM,CAExD,OAAS3T,EAAO,CACd,QAAQ,KAAK,sBAAuBA,CAAK,CAC3C,CAIJ,OAASA,EAAO,CACd,QAAQ,MAAM,iBAAkBA,CAAK,CACvC,CACF,ECnJa6T,GAAgD,CAAC,CAAE,SAAAC,KAAe,CAC7E,KAAM,CAACC,EAAQC,CAAS,EAAInW,EAAAA,SAAyB+B,IAAmB,EAClE,CAACI,EAAOqD,CAAQ,EAAIxF,EAAAA,SAAwB,IAAI,EAChD,CAACoW,EAAUC,CAAW,EAAIrW,EAAAA,SAAiB,CAAC,EAiDlD,OA/CA2F,EAAAA,UAAU,IAAM,CACd,IAAI2Q,EAAY,GACZC,EAoCJ,OAlCe,SAAY,CAEzB,GAAIL,IAAWpU,GAAe,MAK9B,CAAAyU,EAAmB,YAAY,IAAM,CAC/BD,GACFD,EAAYzM,GAAQ,CAElB,MAAM4M,GAAa,GAAK5M,GAAQ,GAChC,OAAO,KAAK,IAAIA,EAAO4M,EAAW,EAAE,CACtC,CAAC,CAEL,EAAG,GAAG,EAEN,GAAI,CACF,MAAMxU,GAAA,EAEFsU,IACFD,EAAY,GAAG,EACfF,EAAUrU,GAAe,KAAK,EAElC,OAAS8P,EAAK,CACR0E,IACF9Q,EAAS,sBAAsBoM,aAAe,MAAQA,EAAI,QAAU,QAAQ,EAAE,EAC9EuE,EAAUrU,GAAe,KAAK,EAElC,QAAA,CACE,cAAcyU,CAAgB,CAChC,EACF,GAEA,EAEO,IAAM,CACXD,EAAY,GACZ,cAAcC,CAAgB,CAChC,CACF,EAAG,CAACL,CAAM,CAAC,EAGPA,IAAWpU,GAAe,MAE1B7C,EAAAA,IAAC4B,EAAA,CACC,QAAQ,OACR,cAAc,SACd,eAAe,SACf,WAAW,SACX,OAAO,QACP,QAAQ,UAER,gBAACA,EAAA,CAAI,UAAU,SAAS,SAAS,QAAQ,EAAG,EAC1C,SAAA,CAAA5B,MAACqB,EAAA,CAAW,QAAQ,KAAK,aAAY,GAAC,SAAA,WAEtC,EAEC4V,IAAWpU,GAAe,MACzB7C,MAACsH,GAAA,CAAM,SAAS,QAAQ,GAAI,CAAE,GAAI,EAAG,GAAI,GACtC,SAAApE,GAAS,sCAAA,CACZ,EAEA3B,EAAAA,KAAAC,WAAA,CACE,SAAA,CAAAxB,EAAAA,IAACqB,EAAA,CAAW,QAAQ,QAAQ,GAAI,CAAE,GAAI,CAAA,EAAK,SAAA,gCAAA,CAE3C,EAEArB,EAAAA,IAACsN,GAAA,CACC,QAAQ,cACR,MAAO6J,EACP,KAAM,GACN,UAAW,CAAA,CAAA,EAGb5V,EAAAA,KAACF,EAAA,CAAW,QAAQ,QAAQ,MAAM,iBAAiB,GAAI,CAAE,GAAI,CAAA,EAC1D,SAAA,CAAA8V,EAAS,QAAQ,CAAC,EAAE,MAAA,CAAA,CACvB,CAAA,EACF,EAGDF,IAAWpU,GAAe,OACzB7C,EAAAA,IAAC4B,EAAA,CAAI,GAAI,EACP,SAAA5B,EAAAA,IAAC,SAAA,CACC,QAAS,IAAM,CACbuG,EAAS,IAAI,EACb2Q,EAAUrU,GAAe,eAAe,CAC1C,EACA,MAAO,CACL,QAAS,WACT,SAAU,OACV,OAAQ,SAAA,EAEX,SAAA,KAAA,CAAA,CAED,CACF,CAAA,CAAA,CAEJ,CAAA,CAAA,oBAMI,SAAAmU,EAAS,CACrB,EC1HMQ,GAAU,CACd,QAAS,CACP,KAAM,UACN,MAAO,UACP,KAAM,UACN,aAAc,SAAA,EAEhB,UAAW,CACT,KAAM,UACN,MAAO,UACP,KAAM,UACN,aAAc,SAAA,EAEhB,OAAQ,CACN,KAAM,UACN,MAAO,UACP,KAAM,SAAA,EAER,WAAY,CACV,QAAS,UACT,MAAO,UACP,SAAU,SAAA,EAEZ,KAAM,CACJ,QAAS,UACT,UAAW,UACX,SAAU,SAAA,EAEZ,QAAS,UACT,QAAS,CACP,KAAM,UACN,MAAO,UACP,KAAM,SAAA,EAER,QAAS,CACP,KAAM,UACN,MAAO,UACP,KAAM,SAAA,EAER,MAAO,CACL,KAAM,UACN,MAAO,UACP,KAAM,SAAA,EAER,KAAM,CACJ,KAAM,UACN,MAAO,UACP,KAAM,SAAA,CAEV,EAGMC,GAAa,CACjB,WAAY,2DACZ,GAAI,CACF,SAAU,OACV,WAAY,IACZ,WAAY,IACZ,cAAe,SAAA,EAEjB,GAAI,CACF,SAAU,UACV,WAAY,IACZ,WAAY,IACZ,cAAe,SAAA,EAEjB,GAAI,CACF,SAAU,WACV,WAAY,IACZ,WAAY,IACZ,cAAe,SAAA,EAEjB,GAAI,CACF,SAAU,SACV,WAAY,IACZ,WAAY,GAAA,EAEd,GAAI,CACF,SAAU,UACV,WAAY,IACZ,WAAY,GAAA,EAEd,GAAI,CACF,SAAU,WACV,WAAY,IACZ,WAAY,GAAA,EAEd,UAAW,CACT,SAAU,OACV,WAAY,IACZ,WAAY,GAAA,EAEd,UAAW,CACT,SAAU,WACV,WAAY,IACZ,WAAY,GAAA,EAEd,MAAO,CACL,SAAU,OACV,WAAY,IACZ,WAAY,GAAA,EAEd,MAAO,CACL,SAAU,WACV,WAAY,IACZ,WAAY,GAAA,EAEd,QAAS,CACP,SAAU,UACV,WAAY,IACZ,WAAY,GAAA,EAEd,OAAQ,CACN,SAAU,WACV,WAAY,IACZ,cAAe,OACf,cAAe,QAAA,CAEnB,EAGMC,GAAa,CACjB,UAAW,CACT,eAAgB,CACd,KAAM,CACJ,aAAc,EACd,QAAS,YACT,WAAY,uBACZ,UAAW,CACT,UAAW,mBACX,UAAW,gCAAA,CACb,EAEF,UAAW,CACT,UAAW,8BAAA,CACb,CACF,EAEF,QAAS,CACP,eAAgB,CACd,KAAM,CACJ,aAAc,GACd,UAAW,iCACX,WAAY,uBACZ,UAAW,CACT,UAAW,mBACX,UAAW,gCAAA,CACb,CACF,CACF,EAEF,aAAc,CACZ,eAAgB,CACd,KAAM,CACJ,2BAA4B,CAC1B,aAAc,EACd,WAAY,uBACZ,UAAW,CACT,qCAAsC,CACpC,YAAaF,GAAQ,UAAU,IAAA,CACjC,EAEF,gBAAiB,CACf,qCAAsC,CACpC,YAAaA,GAAQ,QAAQ,KAC7B,YAAa,CAAA,CACf,CACF,CACF,CACF,CACF,EAEF,UAAW,CACT,eAAgB,CACd,KAAM,CACJ,UAAW,gCACX,eAAgB,aAChB,gBAAiB,wBAAA,CACnB,CACF,EAEF,QAAS,CACP,eAAgB,CACd,KAAM,CACJ,aAAc,EACd,WAAY,GAAA,CACd,CACF,EAEF,SAAU,CACR,eAAgB,CACd,KAAM,CACJ,aAAc,GACd,UAAW,gCAAA,EAEb,WAAY,CACV,UAAW,+BAAA,EAEb,WAAY,CACV,UAAW,+BAAA,EAEb,WAAY,CACV,UAAW,gCAAA,CACb,CACF,CAEJ,EAGa/W,GAAQkX,GAAY,CAC/B,QAAAH,GACA,WAAAC,GACA,WAAAC,GACA,QAAS,EACT,MAAO,CACL,aAAc,CAAA,EAEhB,YAAa,CACX,OAAQ,CACN,GAAI,EACJ,GAAI,IACJ,GAAI,IACJ,GAAI,KACJ,GAAI,IAAA,CACN,EAEF,YAAa,CACX,OAAQ,CACN,UAAW,+BACX,QAAS,+BACT,OAAQ,6BACR,MAAO,8BAAA,CACT,CAEJ,CAAiB,ECzNXE,GAAwB,IAAM,CAClC,KAAM,CAAE,SAAArX,CAAA,EAAaC,GAAA,EAErBkG,OAAAA,EAAAA,UAAU,IAAM,CACd,OAAO,SAAS,EAAG,CAAC,CACtB,EAAG,CAACnG,CAAQ,CAAC,EAEN,IACT,EAKMsX,GAAuB,KAE3BnR,EAAAA,UAAU,IAAM,CAGd,QAAQ,IAAI,gCAAoE,EAGhFiQ,GAAA,CACF,EAAG,CAAA,CAAE,EAGHpV,EAAAA,KAAAC,WAAA,CACE,SAAA,CAAAxB,EAAAA,IAAC4X,GAAA,EAAY,QACZtX,GAAA,EAAO,EACRN,MAAC,OAAA,CAAK,UAAU,YACd,gBAAC8X,GAAA,CACC,SAAA,CAAA9X,MAAC+X,IAAM,KAAK,IAAI,QAAS/X,MAACiG,KAAS,EAAI,QACtC8R,GAAA,CAAM,KAAK,gBAAgB,QAAS/X,MAAC2H,KAAiB,EAAI,QAC1DoQ,GAAA,CAAM,KAAK,oBAAoB,QAAS/X,MAAC0O,KAAuB,EAAI,QACpEqJ,GAAA,CAAM,KAAK,cAAc,QAAS/X,MAAC6P,KAAe,EAAI,QACtDkI,GAAA,CAAM,KAAK,kBAAkB,QAAS/X,MAACoS,KAAoB,EAAI,QAC/D2F,GAAA,CAAM,KAAK,OAAO,QAAS/X,EAAAA,IAACoU,KAAQ,CAAA,CAAI,CAAA,CAAA,CAC3C,CAAA,CACF,QACC/R,GAAA,CAAA,CAAO,CAAA,EACV,GAIE2V,GAAgB,IAElBhY,EAAAA,IAACqW,GAAA,CACC,gBAAC4B,GAAA,CAAc,MAAAxX,GACb,SAAA,CAAAT,EAAAA,IAACkY,GAAA,EAAY,QACZnB,GAAA,CACC,eAACoB,IACC,SAAAnY,MAAC6X,GAAA,CAAA,CAAW,CAAA,CACd,EACF,CAAA,CAAA,CACF,CAAA,CACF,ECnEJ,QAAQ,IAAI,yBAA0B,YAAoB,EAC1D,QAAQ,IAAI,oBAAqB,SAAS,eAAe,MAAM,CAAC,EAGhE,MAAMO,GAAY,SAAS,eAAe,MAAM,EAChD,GAAI,CAACA,GACH,cAAQ,MAAM,0DAA0D,EAClE,IAAI,MAAM,iCAAiC,EAEnD,MAAMC,GAAOvY,GAAWsY,EAAS,EAIjC,QAAQ,IAAI,iDAAiD,EAE7D,GAAI,CACFC,GAAK,aACFjC,GAAM,WAAN,CACC,eAACkC,GAAA,CACC,SAAAtY,EAAAA,IAACgY,GAAA,CAAA,CAAI,CAAA,CACP,EACF,CAAA,EAEF,QAAQ,IAAI,8BAA8B,CAC5C,OAAS9U,EAAO,CACd,QAAQ,MAAM,qCAAsCA,CAAK,CAC3D","x_google_ignoreList":[0]}